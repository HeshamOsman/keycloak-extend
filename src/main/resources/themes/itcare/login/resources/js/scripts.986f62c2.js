function CloudsSelectorController(a,b,c){function d(){angular.forEach(e.clouds,function(a){a.collapsed=!0})}var e=this;d()}function CloudInfoController(a,b){function c(){}function d(){var b=e.cloudFilterList.split(",").length;return e.isCloudFilterActive&&e.cloudFilterList.split(",").length>1?a.get("INFO_CLOUD_PLURAL").format([b]):a.get("INFO_CLOUD")}var e=this;e.cloudFilterList=b.getCloudFiltersList(),e.displayWarning=null!==e.cloudFilterList,e.isCloudFilterActive=!!e.cloudFilterList&&e.cloudFilterList.split(",").length>0|!1,e.infoText=d,c()}function mergeRecursive(a,b){"use strict";for(var c in b)try{b[c].constructor===Object?a[c]=mergeRecursive(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a}function arrayEquals(a,b){"use strict";if(!b||!a)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]instanceof Array&&b[c]instanceof Array){if(!arrayEquals(a[c],b[c]))return!1}else if(a[c]!==b[c])return!1;return!0}function ObsolescenceMapController(a){var b=this;b.platformsObs=[];var c={NOT_RELEASED:a.colors["gray-lighter"],STANDARD:a.colors.success,END_OF_SALES:a.colors.warning,EXTENDED:a.colors.danger,END_OF_SUPPORT:a.colors["gray-lighter"]};b.$onChanges=function(){angular.forEach(b.platforms,function(a){for(var d={name:a.name,count:0,calendar:[]},e=moment().add(-6,"months"),f=(moment().add(54,"months"),null!=a.releasedAt?moment(a.releasedAt):null),g=null!=a.endOfSalesAt?moment(a.endOfSalesAt):null,h=null!=a.extendedSupportAt?moment(a.extendedSupportAt):null,i=null!=a.endOfSupportAt?moment(a.endOfSupportAt):null,j=0;j<60;j++){var k=moment(e).add(j,"months"),l="NOT_RELEASED";null!=f&&(l=k.year()<f.year()||k.year()==f.year()&&k.month()<f.month()?"NOT_RELEASED":null==g?"STANDARD":k.year()<g.year()||k.year()==g.year()&&k.month()<g.month()?"STANDARD":null==h?"END_OF_SALES":k.year()<h.year()||k.year()==h.year()&&k.month()<h.month()?"END_OF_SALES":null==i?"EXTENDED":k.year()<i.year()||k.year()==i.year()&&k.month()<i.month()?"EXTENDED":"END_OF_SUPPORT"),d.calendar.push({year:k.year(),month:k.month()+1,phase:l,color:c[l],legend:a.name+": Support "+l+" ("+k.format("MMM YY")+")"})}d.calendar.sort(function(a,b){return a.year!=b.year?a.year-b.year:a.month-b.month}),b.platformsObs.push(d)})}}function TagsSelectorController(a,b,c){var d=this;d.REGEX_TAG_KEY=d.forUpdate?"^[^',:*?]+$":"^[^',:]+$",d.REGEX_TAG_VALUE=d.forUpdate?"^[^',*?]+$":"^[^',]+$",d.REGEX_TAG_KEY_SEARCH="^[^',:]+$",d.REGEX_TAG_VALUE_SEARCH="^[^',]+$",d.tagKeySearch="",d.tagValueSearch="";var e=!0;d.searchTagKeysPromise=function(b){return""!=b&&null==b.match(d.REGEX_TAG_KEY_SEARCH)?[]:a.getTagKeysContaining(b,d.type).then(function(a){return a.data})},d.searchTagValuesPromise=function(e,f){return b.debug(f),void 0===e||""==e?[]:null==e.match(d.REGEX_TAG_KEY_SEARCH)?[]:(void 0===f&&(f=""),""!==f&&null==f.match(d.REGEX_TAG_VALUE_SEARCH)?[]:a.getTagValuesForKey(e).then(function(a){var b=a.data;return c.filter(b,function(a){var b=new RegExp("^"+(""===f?".*":".*"+f.replace(/\*/g,".*").replace(/\?/g,".?")).replace(/:/g,"&#58;")+".*$","i");return a.tagValue?null!==a.tagValue.match(b):[]})}))},d.onValueChange=function(){e!==d.tagSearchForm.$valid&&(e=d.tagSearchForm.$valid,d.onValidityChange({valid:d.tagSearchForm.$valid}))},d.onDelete=function(a){d.tags.splice(a,1),d.tagSearchForm["tagKey-"+a]&&d.tagSearchForm.$removeControl(d.tagSearchForm["tagKey-"+a]),d.tagSearchForm["tagValue-"+a]&&d.tagSearchForm.$removeControl(d.tagSearchForm["tagValue-"+a]),d.onValidityChange({valid:d.tagSearchForm.$valid})},d.checkIsValid=function(a,b){if(!a||!b)return!1;var c=new RegExp(d.REGEX_TAG_KEY,"i"),e=new RegExp(d.REGEX_TAG_VALUE,"i");return null!==a.match(c)&&null!==b.match(e)},d.addTag=function(a,b){d.checkIsValid(a,b)&&(d.tags.push({id:"",tagKey:a,tagValue:b}),d.tagKeySearch="",d.tagValueSearch="")}}function ObjectStoresUsersController(a,b,c,d,e){function f(a,c){j.loading=!0,void 0!==a&&void 0!==c&&(j.page=a,j.size=c),b.getObjectStoresUsers(j.cos,j.page-1,j.size).success(function(a){j.users=a.content,j.loading=!1,b.countUsers(j.cos).success(function(a){j.total=a})})}function g(a){void 0==a&&(a={}),a.cos=j.cos,e.open({animation:!0,templateUrl:"/storage/detail/change-secret-object-store-user.html",controller:"ObjectStoresUserChangeSecretCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{user:angular.copy(a)}}).result.then(function(a){},function(){c.debug("Modal dismissed at: "+new Date)})}function h(a){void 0==a&&(a={}),a.cos=j.cos,e.open({animation:!0,templateUrl:"/storage/detail/delete-object-store-user.html",controller:"ObjectUserDeletionCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{user:angular.copy(a)}}).result.then(function(a){j.activate()},function(){c.debug("Modal dismissed at: "+new Date)})}function i(a){void 0==a&&(a={}),a.cos=j.cos,e.open({animation:!0,templateUrl:"/storage/detail/update-object-store-user.html",controller:"ObjectStoresUserUpdateCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{user:angular.copy(a)}}).result.then(function(a){j.activate()},function(){c.debug("Modal dismissed at: "+new Date)})}var j=this;j.limit=0,j.total=0,j.page=1,j.size=8,j.loading=!1,j.newUser=void 0,j.newUserLabel=void 0,j.showUpdateModal=i,j.showDeleteModal=h,j.showChangeSecretModal=g,j.activate=f,j.activate(),j.loadUsers=function(a,c){j.loading=!0,b.getObjectStoresUsers(j.cos,j.page-1,j.size).success(function(a){j.users=a.content,j.loading=!1,b.countUsers(j.cos).success(function(a){j.total=a})})},j.load=function(a,b){j[a+"Loading"+b]=!0},j.unLoad=function(a,b){j[a+"Loading"+b]=!1},j.updateUserOperation=function(a,c,e,f){j.load(c,a);var g=d.find(j.users,["accessKey",a]);void 0!==g&&b.updateUserOperation(g.objectStore,g.accessKey,e,f).success(function(b){"change_secret"==e&&(j["lastSecret"+a]={processed:!0,content:"<b>"+b.secret_key+"</b>",label:"Secret"}),j.unLoad(c,a)})}}function VulnerabilityActivityController(a,b,c,d,e,f){function g(){}this.$onInit=function(){g()}}function VulnerabilityBrowserController(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){t.loading=!0,t.activeSummary&&p(t.search),void 0!==a&&void 0!==b&&(t.page=a,t.size=b),t.load(t.page,t.size,t.vulnerabilitiesOnly,t.search,function(){t.loading=!1}),t.limit=t.page*t.size}function p(a){j.getVulnerabilitiesSummary("",a).then(function(a){t.summary.datas=a.data.vulnerabilitiesSummary,t.summary.loading=!1},function(a){i.error("Failed to refresh summary for vulnerabilities: "+a)})}function q(a){return h.reduce(a,function(a,b){return a<b.level&&b.total>0?b.level:a},0)}function r(a,b,c,d,e){t.lazyLoading=!0;var f=void 0==t.service?"":t.service.id;j.getVulnerabilities(a-1,b,f,c,d).then(function(b){a?("scrollable"==t.mode?(t.objects=1==a?b.data.content:h.concat(t.objects,b.data.content),t.total=b.data.totalPages):(t.objects=b.data.content,t.total=b.data.totalElements),t.page=b.data.number+1,t.size=b.data.size):t.objects=b.data,t.lazyLoading=!1,angular.isFunction(e)&&e()},function(a){i.error("Failed to refresh page for object stores: "+a)})}function s(a){n.openReport(a)}var t=this;t._scope=e,t.limit=0,t.total=0,t.objects=void 0,t.search="",t.gotToLastPage=void 0,t.loading=!1,t.lazyLoading=!1,t.vulnerabilitiesOnly=!0,t.summary={datas:[],loading:!0},t.openReport=s,t.getVulnerabilitiesSummary=p,t.computeHighSeverity=q,t.load=r,t.activate=o,t.$onInit=function(){o()}}function GraphicController(a,b,c,d){function e(){a(function(){g.api.refresh()})}function f(){if(g.config&&g.datas){var a=c.defaultChartD3Options();if(a.chart.xDomain=[new Date(moment(1e3*g.config.start)),new Date(moment(1e3*g.config.end))],a.chart.yDomain=[g.config.domain.min,g.config.domain.max],a.chart.legend.dispatch.legendClick=function(a){g.selectedMetric=angular.copy(a)},"full"==g.config.mode){var b="%x",e=moment(1e3*g.config.end).unix()-moment(1e3*g.config.start).unix();e<3600?b="%M:%S":e<172800?b="%a | %H:%M":e<604800&&(b="%b. %a %d"),a.chart.xAxis.showMaxMin=!0,a.chart.xAxis.tickFormat=function(a){return d3.time.format(b)(new Date(a))},a.chart.yAxis.axisLabel=g.config.unit,a.chart.height="450",a.chart.showLegend=!0,a.chart.interactive=!0,a.chart.useInteractiveGuideline=!0,a.chart.margin.left=60,a.chart.margin.right=75,a.chart.interactiveLayer.tooltip.headerFormatter=function(a){return d3.time.format("%d %b @ %H:%M")(new Date(a))},a.chart.interactiveLayer.tooltip.valueFormatter=function(a){return d3.format(".03f")(a)}}return"short"==g.config.mode&&(a.chart.height="80",a.chart.showLegend=!1,a.chart.interactive=!1,a.chart.useInteractiveGuideline=!1,a.chart.tooltip.enabled=!1,a.chart.margin={top:0,right:0,bottom:0,left:0},a.chart.xAxis.showMaxMin=!1,a.chart.xAxis.tickFormat=function(a){return""},a.chart.yAxis.showMaxMin=!1,a.chart.yAxis.axisLabel=g.config.unit,a.chart.noData=d.get("NO_DATAS_SHORT")),"thumbs"==g.config.mode&&(a.chart.noData=d.get("NO_DATAS"),a.chart.margin={top:10,right:25,bottom:10,left:25}),a}}var g=this;g.selectedMetric=void 0,g.$onInit=function(){g.options=f()},g.$onChanges=function(){g.options=f(),e()}}function GraphicBrowserViewController(a,b,c,d,e,b,f,g,h,i){var j=this;j._scope=c,j.datas={},j.computeLegend=i.computeLegend,j.allConfigurations=[],j.internalConfiguration=[],j.selectedGraph=null,j.$onInit=function(){j.internalConfiguration=angular.copy(j.configuration),j.view="thumbs",j.allConfigurations=[];var a=d.start||moment().startOf("day").unix(),b=d.end||moment().add(1,"days").startOf("day").unix();j.dates={startDate:moment(1e3*a),endDate:moment(1e3*b)};var c=!1,e=0;angular.forEach(j.resources,function(a){angular.forEach(j.internalConfiguration[a.id],function(b){d.name&&b.name==d.name?(b.mode="full",c=!0,j.selectedGraph=b):b.mode="thumbs",b.resourceId=a.id;var f=h.get("monitoring."+b.name);b.graphName=f==="monitoring."+b.name?b.name:f,j.allConfigurations.push(b),e++})}),j.maxPointsPerGraph=Math.floor(1e4/e),j.refresh()},j.refresh=function(){j._scope.$watch(function(){return j.dates},function(a,c){a.startDate.isSame(c.startDate)&&a.endDate.isSame(c.endDate)||angular.forEach(b.filter(j.allConfigurations,function(a){return a.displayed}),function(a){j.lazyLoad(a,j.getResource(a.resourceId))})},!0)},j.handleInview=function(a,b,c){b.inview=a||"full"==b.mode,a&&j.lazyLoad(b,c)},j.lazyLoad=function(a,b){!a.inview&&"full"!=a.mode||a.start===j.dates.startDate.unix()&&a.end===j.dates.endDate.unix()||(j.datas[b.id]||(j.datas[b.id]={}),a.start=j.dates.startDate.unix(),a.end=j.dates.endDate.unix(),j.options.displayHost&&(a.hostName=b.name,a.displayHostName=!0,a.graphName=a.hostName+"/"+a.graphName),a.loading=!0,i.getPerformanceByGraphic(b.id,b.resourceType,a.start,a.end,j.maxPointsPerGraph,a).then(function(c){j.datas[b.id][a.name]=c,a.loading=!1,a.displayed=!0,i.computeUnit(a,j.datas[b.id][a.name]),i.computeDomain(a,j.datas[b.id][a.name]),i.computePercentile(a,j.datas[b.id][a.name])}))},j.switchView=function(a,c){j.view=a,null==c?(b.map(j.allConfigurations,function(b){b.mode=a}),j.selectedGraph=null):(b.map(j.allConfigurations,function(b){return b.mode=b==c?a:"thumbs",b}),c.mode=a,j.selectedGraph=c)},j.getResource=function(a){return b.filter(j.resources,function(b){return b.id===a})[0]}}function GraphicShortViewController(a,b,c,d,e,f){var g=this;g.datas={},g.allConfigurations=[],g.limit=6,g.total=0,g.$onInit=function(){angular.forEach(g.resources,function(a){angular.forEach(g.configuration[a.id],function(b){b.resourceId=a.id,g.allConfigurations.push(b),g.total++})}),g.maxPointsPerGraph=Math.floor(1e3/g.total),g.display=!!g.displayOnInit},g.getResource=function(a){return b.filter(g.resources,function(b){return b.id===a})[0]},g.lazyLoad=function(a,b){a.mode="short",a.start=g.dates.start,a.end=g.dates.end,g.datas[b.id]={},f.getPerformanceByGraphic(b.id,b.resourceType,g.dates.start,g.dates.end,g.maxPointsPerGraph,a).then(function(c){g.datas[b.id][a.name]=c,a.loading=!1,f.computeDomain(a,g.datas[b.id][a.name])})},g.scroll=function(){g.limit<g.total&&g.limit++},g.goTo=function(a,b,c){"instance"===a.resourceType&&angular.isFunction(g.goToInstance)&&g.goToInstance({id:a.id,subview:b,params:c}),"hardware"===a.resourceType&&angular.isFunction(g.goToHardware)&&g.goToHardware({id:a.id,subview:b,params:c}),"loadbalancer"===a.resourceType&&angular.isFunction(g.goToLoadBalancer)&&g.goToLoadBalancer({id:a.id,subview:b,params:c})},g.forceDisplay=function(){g.display=!0}}function GraphicPeriodPickerController(a,b,c,d,e,f,g,h,i){function j(){u._scope.$watch(function(){return u.dates},function(a,b){a.startDate.isSame(b.startDate)&&a.endDate.isSame(b.endDate)||(t(),m())},!0)}function k(){u.optionsCalendar={showDropdowns:!0,timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,alwaysShowCalendars:!0,dateLimit:{months:24},buttonClasses:["btn","btn-sm","btn-block"],applyClass:"btn-success",cancelClass:"btn-default",locale:{customRangeLabel:i.get("PERIOD_CUSTOM"),format:"L LT",applyLabel:i.get("OK"),cancelLabel:i.get("CANCEL")},opens:"right",drops:"up",eventHandlers:{"apply.daterangepicker":function(a){u.rangePickerAutoClose="always",u.rangePickerIsOpen=!1},"hide.daterangepicker":function(a){u.rangePickerAutoClose="always",u.rangePickerIsOpen=!1},"cancel.daterangepicker":function(a){u.rangePickerAutoClose="always",u.rangePickerIsOpen=!1}},ranges:u.rangesForDatePickerComponent}}function l(){u.maxDate=moment().add(1,"days").startOf("day"),u.nextRangeAllowed=!1,u.currentRange=u.dates.endDate.unix()-u.dates.startDate.unix(),u.ranges=[],u.ranges.push({period:"PERIOD_TODAY",start:moment().startOf("day"),end:moment().add(1,"days").startOf("day")}),u.ranges.push({period:"PERIOD_YESTERDAY",start:moment().startOf("day").subtract(1,"days"),end:moment().startOf("day")}),u.ranges.push({period:"PERIOD_LAST_7_DAYS",start:moment().startOf("day").subtract(8,"days"),end:moment().startOf("day")}),u.ranges.push({period:"PERIOD_LAST_30_DAYS",start:moment().startOf("day").subtract(31,"days"),end:moment().startOf("day")}),u.ranges.push({period:"PERIOD_THIS_MONTH",start:moment().startOf("month"),end:moment().endOf("month")}),u.ranges.push({period:"PERIOD_LAST_MONTH",start:moment().subtract(1,"month").startOf("month"),end:moment().subtract(1,"month").endOf("month")}),u.ranges.push({period:"PERIOD_LAST_3_MONTHS",start:moment().subtract(3,"month").startOf("month"),end:moment().subtract(1,"month").endOf("month")}),u.ranges.push({period:"PERIOD_LAST_6_MONTHS",start:moment().subtract(6,"month").startOf("month"),end:moment().subtract(1,"month").endOf("month")}),u.rangesForDatePickerComponent={},angular.forEach(u.ranges,function(a){u.rangesForDatePickerComponent[i.get(a.period)]=[a.start,a.end]}),u.rangePickerAutoClose="always"}function m(){e.debug("Recomputing label "+u.dates.startDate.unix()+":"+u.dates.endDate.unix());var a=q();u.rangePickerLabel="PERIOD_CUSTOM"!==a?i.get(a):b("amDateFormat")(u.dates.startDate,"LLL")+" - "+b("amDateFormat")(u.dates.endDate,"LLL"),e.debug("Label: "+u.rangePickerLabel+", period : "+a)}function n(a){return a.start.unix()===u.dates.startDate.unix()&&a.end.unix()===u.dates.endDate.unix()}function o(a){u.isRangeSelected(a)||(u.dates={startDate:moment(a.start),endDate:moment(a.end)})}function p(){for(var a=0;a<u.ranges.length;a++)if(u.isRangeSelected(u.ranges[a]))return!1;return!0}function q(){for(var a=0;a<u.ranges.length;a++)if(e.debug("Period "+u.ranges[a].period+" selected ? "+u.isRangeSelected(u.ranges[a])),u.isRangeSelected(u.ranges[a]))return u.ranges[a].period;return"PERIOD_CUSTOM"}function r(){u.dates={startDate:u.dates.startDate.add(u.currentRange,"s"),endDate:u.dates.endDate.add(u.currentRange,"s")},u.maxDate=moment()}function s(){u.dates={startDate:u.dates.startDate.subtract(u.currentRange,"s"),endDate:u.dates.endDate.subtract(u.currentRange,"s")},u.maxDate=moment(),e.debug("period : "+u.dates.startDate.unix()+"-"+u.dates.endDate.unix()+", range="+(u.dates.startDate.unix()-u.dates.endDate.unix()))}function t(){u.currentRange=u.dates.endDate.unix()-u.dates.startDate.unix();var a=moment(u.dates.endDate).add(u.currentRange,"s");u.nextRangeAllowed=u.maxDate.unix()>=a.unix()}var u=this;u._scope=a,u.shiftNext=r,u.shiftBefore=s,u.isRangeSelected=n,u.selectRange=o,u.isCustomRangeSelected=p,u.computeOptionValues=k,u.computeRangeValues=l,u.refresh=j,u.$onInit=function(){l(),k(),m(),j()}}function ObjectStoresBrowserController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b){z.loading=!0,void 0!==a&&void 0!==b&&(z.page=a,z.size=b),z.loadObjects(z.search,z.page,z.size,function(){z.loading=!1}),z.limit=z.page*z.size}function r(a,b){return Number(100*Number(a/b).toFixed(5)).toFixed(2)}function s(){"scrollable"==z.mode?q(1,z.size):q(),angular.isFunction(z.onRefresh)&&z.onRefresh()}function t(){j.trackEvent("Object Storage","Creation Start");var a=["$scope","object","$uibModalInstance",function(a,b,c){function d(){c.close(b)}var e=this;e.object=b,e.close=d}];e.open({animation:!0,templateUrl:"/storage/detail/create-object-store.html",controller:"ObjectCreationCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{localizations:function(){return m.getLocations()},defaultService:function(){return z.service},defaultUser:function(){return n.getUser()}}}).result.then(function(b){e.open({animation:!0,templateUrl:"synthesis-object-store.html",backdrop:"static",keyboard:!0,size:"lg",controller:a,controllerAs:"synthesis",resolve:{object:function(){return b}}}),s()},function(){l.debug("Modal dismissed at: "+new Date)})}function u(a){e.open({animation:!0,templateUrl:"/storage/detail/update-object-store.html",controller:"ObjectEditionCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{objectStore:function(){return a}}}).result.then(function(a){s()},function(){l.debug("Modal dismissed at: "+new Date)})}function v(a){e.open({animation:!0,templateUrl:"/storage/detail/delete-object-store.html",controller:"ObjectDeletionCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{objectStore:function(){return a}}}).result.then(function(a){s()},function(){l.debug("Modal dismissed at: "+new Date)})}function w(a,b){p.promptTagsInModal(c.translation,a.tags,"",b).then(function(c){b&&m.updateTags(a.name,c).then(function(a){d.pop("success",o.get("TAGS_UPDATED_TITLE"),o.get("TAGS_UPDATED_BODY")),s()},function(a){l.error("Failed to update object stores: "+a)})})}function x(a){var b={};return k.forEach(a.availableActions,function(a){var c="";a.available||k.forEach(a.unavailabilityCauses,function(a){c+=o.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),b[a.operation]={available:a.available,errors:c}}),b}function y(a,c,d,e){z.lazyLoading=!0;var f=void 0==z.service?"":z.service.id,g=m.getObjectStores(a,c-1,d,void 0,f);z.summary.loading=!0;var h=m.getObjectStoresSummary(f,a);b.all([g,h]).then(function(a){c?(k.forEach(a[0].data.content,function(a){a.availableActions=x(a)}),"scrollable"==z.mode?(z.objects=1==c?a[0].data.content:k.concat(z.objects,a[0].data.content),z.total=a[0].data.totalPages):(z.objects=a[0].data.content,z.total=a[0].data.totalElements),z.page=a[0].data.number+1,z.size=a[0].data.size):(z.objects=a[0].data,k.forEach(z.objects,function(a){a.availableActions=x(a)})),z.lazyLoading=!1,angular.isFunction(e)&&e(),z.summary=k.merge(z.summary,a[1].data),z.summary.loading=!1},function(a){l.error("Failed to refresh page for object stores: "+a)})}var z=this;z._scope=g,z.limit=0,z.total=0,z.objects=void 0,z.search="",z.gotToLastPage=void 0,z.loading=!1,z.lazyLoading=!1,z.pageSizesAvailable=[15,30,50,100],z.size=30,z.page=1,a.NUMBER_FORMATS.GROUP_SEP=",",z.computeRatio=r,z.showCreationModal=t,z.showEditionModal=u,z.showDeletionModal=v,z.openTagsEditor=w,z.loadObjects=y,z.$onInit=function(){q(),z.create=t},z.scroll=function(){z.page<=z.total&&!z.lazyLoading&&(z.page++,z.limit=z.page*z.size,z.loadObjects(z.page,z.size))}}function ObjectStoresActivityController(a,b,c,d,e,f,g){function h(){g.go("storage")}var i=this;i.goToDetail=h,i.$onInit=function(){}}window.console||(console={log:function(){}}),String.prototype.endsWith||(String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)}),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return void 0!==a[c]?a[c]:b})}),String.prototype.format=function(){for(var a=this,b=0;b<arguments.length;b++){var c=new RegExp("\\{"+b+"\\}","gi");a=a.replace(c,arguments[b])}return a},function(){"use strict";angular.module("itcare",["itcare.business","itcare.components","itcare.compute","itcare.costs","itcare.home","itcare.menu","itcare.login","itcare.services","itcare.search","itcare.messages","itcare.monitoring","itcare.tickets","itcare.agenda","itcare.storage","itcare.platforms","itcare.mentions","itcare.obsolescence","itcare.vulnerability","itcare.public","magic-forms","ngAnimate","ngMessages","ngRoute","ngSanitize","ngTouch","ui.router","angular-loading-bar","angularMoment","ui.bootstrap","chart.js","frapontillo.bootstrap-switch","FBAngular","ngLodash","ngCsv","infinite-scroll","LocalStorageModule","toaster","nvd3","daterangepicker","ngScrollbars","ngBootbox","angular-google-analytics","angular-inview","angular-notification-icons","ngFileUpload","ngFileSaver","ncy-angular-breadcrumb"])}(),function(){"use strict";angular.module("itcare").constant({ENV:"prod",BACKEND_ENDPOINT:"itcare",VERSION:"2.8.1_f2e6ce718a3c562e08e4321d9aebcdd6304f2809",BRANCH:"master",DEBUG:"false",BACKEND_HOST:"@@HOST",BACKEND_PORT:"@@PORT",REFRESH_INTERVAL:"12000",REFRESH_INTERVAL_ACTIONS:"300000",USER_PREFERENCES_VERSION:"v1.1",GOOGLE_ANALYTICS_UID:"UA-90244854-1",GOOGLE_ANALYTICS_ALLOWED_HOSTNAMES:["itcare.cloud.cegedim.com","itcare.cegedim-hds.fr","itcare.cegedim.cloud"]})}(),function(){"use strict";angular.module("itcare").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),angular.module("itcare").directive("csSelect",function(){return{require:"^stTable",template:'<input type="checkbox"/>',scope:{row:"=csSelect"},link:function(a,b,c,d){b.bind("change",function(b){a.$apply(function(){d.select(a.row,"multiple")})}),a.$watch("row.isSelected",function(a,c){!0===a?b.parent().addClass("st-selected"):b.parent().removeClass("st-selected")})}}}),angular.module("itcare").directive("excelExport",["lodash","$filter","ChartService",function(a,b,c){return{restrict:"A",scope:{fileName:"@",data:"&exportData",config:"&exportConfig"},replace:!0,template:'<button class="btn btn-primary btn-sm" ng-click="download()">Excel <i class="fa fa-download"></i></button>',link:function(c,d){c.download=function(){function d(a,b){return b&&(a+=1462),(Date.parse(a)-new Date(Date.UTC(1899,11,30)))/864e5}function e(a,b){for(var c={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},f=0;f!=a.length;++f)for(var g=0;g!=a[f].length;++g){e.s.r>f&&(e.s.r=f),e.s.c>g&&(e.s.c=g),e.e.r<f&&(e.e.r=f),e.e.c<g&&(e.e.c=g);var h={v:a[f][g]};if(null!=h.v){var i=XLSX.utils.encode_cell({c:g,r:f});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=XLSX.SSF._table[14],h.v=d(h.v)):h.t="s",c[i]=h}}return e.s.c<1e7&&(c["!ref"]=XLSX.utils.encode_range(e)),c}function f(){if(!(this instanceof f))return new f;this.SheetNames=[],this.Sheets={}}function g(c){var d=[],e=[];if(c.length>0){d.push("#"),a.forEach(c,function(a){d.push(a.key)}),e.push(d);var f=[];c.forEach(function(a){f.push(a.values)});for(var g=f[0].length,h=c.length,i=0;i<g;i++){for(var j=[],k=0;k<h;k++)0==k&&j.push(b("amDateFormat")(f[k][i][0],"LLL")),j.push(f[k][i][1]);e.push(j)}}return e}function h(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}var i=new f,j=e(g(c.data()));i.SheetNames.push(c.fileName),i.Sheets[c.fileName]=j;var k=XLSX.write(i,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([h(k)],{type:"application/octet-stream"}),c.fileName+".xlsx")}}}}])}(),function(){"use strict";function a(a){a.keys=Object.keys}function b(a,b){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache",a.defaults.withCredentials=!1,a.interceptors.push(["$injector","$q","$location","toaster","errorProvider","serverProvider","DEBUG","$log","VERSION",function(a,b,c,d,e,f,g,h,i){return{request:function(a){return!a.cached&&"GET"==a.method&&a.url.endsWith(".html")&&(a.url+="?v="+i),a},response:function(a){void 0!==a.status&&a.status;return a},responseError:function(c){if(void 0!==c.config){var g=c.config.silentFailure,i=a.get("$state"),j=(a.get("$rootScope"),void 0!==c.status?c.status:400),k=a.get("UserService");switch(j){case 404:RegExp("services_detail.*.information").test(i.current.name)&&(g=!0,i.go("services_detail.dashboard",{serviceId:i.params.serviceId},{reload:!0})),g||d.pop("error",e.get("error.client.title"),e.get("error.client.404"));break;case 403:d.pop("error",e.get("error.client.title"),e.get("error.client.403"));break;case 409:d.pop("error",e.get("error.client.title"),e.get("error.client.409"));break;case 401:k.removeCurrentUser(),c.config.url.endsWith("/login")||(d.pop("error",e.get("error.client.title"),e.get("error.client.401")),i.go("login",{},{reload:!0}));break;case 422:case 400:var l=angular.isArray(c.data)&&c.data[0]&&c.data[0].defaultMsg?c.data[0].defaultMsg:void 0;l?d.pop("error",e.get("error.client."+j),l):d.pop("error",e.get("error.client.title"),e.get("error.client."+j));break;case 500:d.pop("error",e.get("error.client.title"),e.get("error.client.500"));break;case 503:var l=c.data[0].stackTrace[0],m=c.data[0].stackTrace[1];h.debug("New error 503, message: "+l),h.debug("New error 503, cause: "+m),"dev"==f.getMode()?g||d.pop({type:"error",title:e.get("error.client.title"),body:"<div style='color:white; width:100%'>"+l+"</div><div style='color:white; width:100%'>"+m+"</div>",bodyOutputType:"trustedHtml",showCloseButton:!0}):g||d.pop("error",e.get("error.client.title"),e.get("error.client.503"))}}return b.reject(c)}}}])}function c(a){a.decorator("$exceptionHandler",["$delegate","$injector","serverProvider","$log",function(a,b,c,d){return function(a,e){if(d.error(a),"dev"==c.getMode()){var f=b.get("$state");b.get("$rootScope").lastException=a.message,f.go("error")}else{b.get("toaster").pop({type:"error",title:"Error",body:"<div style='color:white; width:100%'>An error has occured</div>",bodyOutputType:"trustedHtml",showCloseButton:!0})}}}])}function d(a){a.setPrefix("itcare").setStorageType("localStorage")}function e(a){a.decorator("$log",["$delegate",function(a){var b,c=!0;return b={debugEnabled:function(a){c=!!a}},["log","warn","info","error","debug"].forEach(function(d){b[d]=function(){if(c){var b=a;b[d].apply(b,arguments)}}}),b}])}function f(a,b){"true"==b?a.debugEnabled(!0):a.debugEnabled(!1)}function g(a,b,c,d){a.$on("$stateChangeStart",function(e,f,g,h,i){if("login"!=f.name&&"tour"!=f.name&&-1===f.name.indexOf("public")&&(a.$nextState={name:f.name,params:g}),f.data&&f.data.restricted&&!c.getCurrentUser().isAuthenticated)return d.warn("Unauthenticated access to restricted area..."),b.go("login"),void e.preventDefault()})}function h(a,b,c,d){a.$on("$stateChangeError",function(a,b,d,e,f,g){c.error("state change error to "+b.name)})}function i(a,b,c,d,e,f,g,h,i,j){var k=c.navigator.userLanguage||c.navigator.language||"en-us",l=c.navigator.userLanguage||c.navigator.language||"en";k=k.toLowerCase(),l=l.toLowerCase(),l.indexOf("-")>-1&&(l=l.split("-")[0]);var m=!1,n=function(a){var b="bower_components/angular-i18n/angular-locale_"+a+".js";$.getScript(b).fail(function(){j.warn("Could not load "+b+" for language: "+a),$.getScript("bower_components/angular-i18n/angular-locale_no.js")})},o=function(a){-1!==["en","fr"].indexOf(a)?(e.loadTranslation(a),f.loadError(a),h.changeLocale(a)):(j.warn("Unsupported language: "+a+". Using english default language."),e.loadTranslation("en"),f.loadError("en"),h.changeLocale("en"))},p=function(){j.debug("Current user langRange:"+k+" and language:"+l),n(k),o(l),b.lang=l};g.get("userLanguageRange")&&(k=g.get("userLanguageRange"),l=d.getLanguage(k),p(),m=!0),m||p(),b.changeLang=function(a){c.location.reload(),k=a,l=a,g.set("userLanguageRange",a),p(),b.lang=a}}function j(a){a.defaults={scrollButtons:{scrollAmount:"auto",enable:!1},mouseWheel:{enable:!0,scrollAmount:60},scrollInertia:0,axis:"y",theme:"minimal-dark",autoHideScrollbar:!0}}function k(a,b,c){if(window.location){var d=!1;angular.forEach(c,function(a){window.location.hostname===a&&(d=!0)}),d?(a.setAccount({tracker:b}),a.setPageEvent("$stateChangeSuccess")):(a.setAccount({tracker:"NoAnalyticsHere"}),a.disableAnalytics(!0))}}angular.module("itcare").config(["$httpProvider","$injector",b]).config(["$provide",c]).config(["localStorageServiceProvider",d]).config(["$provide",e]).config(["ScrollBarsProvider",j]).config(["$breadcrumbProvider",function(a){a.setOptions({prefixStateName:"home",template:"bootstrap3"})}]).config(["AnalyticsProvider","GOOGLE_ANALYTICS_UID","GOOGLE_ANALYTICS_ALLOWED_HOSTNAMES",k]).run(["$log","DEBUG",f]).run(["$rootScope",a]).run(["$rootScope","$state","UserService","$log",g]).run(["$rootScope","$state","$log","UserService",h]).run(["$http","$rootScope","$window","userLanguage","translationProvider","errorProvider","localStorageService","amMoment","BACKEND_ENDPOINT","$log",i]).run(["Analytics",function(a){}]).run(["$log","serverProvider","localStorageService",function(a,b,c){a.debug("Loading configuration mode"),b.initConfigurationMode()}])}(),function(){"use strict";function a(a,b){var c;this.$get=["$injector",function(d){return{initConfigurationMode:function(){var e=d.get("$log"),f=d.get("$resource");c=a+"/guest/configuration-mode",e.debug("Getting the current configuration mode :"+c),f(c).get(function(a){c=a.configuration,e.debug("The configuration mode "+c+" is loading in success"),b="dev"==c?"true":"false",e.debug("So the debug is "+b)})},getMode:function(){return c}}}]}function b(a){var b={},c={};this.$get=["$injector",function(d){return{loadError:function(c){var e=(d.get("$rootScope"),d.get("$log")),f=d.get("$resource"),g=a+"/guest/errors?lang="+c;e.debug("Load error file from backend with url:"+g),f(g).get(function(a){b=a,e.debug("The Error File "+g+" is loaded")})},get:function(a){return b[a]},setServerErrors:function(a){c=a},getServerErrors:function(){return c},displayServerErrors:function(){var a=[];return angular.forEach(c,function(c,d){var e=b[c.code],f=e;c.on.length&&(f=e.replace("%s",c.on)),a.push(f)}),a}}}]}function c(a){var b={};this.$get=["$injector",function(c){return{loadTranslation:function(d){var e=c.get("$log"),f=c.get("$q"),g=c.get("$rootScope"),h=(c.get("$timeout"),c.get("$resource"),c.get("$http")),i=a+"/guest/appli-messages?lang="+d;e.debug("Load lang file from backend with url:"+i),f.all({backend:h.get(i),frontend:h.get("/assets/i18n/labels-"+d+".json")}).then(function(a){g.translation=[],g.translation=angular.merge(a.backend.data,a.frontend.data),b=g.translation,e.debug("Language set to : "+d),g.$broadcast("change-lang")})},get:function(a,c){var d=Array.prototype.slice.call(arguments);return d.shift(),b[a]?c?String.prototype.format.apply(b[a],d):b[a]:a},getAll:function(a){var c=[];return angular.forEach(b,function(b,d){-1!==d.indexOf(a)&&c.push({key:b})}),c}}}]}function d(a,b){b.get("$log").debug("Init Providers in ItCare Module...")}var e=angular.module("itcare");e.provider("errorProvider",["BACKEND_ENDPOINT",b]),e.provider("serverProvider",["BACKEND_ENDPOINT","DEBUG",a]),e.provider("translationProvider",["BACKEND_ENDPOINT",c]).run(["$log","$injector",d])}(),function(){"use strict";function a(){return function(a){return a.slice().reverse()}}function b(a){return function(b){if(angular.isString(b))return a.get(b)}}function c(){return function(a,b,c){return a.slice((b-1)*c,b*c)}}function d(a){return function(b){if(angular.isString(b))return a.get(b)}}function e(){return function(a,b){var c=[];return angular.forEach(a,function(a){a.name.toUpperCase().indexOf(b.toUpperCase())>-1&&c.push(a)}),c}}function f(){return function(a,b){var c=[];return angular.forEach(a,function(a){a.name.toUpperCase().indexOf(b.toUpperCase())>-1&&c.push(a)}),c}}function g(){return function(a,b){var c=[];return angular.forEach(a,function(a){var d=!0;""!==b&&(d=a.url.indexOf(b)>-1||a.ip.indexOf(b)>-1),d&&c.push(a)}),c}}function h(){return function(a){var b=[];return angular.forEach(a,function(a){"INACTIVE"!==a.status&&"ACTIVE"!==a.status||b.push(a)}),b}}function i(){return function(a){var b=[];return angular.forEach(a,function(a){""===a.description||"none"===a.description||null===a.description?(a.label=a.name,b.push(a)):(a.label=a.name+" ("+a.description+")",b.push(a))}),b}}function j(){return function(a){var b=[];return angular.forEach(a,function(a){"Hors catalogue"!=a.name&&"Out of catalogue"!=a.name||b.push(a)}),b}}function k(){return function(a){var b=[];return angular.forEach(a,function(a){"Hors catalogue"!=a.name&&"Out of catalogue"!=a.name&&b.push(a)}),b}}function l(a){return function(b){return a.trustAsHtml(b)}}function m(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}function n(){return function(a){return"SYSTEM_INSTANCE"===a.type?"PHYSICAL"==a.hostingtype?"fa fa-server":"fa fa-cube":"APPLI_ZONE_WEB"===a.type?"fa fa-linux":"APPLI_ZONE_ORACLE"===a.type?"fa fa-database":"APPLI_ZONE_SQLSERVER"===a.type?"fa fa-database":void 0}}function o(){return function(a){switch(a){case"PREPARATION":return"fa-spin fa-refresh";case"INACTIVE":return"fa-pause";case"ACTIVE":return"fa-play"}}}function p(){return function(a){switch(a){case 0:case"OK":return"label label-success";case 1:case"WARNING":return"label label-warning";case 2:case"CRITICAL":return"label label-danger";case 3:case"UNKNOWN":case 4:case"PENDING":return"label label-default";case 5:case"MAINTENANCE":return"label label-primary"}}}function q(a){return function(b){switch(b){case 0:case"OK":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATUS_OK_LABEL");case 1:case"WARNING":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATUS_WARNING_LABEL");case 2:case"CRITICAL":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATE_CRITICAL_LABEL");case 3:case"UNKNOWN":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATE_UNKNOWN_LABEL");case 4:case"PENDING":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATE_PENDING_LABEL");case 5:case"MAINTENANCE":return a.get("ITCARE_SERVICE_INSTANCE_MONITORING_STATE_MAINTENANCE_LABEL")}}}function r(){return function(a){switch(a){case 0:case"IN_PROGRESS":return"label label-danger";case 1:case"TRIAGE":return"label label-warning";case 2:case"SOLVED":return"label label-success";case 3:case"CLOSED":case 4:case"AWAITING_RESPONSE":return"label label-default";case 5:case"TO_VALIDATE":return"label label-primary"}}}function s(a){return function(b){switch(b){case 0:case"IN_PROGRESS":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_IN_PROGRESS");case 1:case"TRIAGE":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_TRIAGE");case 2:case"SOLVED":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_SOLVED");case 3:case"CLOSED":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_CLOSED");case 4:case"AWAITING_RESPONSE":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_AWAITING_RESPONSE");case 5:case"TO_VALIDATE":return a.get("ITCARE_SERVICE_TICKETING_SEARCH_RESULT_TO_VALIDATE")}}}function t(){return function(a){return moment(a,["DD/MM/YYYY hh:mm:ss",moment.ISO_8601])}}function u(a){return function(a,b){return void 0===b&&(b=2),parseFloat(100*a).toFixed(b)+"%"}}function v(){return function(a){var b=moment.duration({seconds:a}),c=function(a,b){return("00000000"+a).substr(-b)},d="";return b.days()>0&&(d+=b.days()+"d"),(b.hours()>0||d.length>0)&&(d+=c(b.hours(),2)+"h"),(b.minutes()>0||d.length>0)&&(d+=c(b.minutes(),2)+"m"),(b.seconds()>0||d.length>0)&&(d+=c(b.seconds(),2)+"s"),d}}function m(){return function(a){return a?1==a.length?a.toUpperCase():a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase():a}}function w(){return function(a){var b=parseInt(a,10);return isNaN(b)?a:b<1e3?b:b<1e6?(b/1e3).toFixed(0)+"k":b<1e9?(b/1e3/1e3).toFixed(0)+"m":b<1e12?(b/1e3/1e3/1e3).toFixed(0)+"g":(b/1e3/1e3/1e3/1e3).toFixed(0)+"t"}}function x(){return function(a,b){void 0===b&&(b="iB");var c=parseInt(a,10);return isNaN(c)?a:c<1024?c.toFixed(0)+b:c<1048576?(c/1024).toFixed(0)+"k"+b:c<1073741824?(c/1024/1024).toFixed(1)+"M"+b:c<1099511627776?(c/1024/1024/1024).toFixed(1)+"G"+b:c<0x4000000000000?(c/1024/1024/1024/1024).toFixed(1)+"T"+b:c<0x1000000000000000?(c/1024/1024/1024/1024/1024).toFixed(1)+"P"+b:(c/1024/1024/1024/1024/1024/1024).toFixed(1)+"E"+b}}function y(){return function(a){var b=parseInt(a,10);return isNaN(b)?a:b<1e3?b:b<1e6?(b/1e3).toFixed(1)+"k":b<1e9?(b/1e3/1e3).toFixed(1)+"M":(b/1e3/1e3/1e3).toFixed(1)+"B"}}function z(a){a.debug("Init Filters in ItCare Module...")}var A=angular.module("itcare");A.filter("displayErrors",["errorProvider",b]),A.filter("displayMessages",["translationProvider",d]),A.filter("instanceTypeIconClass",n),A.filter("clusterFilter",f),A.filter("instanceFilter",e),A.filter("loadBalancerFilter",g),A.filter("memberPoolFilter",h),A.filter("stateInstanceToLabel",p),A.filter("stateInstanceToStr",["translationProvider",q]),A.filter("stateTicketToLabel",r),A.filter("stateTicketToStr",["translationProvider",s]),A.filter("longFormatDateFilter",t),A.filter("percentage",["$log",u]),A.filter("humanReadableDuration",v),A.filter("capitalize",m),A.filter("shorten",w),A.filter("shortenStorage",x),A.filter("bigNumberSorten",y),A.filter("reverse",a),A.filter("paginate",c),A.filter("resourceStatusIcon",o),A.filter("healthcheckDescriptionFilter",i),A.filter("catalogueOutFilter",j),A.filter("catalogueInFilter",k),A.filter("sanitize",["$sce",l]),A.run(["$log",z])}(),function(){"use strict";angular.module("itcare").config(["$stateProvider","$urlRouterProvider","$locationProvider","$urlMatcherFactoryProvider",function(a,b,c,d){function e(a){return null!==a?a.toString():a}c.html5Mode(!0),c.hashPrefix("!"),d.type("nonURIEncoded",{encode:e,decode:e,is:function(){return!0}}),b.otherwise(function(a,b){b.path("/login")}),a.state("logout",{url:"/logout",controller:["$state","UserService","$log",function(a,b,c){b.logout().then(function(d){c.debug("logout performed."),b.removeCurrentUser(),a.go("login")},function(a){})}]}).state("notfound",{url:"/notfound",templateUrl:"error.notfound.html"}).state("error",{url:"/error",templateUrl:"error.html"}).state("forbidden",{url:"/forbidden",templateUrl:"error.forbidden.html"})}])}(),function(){"use strict";angular.module("itcare.business",["ngResource","ngCookies","ngAnimate","toaster"])}(),function(){"use strict";function a(a,b){var c={};return c.getIndicator=function(c,d,e){void 0===e&&(e="");var f={view:e},g=b+"/api/services/"+c+"/indicators/"+d,h={};return a.get(g,{headers:h,params:f},{})},c.getIndicatorAvailabilityAnalysis=function(c,d,e,f){var g=b+"/api/services/"+c+"/indicators/"+d+"/availability-analysis",h={};return a.get(g,{headers:h,params:{year:e,month:f}},{})},c.getIndicatorInterruptions=function(c,d,e,f){var g=b+"/api/services/"+c+"/indicators/"+d+"/interruptions",h={};return a.get(g,{headers:h,params:{year:e,month:f}},{})},c.getIndicatorAvailability=function(c,d,e,f){var g=b+"/api/services/"+c+"/indicators/"+d+"/availability",h={};return a.get(g,{headers:h,params:{year:e,month:f}},{})},c.getLiveAvailability=function(c,d){var e=b+"/api/services/"+c+"/indicators/"+d+"/live-availability",f={};return a.get(e,{headers:f},{})},c.createIndicator=function(c,d){var e=b+"/api/services/"+c+"/indicators",f={};return a.post(e,d,{headers:f})},c.updateIndicator=function(c,d){var e=b+"/api/services/"+c+"/indicators/"+d.id,f={};return a.put(e,d,{headers:f})},c.deleteIndicator=function(c,d){var e=b+"/api/services/"+c+"/indicators/"+d;return a.delete(e,{})},c.getIndicatorByName=function(c,d){var e=b+"/api/services/"+c+"/indicators",f={};return a.get(e,{headers:f,ignoreLoadingBar:!0,params:{name:d}},{})},c.getAvailabilityTimeRanges=function(){return{standard:{editable:!1,weekdays:[{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!1},{startHour:8,endHour:18.5,checked:!1}]},allWeek:{editable:!1,weekdays:[{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0},{startHour:0,endHour:24,checked:!0}]},custom:{editable:!0,weekdays:[{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!0},{startHour:8,endHour:18.5,checked:!1},{startHour:8,endHour:18.5,checked:!1}]}}},c.determineAvailabilityTimeRange=function(a,b){for(var d=a.split(";"),e=b.split(";"),f=[],g=0;g<7;g++){var h={};h.checked="1"==d[g];var i=e[g].split("-"),j=i[0].split(":"),k=i[1].split(":");h.startHour=parseInt(j[0])+parseInt(j[1])/60,h.endHour=parseInt(k[0])+parseInt(k[1])/60,f.push(h)}for(var l=["standard","allWeek"],m=c.getAvailabilityTimeRanges(),n=null,o=0;o<l.length;o++){for(var p=m[l[o]],q=0,r=0,s=0;s<7;s++){var t=p.weekdays[s],u=f[s];if(t.checked){if(r++,t.checked!=u.checked||t.startHour!=u.startHour||t.endHour!=u.endHour)break;q++}else if(u.checked){r++;break}}if(q==r){n=l[o];break}}return null==n&&(n="custom"),{type:n,weekdays:f}},c.getAvailabilityCalHeatmap=function(a){var b={};return angular.forEach(a,function(a,c){var d=moment.utc(a.date).toDate().getTime(),e=(100*a.availabilityPercent).toFixed(2);b[d/1e3]=parseFloat(e)}),b},c}angular.module("itcare.business").factory("IndicatorService",["$http","BACKEND_ENDPOINT",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(a,b){if(0===a.length)return 0;if("number"!=typeof b)throw new TypeError("Percentile must be a number!");if(b<=0)return a[0];if(b>=1)return a[a.length-1];var c=a.length*b,d=Math.floor(c),e=d+1,f=c%1;return e>=a.length?a[d]:a[d]*(1-f)+a[e]*f}var g={},h=["Bytes","KB","MB","GB","TB"];return g.defaultChartD3Options=function(){return{chart:{type:"lineChart",height:"",margin:{top:40,bottom:40},x:function(a){return void 0!==a?a[0]:0},y:function(a){return void 0!==a?a[1]:0},useInteractiveGuideline:!1,interactive:!1,duration:500,showLegend:!1,color:d3.scale.category10().range(),tooltip:{enabled:!1},dispatch:{renderEnd:"",stateChange:"",changeState:""},xAxis:{showMaxMin:!1,tickFormat:function(a){return""}},yAxis:{showMaxMin:!1,axisLabel:"",tickFormat:function(a){return d3.format(".f")(a)}},noData:d.get("ITCARE_SERVICE_INSTANCE_PERFORMANCE_NO_GRAPH"),legend:{vers:"classic",dispatch:{}},interactiveLayer:{tooltip:{headerFormatter:{}}}}}},g.computePercentile=function(a,b){if(0!=b.length&&"false"!==a.percentile){var c=new Array(b[0].values.length);angular.forEach(b,function(a){angular.forEach(a.values,function(a,b){c[b]||(c[b]=new Array(2),c[b][0]=a[0],c[b][1]=a[1]),a[1]>c[b][1]&&(c[b][1]=a[1])})});var d=e.map(c,function(a){return a[1]});d.sort(function(a,b){return a-b}),b.push({key:"95e",values:e.map(c,function(a){return[a[0],f(d,.95)]}),type:"line",classed:"dashed",threshold:!1,percentile:!0}),a.metrics.push({name:"95e",title:"95e"})}},g.computeDomain=function(a,b){-1===a.unit.indexOf("%")?_.isEmpty(a.domain.customMin)&&_.isEmpty(a.domain.customMax)||0==a.domain.customMin&&0==a.domain.customMax?angular.forEach(b,function(b){var c=d3.min(b.values,function(a){return a[1]}),d=d3.max(b.values,function(a){return a[1]});a.domain.min>c&&(a.domain.min=d3.format(".03f")(c)),a.domain.max<d&&(a.domain.max=d3.format(".03f")(d))}):(a.domain.min=a.domain.customMin,a.domain.max=a.domain.customMax):a.unit.indexOf("%")>-1&&(a.domain={min:0,max:100})},g.computeLegend=function(a,b){if(a.dynamic)return b?b.name:"";var c=b.name;return _.isEmpty(b.title)||(c=b.title),_.isEmpty(a.unit)||(c+=" ("+a.unit+")"),c},g.mapConfig=function(a){return{start:void 0,end:void 0,domain:{min:0,max:0,customMin:0==a.min.length?"":a.min,customMax:0==a.max.length?"":a.max},name:a.name,dynamic:a.dynamic,title:a.title,mode:"thumbs",unit:a.unit,customizeUnit:g.computeCustomizeUnit(a.unit),percentile:a.percentile,displayHostName:!1,loading:!0,displayed:!1,metrics:e.map(a.metrics,function(a){return{title:a.title,name:a.name}})}},g.computeCustomizeUnit=function(a){return-1!==a.indexOf("bytes")?"bytes":-1!==a.indexOf("%")?"percent":""},g.mapMetric=function(a,b){return{key:_.isEmpty(a.title)?a.name:a.title,values:b,area:!0,disabled:!1,strokeWidth:2,type:"line"}},g.computeUnit=function(a,b){switch(a.customizeUnit){case"bytes":var c=[];angular.forEach(b,function(a){c=c.concat(a.values)});var d=d3.max(c,function(a){return a[1]}),f=g.computeReadableUnit(d);a.unit=f+"/s",angular.forEach(b,function(a){a.values=e.map(a.values,function(a){return[a[0],g.computeReadableSize(a[1],f)]})});break;case"percent":a.unit="Percent (%)"}},g.computeReadableSize=function(a,b){if(0==a)return 0;var c=e.findIndex(h,function(a){return a==b});return 0==c?a:parseFloat((a/Math.pow(1024,c)).toFixed(3))},g.computeReadableUnit=function(a){if(0==a)return"n/a";var b=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return h[b]},g.getConfiguration=function(a,d,f){var h={},i={},j=b.defer(),k=void 0;return k="service"===d?c.getConfigurationByService:"instance"===d?c.getConfigurationByInstance:"cluster"===d?c.getConfigurationByCluster:"hardware"===d?c.getConfigurationByHardware:c.getConfigurationByLoadBalancer,k(a,f).success(function(a){angular.forEach(a,function(a){var b=Object.keys(a);i[b]=e.map(a[b],function(a){return g.mapConfig(a)})}),h=i,j.resolve(h)}).error(function(){j.reject("Failed to load configuration for resource "+a)}),j.promise},g.getConfigurationByIndicator=function(a,d){var f={},h={},i=b.defer(),j=void 0;return j=c.getConfigurationByIndicator,j(a,d).success(function(a){angular.forEach(a,function(a){var b=Object.keys(a);h[b]=e.map(a[b],function(a){return g.mapConfig(a)})}),f=h,i.resolve(f)}).error(function(){i.reject("Failed to load configuration for resource "+id)}),i.promise},g.getPerformanceByGraphic=function(a,d,e,f,h,i){var j=b.defer(),k=void 0;return k="instance"==d?c.getGraphByInstance:"hardware"==d?c.getGraphByHardware:c.getGraphByLoadBalancer,k(a,e,f,h,i.name).success(function(b){var c=[];"true"==i.dynamic?b[a][i.name]&&angular.forEach(b[a][i.name],function(a,b){c.push(g.mapMetric({name:b},a))}):angular.forEach(i.metrics,function(d){b[a][i.name]&&b[a][i.name][d.name]&&c.push(g.mapMetric(d,b[a][i.name][d.name]))}),j.resolve(c)}).error(function(){j.reject("Failed to load datas for resource "+a+" and graphic "+i)}),j.promise},g.getPerformanceByResource=function(a,d,e,f,g,h){var i=b.defer();return"instance"==d?c.getInstancePerformance:c.getLoadBalancerPerformance,i.promise},g}angular.module("itcare.business").factory("ChartService",["$log","$q","CiService","TranslationService","lodash",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h={};return h.busy=!1,h.from="",h.to="",h.getServices=function(c,d,e){var f=b+"/api/services?environment="+c+"&status="+d+"&name="+e;return a.get(f,{})},h.getGraphByInstance=function(c,d,e,f,g){var h=b+"/api/instances/"+c+"/graph?start="+d+"&end="+e+"&graph-name="+g+"&points="+f;return a.get(h,{})},h.getGraphByHardware=function(c,d,e,f,g){var h=b+"/api/hardwares/"+c+"/graph?start="+d+"&end="+e+"&graph-name="+g+"&points="+f;return a.get(h,{})},h.getGraphByLoadBalancer=function(c,d,e,f,g){var c=b+"/api/loadbalancers/"+c+"/graph?start="+d+"&end="+e+"&graph-name="+g+"&points="+f;return a.get(c,{})},h.getCloudOverview=function(){var c=b+"/api/cloud-overview",d={};return a.get(c,{headers:d,params:{clouds:f.getCloudFiltersList()}})},h.getServicesOverview=function(){var c=b+"/api/services-overview";return a.get(c,{})},h.getMonitoringOverview=function(){var c=b+"/api/monitoring-overview";return a.get(c,{ignoreLoadingBar:!0,params:{clouds:f.getCloudFiltersList()}})},h.getInstancesObsolescence=function(c){var d=b+"/api/instances-obsolescence-stats";return a.get(d,{params:{date:c}})},h.getInstancesObsolescenceForService=function(c,d){var e=b+"/api/services/"+c+"/obsolescence";return a.get(e,{params:{date:d}})},h.getInstancesObsolescencePerPlatform=function(c){var d=b+"/api/platforms-obsolescence";return a.get(d,{params:{date:c}})},h.getInstancesObsolescencePerPlatformForService=function(c,d){var e=b+"/api/services/"+c+"/platforms-obsolescence";return a.get(e,{params:{date:d}})},h.getInstancesPlatforms=function(){var c=b+"/api/instances-platforms";return a.get(c,{params:{}})},h.getInstanceMonitoringStatusHistory=function(c,d){var e=b+"/api/instances/"+c+"/monitoring/"+d+"/state-history";return a.get(e,{})},h.enableInstanceMonitoringStatus=function(c,d){var e={operation:"enable_monitoring",options:{comment:d}},f=b+"/api/instances/"+c.instanceId;return a({url:f,method:"PATCH",data:e})},h.disableInstanceMonitoringStatus=function(c,d){var e={operation:"disable_monitoring",options:{comment:d}},f=b+"/api/instances/"+c.instanceId;return a({url:f,method:"PATCH",data:e})},h.enableClusterMonitoringStatus=function(c,d){var e={operation:"enable_monitoring",options:{comment:d}};console.log("enable_monitoring :"+e);var f=b+"/api/clusters/"+c.clusterId;return a.patch(f,e)},h.disableLClusterMonitoringStatus=function(c,d){var e={operation:"disable_monitoring",options:{comment:d}};console.log("disable_monitoring :"+e);var f=b+"/api/clusters/"+c.clusterId;return a.patch(f,e)},h.enableLBMonitoringStatus=function(c,d){var e={operation:"enable_monitoring",options:{comment:d}};console.log("enable_monitoring :"+e);var f=b+"/api/loadbalancers/"+c.url;return a.patch(f,e)},h.disableLBMonitoringStatus=function(c,d){var e={operation:"disable_monitoring",options:{comment:d}};console.log("disable_monitoring :"+e);var f=b+"/api/loadbalancers/"+c.url;return a.patch(f,e)},h.getHardwareMonitoringStatusHistory=function(c,d){var e=b+"/api/hardwares/"+c+"/monitoring/"+d+"/state-history";return a.get(e,{})},h.getLoadBalancerMonitoringStatusHistory=function(c,d){var c=b+"/api/loadbalancers/"+c+"/monitoring/"+d+"/state-history";return a.get(c,{})},h.getServicesWithPaginate=function(c,d,e,f,g,h,i){var j={environment:c,status:d,name:e,page:g,limit:h,tags:f,cached:!1},k=b+"/api/services";return a.get(k,{params:j})},h.getResourcesWithPaginate=function(c,d,e,g,h,i,j,k){var l={name:g,types:c,statuses:e,clouds:f.getCloudFiltersList(),environments:d,tags:h,page:i,size:j,cached:!1},m=b+"/api/resources";return a.get(m,{params:l})},h.getStatus=function(){var c=b+"/api/statuses";return a.get(c,{})},h.getApiStatus=function(){return a.get(b+"/api/status",{})},h.getEnvironment=function(){var c=b+"/api/environments";return a.get(c,{})},h.getServiceDetail=function(c){var d=b+"/api/services/"+c+"?view=credentials";return a.get(d)},h.getServiceDetailByGlobalServiceId=function(c,d){void 0===d&&(d={});var e=b+"/api/services/"+c+"?view=live-availability,credentials,obsolescence,actions-in-progress,tags,relations";return a.get(e,d)},h.getServiceTickets=function(c){var d=b+"/api/services/"+c+"/tickets";return a.get(d)},h.getServiceDetailNoViewByGlobalServiceId=function(c,d){void 0===d&&(d={});var e=b+"/api/services/"+c;return a.get(e,d)},h.getServiceDetailNetworkByGlobalServiceId=function(c,d){void 0===d&&(d={});var e=b+"/api/services/"+c+"?view=network";return a.get(e,d)},h.getServiceActionsByGlobalServiceId=function(c){var d=b+"/api/services/"+c+"/history",e={};return a.get(d,{headers:e},{})},h.search=function(c,d){var e=b+"/api/search",g={};return void 0===d&&(d=""),a.get(e,{headers:g,ignoreLoadingBar:!0,params:{q:c,clouds:f.getCloudFiltersList(),types:d}},{})},h.getMonitoringChecksByServiceId=function(c){var d=b+"/api/services/"+c+"/monitoring-checks",e={};return a.get(d,{},{headers:e})},h.getResourcesByServiceId=function(c,d){var e=b+"/api/services/"+c,f={},g="credentials";return d&&(g+=",actions-in-progress"),a.get(e,{params:{view:g}},{headers:f})},h.getServiceAutomationById=function(c){var d=b+"/api/services/"+c,e={};return a.get(d,{ignoreLoadingBar:!0,params:{view:"actions-in-progress"}},{headers:e})},h.searchMonitoringChecks=function(c){var d=b+"/api/search",e={};return a.get(d,{params:{q:c,view:"monitoring-checks"}},{headers:e})},h.searchResources=function(c){var d=b+"/api/search",e={};return a.get(d,{params:{q:c,types:"instance,loadbalancer",authorities:"auto_maintenance",view:"actions-in-progress"}},{headers:e})},h.searchServices=function(c){var d=b+"/api/search",e={};return a.get(d,{params:{q:c,types:"service"},ignoreLoadingBar:!0},{headers:e})},h.getMonitoringMetricsByServiceId=function(c){var d=b+"/api/services/"+c+"/monitoring-metrics",e={};return a.get(d,{},{headers:e})},h.searchMetrics=function(c){var d=b+"/api/search",e={};return a.get(d,{params:{q:c,view:"monitoring-metrics"},ignoreLoadingBar:!1,silentFailure:!0},{headers:e})},h.getInstanceDetailById=function(c,d){d=void 0!==d&&d;var e=b+"/api/instances/"+c.instanceId;return a.get(e,{params:{view:"information,monitoring,snapshots,credentials,maintenances,actions-in-progress,tags"},ignoreLoadingBar:d},{withCredentials:!1})},h.getInstanceTickets=function(c){var d=b+"/api/instances/"+c+"/tickets";return a.get(d,{},{withCredentials:!1})},h.getInstanceDetailNoViewById=function(c,d){d=void 0!==d&&d;var e=b+"/api/instances/"+c.instanceId;return a.get(e,{params:{view:""},ignoreLoadingBar:d},{withCredentials:!1})},h.getActionsByClusterId=function(c){var d=b+"/api/clusters/"+c+"/history";return a.get(d,{},{withCredentials:!1})},h.getActionsByInstanceId=function(c){var d=b+"/api/instances/"+c+"/history";return a.get(d,{},{withCredentials:!1})},h.getLoadBalancerDetailByUrl=function(c,d){var c=b+"/api/loadbalancers/"+c;return a.get(c,{params:{view:"information,monitoring,credentials,maintenances,actions-in-progress,tags,irules"},ignoreLoadingBar:d},{withCredentials:!0})},h.getLoadBalancerTickets=function(c){var c=b+"/api/loadbalancers/"+c+"/tickets";return a.get(c,{},{withCredentials:!0})},h.getHardwareDetailById=function(c,d){var e=b+"/api/hardwares/"+c;return a.get(e,{params:{view:"monitoring,tags"},ignoreLoadingBar:d},{withCredentials:!0})},h.getActionsByLoadBalancerUrl=function(c){var c=b+"/api/loadbalancers/"+c+"/history";return a.get(c,{},{withCredentials:!0})},h.getLoadBalancersByLinkedResources=function(c){var d=b+"/api/loadbalancers/linked-resources";return a.get(d,{params:{"instance-ids":c}},{withCredentials:!0})},h.getInstancePerformance=function(c,d,e,f){var g=b+"/api/instances/"+c+"/performance";return a.get(g,{params:{start:d,end:e,points:f}},{withCredentials:!0})},h.getHardwarePerformance=function(c,d,e,f){var g=b+"/api/hardwares/"+c+"/performance";return a.get(g,{params:{start:d,end:e,points:f}},{withCredentials:!0})},h.getLoadBalancerPerformance=function(c,d,e,f){var c=b+"/api/loadbalancers/"+c+"/performance";return a.get(c,{params:{start:d,end:e,points:f}},{withCredentials:!0})},h.getConfigurationByInstance=function(c,d){var e=b+"/api/instances/"+c+"/performance-configuration";return a.get(e,{params:{view:d}},{withCredentials:!0})},h.getConfigurationByCluster=function(c,d){var e=b+"/api/clusters/"+c+"/performance-configuration";return a.get(e,{params:{view:d}},{withCredentials:!0})},h.getConfigurationByLoadBalancer=function(c,d){var e=b+"/api/loadbalancers/"+c+"/performance-configuration";return a.get(e,{params:{view:d}},{withCredentials:!0})},h.getConfigurationByHardware=function(c,d){var e=b+"/api/hardwares/"+c+"/performance-configuration";return a.get(e,{params:{view:d}},{withCredentials:!0})},h.getConfigurationByService=function(c){var d=b+"/api/services/"+c+"/performance-configuration";return a.get(d,{})},h.getConfigurationByIndicator=function(c,d){var e=b+"/api/services/"+c+"/indicators/"+d+"/performance-configuration";return a.get(e,{})},h.getInstanceAutomation=function(c){var d=b+"/api/instances/"+c;return a.get(d,{ignoreLoadingBar:!0,params:{view:"actions-in-progress"}},{withCredentials:!0})},h.getLoadBalancerAutomation=function(c){var c=b+"/api/loadbalancers/"+c;return a.get(c,{ignoreLoadingBar:!0,params:{view:"actions-in-progress"}},{withCredentials:!0})},h.getInstancesObsolescenceByServiceDetails=function(c){var d={serviceId:c,clouds:f.getCloudFiltersList()},e=b+"/api/instances-obsolescence";return a.get(e,{params:d},{withCredentials:!0})},h.getGraphDatasByName=function(c){var d=b+"/api/instances/"+c.instanceName+"/graph?graph-name="+c.graph+"&start="+c.start+"&end="+c.end,e={};return a.get(d,{headers:e},{})},h.deleteVS=function(c,d){var e={changeReference:d},f=b+"/api/loadbalancers/"+c.url;return a({url:f,method:"DELETE",data:e})},h.resetVM=function(c,d){var e={operation:"reset",options:{comment:d}},f=b+"/api/instances/"+c.instanceId;return a({url:f,method:"PATCH",data:e})},h.disableVS=function(c,d){var e={operation:"stop",options:{changeReference:d}},f=b+"/api/loadbalancers/"+c.url;return a.patch(f,e)},h.enableVS=function(c,d){var e={operation:"start"},f=b+"/api/loadbalancers/"+c.url;return a.patch(f,e)},h.deleteVM=function(c,d){var e={changeReference:d},f=b+"/api/instances/"+c.instanceId;return a({url:f,method:"DELETE",data:e})},h.disableVM=function(c,d){var e={operation:"stop",options:{changeReference:d}},f=b+"/api/instances/"+c.instanceId;return a.patch(f,e)},h.enableVM=function(c,d){var e={operation:"start"},f=b+"/api/instances/"+c.instanceId;return a.patch(f,e)},h.patchTagsOfLoadBalancer=function(c,d){if(c.url){e.forEach(d,function(a){a.tagValue=a.tagValue.split(":").join("&#58;")});var f={operation:"update_tags",options:{tags:d}},g=b+"/api/loadbalancers/"+c.url;return a.patch(g,f)}},h.patchTagsOfCluster=function(c,d){if(c.clusterId){e.forEach(d,function(a){a.tagValue=a.tagValue.split(":").join("&#58;")});var f={operation:"update_tags",options:{tags:d}},g=b+"/api/clusters/"+c.clusterId;return a.patch(g,f)}},h.patchTagsOfInstance=function(c,d){if(c.instanceId){e.forEach(d,function(a){a.tagValue=a.tagValue.split(":").join("&#58;")});var f={operation:"update_tags",options:{tags:d}},g=b+"/api/instances/"+c.instanceId;return a.patch(g,f)}},h.patchTagsOfHardware=function(c,d){if(c.hardwareId){e.forEach(d,function(a){a.tagValue=a.tagValue.split(":").join("&#58;")});var f={operation:"update_tags",options:{tags:d}},g=b+"/api/hardwares/"+c.hardwareId;return a.patch(g,f)}},h.patchTagsOfService=function(c,d){if(c.serviceId){e.forEach(d,function(a){a.tagValue=a.tagValue.split(":").join("&#58;")});var f={operation:"update_tags",options:{tags:d}},g=b+"/api/services/"+c.serviceId;return a.patch(g,f)}},h.createSnapshot=function(c,d,e){var f={description:d,changeReference:e},g=b+"/api/instances/"+c.instanceId+"/snapshots";return a.post(g,f)},h.deleteSnapshot=function(c,d){var e=b+"/api/instances/"+c.instanceId+"/snapshots/"+d;return a.delete(e)},h.recoverSnapshot=function(c,d){var e=b+"/api/instances/"+c.instanceId+"/snapshots/"+d;return a({url:e,method:"PATCH",data:{}})},h.createMaintenance=function(c,d){var e=b+"/api/maintenances";return a.post(e,d)},h.deleteMaintenance=function(c,d,e){var f=b+"/api/maintenances/"+c;return a.delete(f,{params:{instancesId:d,loadbalancersId:e}},{withCredentials:!0})},h.getResourcesMaintenance=function(c){var d=b+"/api/maintenances/"+c+"?view=resources",e={};return a.get(d,{headers:e},{})},h.getTagKeysContaining=function(c,d){var e={key:"*"+c+"*",types:d},f=b+"/api/tag-keys";return a.get(f,{params:e},{})},h.getTagValuesForKey=function(c){var d={key:c},e=b+"/api/tag-values";return a.get(e,{params:d},{})},h.getClusterDetailById=function(c,d){d=void 0!==d&&d;var e=b+"/api/clusters/"+c.clusterId;return a.get(e,{params:{view:"information,monitoring,snapshots,credentials,maintenances,actions-in-progress,tags"},ignoreLoadingBar:d},{withCredentials:!1})},h.deleteNamespace=function(c,d){var e=b+"/api/clusters/"+c.clusterId+"/namespaces/"+d;return a.delete(e)},h.createNamespace=function(c,d){var e={name:d},f=b+"/api/clusters/"+c.clusterId+"/namespaces";return a.post(f,e)},h.createNodes=function(c,d){if(c.clusterId){var e={operation:"create_nodes",options:{nodesNb:d.nodesNb,nodeSizing:d.nodeSizing}},f=b+"/api/clusters/"+c.clusterId;return a.patch(f,e)}},h}angular.module("itcare.business").factory("CiService",["$http","BACKEND_ENDPOINT","$interval","$rootScope","lodash","UserPreferencesService","UtilService",a])}(),function(){"use strict";function a(a,b,c){var d={};return d.getObjectStoresSummary=function(d,e){var f={clouds:b.getCloudFiltersList()};return(0|d)===d&&(f.serviceId=d),e&&e.length>0&&(f.searchFilter=e),a.get(c+"/api/object-stores-summary",{silentFailure:!0,ignoreLoadingBar:!0,params:f})},d.getObjectStores=function(d,e,f,g,h){var i={view:"credentials,detail,tags",clouds:b.getCloudFiltersList()};return(0|e)===e&&(i.page=e),(0|f)===f&&(i.size=f),(0|h)===h&&(i.serviceId=h),g&&g.length>0&&(i.names=g),d&&d.length>0&&(i.searchFilter=d),a.get(c+"/api/object-stores",{params:i})},d.getObjectStore=function(b){return a.get(c+"/api/object-stores/"+b+"?view=credentials,detail,tags",{})},d.getObjectStoresUsers=function(b,d,e){var f=c+"/api/object-stores/"+b+"/users";return void 0!==d&&void 0!==e&&(f=f+"?page="+d+"&size="+e),a.get(f,{})},d.getLocations=function(){return a.get(c+"/api/object-stores-locations",{})},d.searchServices=function(b){return a.get(c+"/api/search?q="+b+"&types=service&authorities=CI_CREATE",{})},d.checkName=function(b){var d=c+"/api/object-stores/available",e={};return a.get(d,{headers:e,ignoreLoadingBar:!0,params:{name:b}},{})},d.availableActions=function(){var b=c+"/api/object-stores/available-actions",d={};return a.get(b,{headers:d,ignoreLoadingBar:!1},{})},d.getStatus=function(){var b=c+"/api/object-stores/status";return a.get(b,{})},d.countUsers=function(b){var d=c+"/api/object-stores/"+b+"/users/count";return a.get(d,{})},d.updateTags=function(b,d){var e={operation:"update_tags",options:{tags:d}},f=c+"/api/object-stores/"+b;return a.patch(f,e)},d.delete=function(b){var d=c+"/api/object-stores/"+b;return a.delete(d)},d.create=function(b,d,e,f,g){var h={name:b,locationId:e,serviceId:f,email:g};void 0!==d&&0!==d&&(h.quotaSizeGb=d);var i=c+"/api/object-stores/";return a.post(i,h)},d.createUser=function(b,d){var e={label:d},f=c+"/api/object-stores/"+b+"/users";return a.post(f,e)},d.updateUserOperation=function(b,d,e,f){var g={};void 0!=e&&(g.operation=e),void 0!=f&&(g.options=f);var h=c+"/api/object-stores/"+b+"/users/"+d;return a.patch(h,g)},d.deleteUser=function(b,d){var e=c+"/api/object-stores/"+b+"/users/"+d;return a.delete(e)},d.updateQuota=function(b,d){var e={operation:"update_quota",options:{quotaSizeGb:d}},f=c+"/api/object-stores/"+b;return a.patch(f,e)},d}angular.module("itcare.business").factory("ObjectStoresService",["$http","UserPreferencesService","BACKEND_ENDPOINT",a])}(),function(){"use strict";function a(a,b,c,d,e,f){var g={};return g.getPlatforms=function(){var b=c+"/api/platforms";return a.get(b,{ignoreLoadingBar:!0})},g.getRegionsAvailableOnPlatform=function(b){var d=c+"/api/regions",e={platformId:b};return a.get(d,{params:e,ignoreLoadingBar:!0})},g.getPlatform=function(b){var d=c+"/api/platforms/"+b+"?view=regions";return a.get(d,{ignoreLoadingBar:!0})},g.getNetworksByRegionAndAreaAndAvailabilityZone=function(d,e,f,g){var h={onlyNonFull:!0,clouds:b.getCloudFiltersList()};"mixed"!=g&&(h.scope=g);var i=c+"/api/regions/"+d+"/areas/"+e+"/availability-zones/"+f+"/networks";return a.get(i,{params:h,ignoreLoadingBar:!0})},g.getAreasByRegionWithPlatform=function(b,d){var e=c+"/api/regions/"+b+"/areas?view=availability-zones&platformId="+d;return a.get(e,{ignoreLoadingBar:!0})},g.checkInstanceName=function(b){var d=c+"/api/instances/available",e={};return a.get(d,{headers:e,ignoreLoadingBar:!0,params:{name:b}},{})},g.getAuthenticationDomainsByNetwork=function(b,d,e,f){var g=c+"/api/regions/"+b+"/areas/"+d+"/availability-zones/"+e+"/networks/"+f+"/authentication-domains";return a.get(g,{ignoreLoadingBar:!0})},g.getSuggestedHostNames=function(b,d,e){var f={region:d,platformId:e},g=c+"/api/services/"+b+"/suggested-instance-name";return a.get(g,{params:f,ignoreLoadingBar:!0})},g.createInstance=function(b,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v={name:b,serviceId:d,platform:e,region:g,area:h,availabilityZone:i,networkId:j,resourceId:k,monitoringEnabled:q,onCallSupervision:p,backupEnabled:o,backupOffSiteEnabled:n,authenticationDomainId:r,specificRequest:s};t&&(a.defaults.headers.post["ITCare-DebugMode"]="true"),u&&(a.defaults.headers.post["ITCare-DryRun"]="true"),l.length>0&&(v.volumes=[]),angular.forEach(l,function(a){v.volumes.push({id:a.id,sizeGb:a.sizeGb})}),m.length>0&&(v.properties=[]),angular.forEach(m,function(a){v.properties.push({key:a.key,value:a.value?a.value:a.defaultValue})});var w=c+"/api/instances/",x=a.post(w,v);return f.unset(a.defaults.headers.post,"ITCare-DebugMode"),f.unset(a.defaults.headers.post,"ITCare-DryRun"),x},g}angular.module("itcare.business").factory("InstanceService",["$http","UserPreferencesService","BACKEND_ENDPOINT","$log","$timeout","lodash",a])}(),function(){"use strict";function a(a,b,c,d,e,f){var g={};return g.getMembersNetwork=function(b){var d=c+"/api/services/"+b+"/instances?view=network";return a.get(d,{ignoreLoadingBar:!0})},g.getNetworksByAvaibilityZoneAndRegion=function(d,e,f,g){var h={onlyNonFull:!0,clouds:b.getCloudFiltersList()};"mixed"!=g&&(h.scope=g);var i=c+"/api/regions/"+d+"/areas/"+e+"/availability-zones/"+f+"/networks";return a.get(i,{params:h,ignoreLoadingBar:!0})},g.getNetworksByLoadBalancingZoneAndRegion=function(d,e,f){var g={onlyNonFull:!0,clouds:b.getCloudFiltersList()};"mixed"!=f&&(g.scope=f);var h=c+"/api/regions/"+d+"/areas/"+e+"/loadbalancers-networks";return a.get(h,{params:g,ignoreLoadingBar:!0})},g.getProfilesByRegionAndArea=function(b,d){var e=c+"/api/regions/"+b+"/areas/"+d+"/profiles";return a.get(e,{ignoreLoadingBar:!0})},g.getDomains=function(d,e,f,g,h){var i={name:g,hasDnsAlias:h,clouds:b.getCloudFiltersList()},j=c+"/api/regions/"+d+"/areas/"+e+"/profiles/"+f+"/domains";return a.get(j,{params:i})},g.getCertificates=function(d,e,f){var g={domain:f,clouds:b.getCloudFiltersList()},h=c+"/api/regions/"+d+"/areas/"+e+"/certificates";return a.get(h,{params:g})},g.getSSLProfiles=function(b,d,e){var f={certificate:e},g=c+"/api/regions/"+b+"/areas/"+d+"/ssl-profiles";return a.get(g,{params:f})},g.getHealthCheckByRegionAreaAndProfile=function(d,e){var f={clouds:b.getCloudFiltersList()},g=c+"/api/regions/"+d+"/areas/"+e+"/healthchecks";return a.get(g,{ignoreLoadingBar:!0,params:f})},g.getAreasByRegion=function(b){var d=c+"/api/regions/"+b+"/areas?view=availability-zones";return a.get(d,{ignoreLoadingBar:!0})},g.checkUrlValidity=function(b){var d=c+"/api/loadbalancers/available",e={};return a.get(d,{headers:e,ignoreLoadingBar:!0,params:{name:b}},{})},g.checkDomainExistence=function(b,d){var e=c+"/api/domains/available",f={};return a.get(e,{headers:f,ignoreLoadingBar:!0,params:{domain:b,hasDnsAlias:d}},{})},g.createLoadBalancer=function(b,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s){var t={url:b,serviceId:d,region:e,area:g,members:h,networkId:i,profileName:j,certificateName:k,sslProfile:l,portMembers:n,healthcheck:m,setUpDNSEnabled:o,monitoringEnabled:q,onCallSupervision:p};r&&(a.defaults.headers.post["ITCare-DebugMode"]="true"),s&&(a.defaults.headers.post["ITCare-DryRun"]="true");var u=c+"/api/loadbalancers/",v=a.post(u,t);return f.unset(a.defaults.headers.post,"ITCare-DebugMode"),f.unset(a.defaults.headers.post,"ITCare-DryRun"),v},g}angular.module("itcare.business").factory("LoadBalancerService",["$http","UserPreferencesService","BACKEND_ENDPOINT","$log","$timeout","lodash",a])}(),function(){"use strict";function a(a,b,c,d,e){var f={};return f.createTicket=function(b){var c={},e=d+"/api/tickets";return a.post(e,b,{headers:c})},f.getTicketById=function(b){var c=d+"/api/tickets/"+b,e={};return a.get(c,{headers:e},{})},f.getTickets=function(b,c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u={title:b,ticketNumbers:c,ticketTypes:f,teams:h,serviceTypes:g,statuses:i,creationPeriodStart:j,creationPeriodEnd:k,updatePeriodStart:l,updatePeriodEnd:m,serviceIds:n,resourceIds:o,raiseUser:p,sort:q,direction:r,page:s,size:t,clouds:e.getCloudFiltersList()},v=d+"/api/tickets";return a.get(v,{params:u})},f.suggest=function(b){var c={q:b,clouds:e.getCloudFiltersList()},f=d+"/api/tickets-suggestions";return a.get(f,{params:c,ignoreLoadingBar:!0,silentFailure:!0})},f.getTicketStatuses=function(){var b=d+"/api/ticket-statuses";return a.get(b,{})},f.getTicketTypes=function(){var b=d+"/api/ticket-types";return a.get(b,{})},f.getTicketsByResource=function(b,c,e){var f=d+"/api/tickets?start="+b+"&resource="+c+"&resourceType="+e;return a.get(f,{})},f.getTicketsByService=function(b,c){var e=d+"/api/tickets?serviceId="+b+"&statuses=IN_PROGRESS&ticketTypes="+c;return a.get(e,{})},f.getTicketsOverview=function(){var b={clouds:e.getCloudFiltersList()},c=d+"/api/tickets-overview";return a.get(c,{params:b,ignoreLoadingBar:!0,silentFailure:!0})},f.getSupportCatalog=function(b){var c=d+"/api/ticket-request-types";return a.get(c,{params:{type:b}})},f.getSupportCatalogItem=function(b){var c=d+"/api/ticket-request-types/"+b;return a.get(c,{params:{}})},f.createEvent=function(b,c){var e={type:c.type,details:c.details,createdAt:null,username:c.username},f=d+"/api/tickets/"+b+"/events";return a.post(f,e)},f.addAttachment=function(b,c){var e=d+"/api/tickets/"+b+"/attachments",f=new FormData;return f.append("file",c),a.post(e,f,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})},f.downloadAttachment=function(e,f){var g=d+"/api/tickets/"+e+"/attachments/"+f.id;a.get(g,{}).then(function(a){for(var d=a.data,e=atob(d.replace(/\s/g,"")),g=e.length,h=new ArrayBuffer(g),i=new Uint8Array(h),j=0;j<g;j++)i[j]=e.charCodeAt(j);var k=new c([i],{});b.saveAs(k,f.filename)})},f}angular.module("itcare.business").factory("TicketService",["$http","FileSaver","Blob","BACKEND_ENDPOINT","UserPreferencesService",a])}(),function(){"use strict";function a(a){var b={};return b.getEvents=function(){return a.get("/assets/agenda/agenda.json",{})},b}angular.module("itcare.business").factory("AgendaService",["$http",a])}(),function(){"use strict";function a(a,b,c){var d={};return d.getMessagesWithPagination=function(d,e,f,g,h,i,j){var k={services:d,clouds:b.getCloudFiltersList(),statuses:e,from:f,to:g,phoneNumber:h,page:i,size:j},l=c+"/api/messages";return a.get(l,{params:k})},d.getMessage=function(b){var d=c+"/api/messages?serviceId="+b;return a.get(d,{})},d.getVortextServices=function(){var b=c+"/api/services?subscriptions=vortext";return a.get(b,{})},d.getMessagStatuses=function(){var b=c+"/api/message-statuses";return a.get(b,{})},d.getVortextStatus=function(){var b=c+"/api/vortext-status";return a.get(b,{})},d.getVortextStats=function(){var d=c+"/api/messages-overview";return a.get(d,{silentFailure:!0,params:{clouds:b.getCloudFiltersList()}})},d.createSubscription=function(b){var d=c+"/api/subscription/vortext";return a.post(d,b)},d}angular.module("itcare.business").factory("MessagesService",["$http","UserPreferencesService","BACKEND_ENDPOINT",a])}(),function(){"use strict";function a(a,b,c,d){var e={};return e.getMonitoringItems=function(b,e,f,g,h,i,j,k,l,m){var n={serviceIds:b,resourceNames:e,statuses:g,environments:h,monitoringCheck:f,clouds:c.getCloudFiltersList(),page:i,size:l,sort:m};"true"!=j&&"false"!=j||(n.acknowledged=j),"it"!=k&&"client"!=k||(n.team=k);var o=d+"/api/monitoring-items";return a.get(o,{params:n})},e.getMonitoringStatuses=function(){var b=d+"/api/monitoring-statuses";return a.get(b,{})},e.acknowledgeCheck=function(b){var c=d+"/api/monitoring/acknowledgments";return a.post(c,b)},e.disAcknowledgeCheck=function(b){var c=d+"/api/monitoring/disacknowledgments";return a.post(c,b)},e.updateOperationTeams=function(b){var c=d+"/api/monitoring/operating-mode-changes";return a.post(c,b)},e.previewUpdateOperationTeams=function(b){var c=d+"/api/monitoring/operating-mode-changes-preview";return a.post(c,b)},e}angular.module("itcare.business").factory("MonitoringService",["$http","$log","UserPreferencesService","BACKEND_ENDPOINT",a])}(),function(){"use strict";function a(a,b){var c={};return c.getPlatforms=function(){var c=b+"/api/platforms-support-policy";return a.get(c,{})},c}angular.module("itcare.business").factory("PlatformsService",["$http","BACKEND_ENDPOINT",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h={};return h.state="initializing",h.message="Websocket initializing",h.socket=null,h.init=function(){h.socket||(g.info("new instance ws"),h.socket=f("ws://localhost:8080/myit-war/itcare/hello/topic/greetings/websocket"),h.socket.onOpen(function(){g.info("connected"),d.$apply(function(){h.state="connected",h.message="Websocket connected"})}),h.socket.onClose(function(){g.info("close"),d.$apply(function(){h.state="disconnected",h.message="Websocket disconnected"})}))},h}angular.module("itcare.business").factory("WebSocketService",["$http","BACKEND_ENDPOINT","$interval","$rootScope","UtilService","$websocket","$log",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){var k={};return k.defaultUser={isAuthenticated:!1,username:void 0,authorities:[],sessionSettings:{}},k.currentUser=k.defaultUser,k.authenticate=function(b,d,e){var f=c+"/login";return a.post(f,{username:b,password:d,remember_me:e},{withCredentials:!0})},k.getUser=function(){var b=c+"/api/me";return a.get(b,{},{withCredentials:!0})},k.getRoles=function(b){f.debug("Getting roles for: "+b);var d=c+"/api/getroles";return a.get(d,{},{withCredentials:!0})},k.logout=function(){return a.post(c+"/logout",{},{withCredentials:!0})},k.setCurrentUser=function(a){f.debug("Setting current user"),k.currentUser=h.merge(k.defaultUser,a),a.username&&g.set("&uid",a.username),j.set("currentUser",JSON.stringify(k.currentUser))},k.saveSessionSetting=function(a,b){k.currentUser.sessionSettings[a]=b,k.setCurrentUser(k.currentUser)},k.getCurrentUser=function(){if(!k.currentUser.isAuthenticated){var a=j.get("currentUser");null!==a&&k.setCurrentUser(angular.fromJson(a))}return k.currentUser},k.removeCurrentUser=function(){f.debug("Removing current user"),k.currentUser.isAuthenticated=!1,k.currentUser.username="",k.currentUser.authorities=[],k.currentUser.sessionSettings={},i.remove("ACEGI_SECURITY_HASHED_REMEMBER_ME_COOKIE"),g.set("&uid",""),j.set("currentUser",JSON.stringify(k.currentUser))},k}angular.module("itcare.business").factory("UserService",["$http","UserPreferencesService","BACKEND_ENDPOINT","$interval","$rootScope","$log","Analytics","UtilService","$cookies","localStorageService",a])}(),function(){"use strict";function a(a,b,c){function d(a){void 0!==l&&l(a)}function e(a){return parseInt(h(a).substring(0,2),16)}function f(a){return parseInt(h(a).substring(2,4),16)}function g(a){return parseInt(h(a).substring(4,6),16)}function h(a){return"#"==a.charAt(0)?a.substring(1,7):a}var i="ITCare - ",j="70px";b.pageTitle="ITCare",b.displayHeader=!0,b.bodyPaddingTop=j;var k={},l=void 0;return b.$on("FBFullscreen.change",function(b,c){a.debug("Fullscreen changed"),d(c)}),k.disableFooter=function(){b.displayFooter=!1},k.enableFooter=function(){b.displayFooter=!0},k.toggleFullScreen=function(a){return c.isEnabled()?(c.cancel(),a&&(k.enableHeader(),k.enableFooter())):(c.all(),a&&(k.disableHeader(),k.disableFooter())),c.isEnabled()},k.setFullScreenChangeListener=function(a){l=a},k.disableHeader=function(){b.displayHeader=!1,b.bodyPaddingTop="0px"},k.enableHeader=function(){b.displayHeader=!0,b.bodyPaddingTop=j},k.setTitle=function(a){b.pageTitle=i+a},k.colors={primary:"#2F4050",success:"#1AB394",info:"#51b9d1",warning:"#F8AC59",danger:"#ff3333","gray-lighter":"#ebebeb",darker:"#003c88",green:"#d3d829",red:"#e84242",black:"#000000",menu:"#00cbca"},k.getRgbColor=function(a,b){void 0===b&&(b=1);var a=k.colors[a];return"rgba("+e(a)+","+f(a)+","+g(a)+","+b+")"},k}angular.module("itcare.business").factory("UIService",["$log","$rootScope","Fullscreen",a])}(),function(){"use strict";function a(a){var b={};return b.get=function(b,c){var d=Array.prototype.slice.call(arguments);return d.shift(),a.translation[b]?c?String.prototype.format.apply(a.translation[b],d):a.translation[b]:b},b}angular.module("itcare.business").factory("TranslationService",["$rootScope",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){var b=a.get("preferences");return null===b?{}:b}function h(a){var b=angular.copy(a);return b&&b.forEach(function(a){void 0!==a.clouds&&a.clouds.forEach(function(a){void 0===a.selected&&(a.selected=!0)}),void 0===a.selected&&(a.selected=!0)}),b}function i(a,c){var d=angular.copy(c);return d.forEach(function(c){if(angular.isArray(c.clouds)){var d=b.filter(a,function(a){return a&&a.name===c.name});if(angular.isArray(d)&&1===d.length&&d[0].clouds){var e=d[0].clouds;c.clouds.forEach(function(a){var c=b.filter(e,function(b){return b&&b.name===a.name});angular.isArray(c)&&1===c.length?(c=c[0],a.selected=void 0===c.selected||c.selected):a.selected=!0}),c.selected=b.filter(c.clouds,function(a){return a.selected}).length===c.clouds.length}else c.selected=!1,c.clouds.forEach(function(a){a.selected=!1})}}),0===b.filter(b.flatMap(d,"clouds"),function(a){return a.selected}).length&&d.forEach(function(a){a.clouds.forEach(function(a){a.selected=!0})}),d}function j(b){a.set("preferences",b)}var k={},l=b,m=a.get("version");return m&&m.version&&m.version===f||(a.clearAll(".*",""),m={version:f},a.set("version",m),e.path("/login")),k.setPreference=function(a,b){var c=g();c[a]=b,j(c)},k.appendPreference=function(a,b,c,d){void 0===c&&(c=!1),void 0===d&&(d=10);var e=g();if(angular.isArray(e[a])||(e[a]=[]),!c){if(0==l.filter(e[a],function(a){return angular.toJson(a)==angular.toJson(b)}).length)e[a].unshift(b);else{var f=[];f.push(b);for(var h=0;h<e[a].length;h++)angular.toJson(b)!=angular.toJson(e[a][h])&&f.push(e[a][h]);e[a]=f}}return e[a]=e[a].slice(0,d),j(e),e[a]},k.getPreference=function(a){var b=g();return angular.isDefined(b[a])?b[a]:null},k.removePreference=function(a,b){var c=k.getPreference(a);angular.isDefined(c)&&(c=l.filter(c,function(a){return angular.toJson(a)!=angular.toJson(b)}),k.setPreference(a,c))},k.resetOrganizations=function(a){var b=h(a);return k.setPreference("organizations",b),b},k.getOrganizations=function(){var b=angular.fromJson(a.get("currentUser"));if(b&&b.organizations){var c=k.getPreference("organizations");return null==c||0==c.length?(c=h(b.organizations),k.setPreference("organizations",c)):(c=i(c,b.organizations),k.setPreference("organizations",c)),c}return k.setPreference("organizations",[]),[]},k.getCloudFiltersList=function(){var a=[],d=!1,e=k.getPreference("organizations");return void 0===e?(c.warning("User's organizations are not set - Clouds are not filtered"),a):(b.forEach(e,function(c){void 0!==c&&void 0!==c.clouds&&b.forEach(c.clouds,function(b){void 0!==c.selected&&void 0!==b&&void 0!==b.selected&&(b.selected&&void 0!==b.id?a.push(b.id):d=!0)})}),d?a.join(","):null)},k.computeCloudSummary=function(){var a=k.getOrganizations(),c=b.filter(a,function(a){return b.filter(a.clouds,function(a){return a.selected}).length===a.clouds.length}),d=b.flatMap(a,"clouds"),e=b.filter(d,function(a){return a.selected}),f=d.length,g=e.length,h=a.length,i=c.length,j="";return j=1===c.length?c[0].clouds.length!==e.length?1===e.length?e[0].name:e.length+"/"+d.length:c[0].name+" ("+c[0].clouds.length+")":e.length+"/"+d.length,{isFiltered:g<f||i<h,count:f,countSelected:g,orgaCount:h,orgaCountSelected:i,summary:j}},k}angular.module("itcare.business").factory("UserPreferencesService",["localStorageService","lodash","$log","$cookies","$location","USER_PREFERENCES_VERSION",a])}(),function(){"use strict";var a=angular.module("itcare.business");a.values={},a.values.version="1.0.0",a.values.userLanguage={},a.values.userLanguage.getFirstLanguageRange=function(a){if(void 0!==a){var b=a.split(","),c=b[0],d=c.split(";");return d?d[0]:c}},a.values.userLanguage.getLanguage=function(a){var b=/^([\w\*]*)(-(\w*))?.*$/i,c=a.trim().match(b);if(c){var d=/^([a-z]{2}|\*)$/i,e=c[1];if(e){var f=e.match(d);if(f)return f[0].toLowerCase()}}},a.value(a.values)}(),function(){"use strict";function a(a,b,c){var d={};return d.merge=function(a){return angular.forEach(arguments,function(b){b!==a&&angular.forEach(b,function(b,c){a[c]&&a[c].constructor&&a[c].constructor===Object?d.merge(a[c],b):a[c]=b})}),a},d.formatNumberedHour=function(a){var b=""+Math.floor(a),c="00",d=c.substring(0,c.length-b.length)+b,e=""+60*(a-Math.floor(a));return d+":"+(c.substring(0,c.length-e.length)+e)},d}angular.module("itcare.business").factory("UtilService",["translationProvider","$state","$log",a])}(),function(){"use strict";function a(a,b,c){var d={};return d.getVulnerabilitiesSummary=function(d,e){var f={clouds:b.getCloudFiltersList()};return(0|d)===d&&(f.serviceId=d),e&&e.length>0&&(f.searchFilter=e),a.get(c+"/api/security-reports/vulnerabilities-summary",{ignoreLoadingBar:!0,params:f})},d.getVulnerabilitiesSummaryByUrl=function(b){return a.get(c+"/api/security-reports/vulnerabilities-summary/"+b,{ignoreLoadingBar:!0})},d.getVulnerabilities=function(d,e,f,g,h){var i={};return(0|f)===f?i.serviceId=f:i.clouds=b.getCloudFiltersList(),(0|d)===d&&(i.page=d),(0|e)===e&&(i.size=e),i.withVulnerabilities=g,h&&h.length>0&&(i.searchFilter=h),a.get(c+"/api/security-reports/vulnerabilities",{params:i})},d.getVulnerabilityDetail=function(b){var d={view:"detail"};return a.get(c+"/api/security-reports/vulnerabilities/"+b,{params:d})},d}angular.module("itcare.business").factory("VulnerabilityService",["$http","UserPreferencesService","BACKEND_ENDPOINT",a])}(),function(){"use strict";angular.module("itcare.components",["angularMoment","ui.bootstrap"])}(),function(){"use strict";function a(a){var b={};return b.getUILocalStorage=function(b,c){return void 0===c&&(c={}),a.get(b)?angular.merge(c,a.get(b)):c},b.persistUILocalStorage=function(b,c){a.set(b,c)},b}angular.module("itcare.components").factory("ConfStateUiView",["localStorageService",a])}(),angular.module("itcare.components").directive("chartGauge",["$timeout",function(a){return{restrict:"EA",scope:{id:"@",class:"@",min:"=",max:"=",title:"@",label:"@",value:"@",options:"="},template:'<div id="{{id}}-justgage" class="{{class}}"></div>',link:function(b,c,d){a(function(){var a={id:b.id+"-justgage",min:b.min||0,max:b.max||100,title:b.title,label:b.label||"",value:b.value};if(b.options)for(var c in b.options)a[c]=b.options[c];var d=new JustGage(a);b.$watch("max",function(a){void 0!==a&&d.refresh(b.value,a)},!0),b.$watch("value",function(a){void 0!==a&&d.refresh(a)},!0)})}}}]),function(){"use strict";angular.module("itcare.components").directive("clipboard",["$document",function(a){return{restrict:"A",scope:{onCopied:"&",onError:"&",text:"="},link:function(b,c){function d(b){var c=a[0].createElement("textarea");return c.style.position="absolute",c.style.left="-10000px",c.textContent=b,c}function e(b){if(b.select(),!a[0].execCommand("copy"))throw"failure copy"}function f(b){var c=d(b);a[0].body.appendChild(c),e(c),a[0].body.removeChild(c)}c.on("click",function(a){try{f(b.text),angular.isFunction(b.onCopied)&&b.$evalAsync(b.onCopied())}catch(a){angular.isFunction(b.onError)&&b.$evalAsync(b.onError({err:a}))}})}}}])}(),function(){"use strict";function a(a,b){var c={};return c.promptCloudsInModal=function(b,c){return a.open({animation:!0,templateUrl:"/components/clouds-selector-modal.template.html",controller:"CloudsSelectorModalController",controllerAs:"csm",size:"lg",backdrop:"static",keyboard:!0,resolve:{translation:function(){return b},organizations:function(){return c}}}).result},c}function b(a,b,c,d){function e(){void 0!==b&&(r.organizations=angular.copy(b),s.$watch("csm.organizations",function(a){r.selectorValid=!1,angular.forEach(a,function(a){var b=0;angular.forEach(a.clouds,function(a){b+=a.selected?1:0,r.selectorValid=r.selectorValid||a.selected}),r.selectedCounts[a.name]=b})},!0),r.organizations.forEach(function(a){a.collapsed=!0,void 0===a.selected&&(a.selected=!0),a.clouds.forEach(function(a){void 0===a.selected&&(a.selected=!0)})}),f())}function f(){angular.forEach(r.organizations,function(a){for(var b=0,c=0;c<a.clouds.length;c++)a.clouds[c].selected&&b++;a.partiallySelected=b>0&&b<a.clouds.length})}function g(){d.close(r.organizations)}function h(){r.organizations.forEach(function(a){a.clouds.forEach(function(a){a.selected=!0}),a.selected=!0}),f()}function i(){r.organizations.forEach(function(a){a.clouds.forEach(function(a){a.selected=!1}),a.selected=!1}),f()}function j(){r.organizations.forEach(function(a){a.collapsed=!1})}function k(){r.organizations.forEach(function(a){a.collapsed=!0})}function l(){""!=r.q&&j()}function m(){d.dismiss("cancel")}function n(a){r.selectorValid=a}function o(){return JSON.stringify(r.organizations,null,2)}function p(a){a.selected=!a.selected,void 0!==a.clouds&&a.clouds.forEach(function(b){b.selected=a.selected}),f()}function q(a,b){if(b.selected=!b.selected,b.selected){var c=!0;a.countSelected=0,a.clouds.forEach(function(a){c=c&&a.selected}),a.selected=c}else a.selected=!1;f()}var r=this,s=c;r.translation=a,r.selectorValid=!0,r.selectedCounts=[],r.submit=g,r.cancel=m,r.selectAll=h,r.selectNone=i,r.expandAll=j,r.expandNone=k,r.filter=l,r.toggleOrganization=p,r.toggleCloud=q,r.toggleFormSubmit=n,r.prettyPrintContext=o,r.organizations=[],r.q="",e()}angular.module("itcare.components").factory("CloudsSelectorService",["$uibModal","UserService",a]),angular.module("itcare.components").controller("CloudsSelectorModalController",["translation","organizations","$scope","$uibModalInstance",b])}(),angular.module("itcare.components").component("cloudsSelector",{templateUrl:"components/clouds-selector.template.html",controller:["CiService","$log","lodash",CloudsSelectorController],controllerAs:"cs",bindings:{clouds:"<",translation:"<",onValidityChange:"&"}}),angular.module("itcare.components").component("cloudInfo",{templateUrl:"components/clouds-info.template.html",controller:["TranslationService","UserPreferencesService",CloudInfoController],controllerAs:"cloudInfo",bindings:{class:"="}}),function(){"use strict";angular.module("itcare.components").directive("cubeSpinner",["$interval",function(a){return{restrict:"E",scope:{step:"="},template:"<p ng-if=\"vm.includeTitle\"><span>loading...</span></p><i class='fa fa-fw fa-refresh fa-spin text-muted fa-2x'></i></span>",bindToController:{includeTitle:"=?"},controllerAs:"vm",controller:["$scope",function(a){var b=this;b.includeTitle=b.includeTitle||!1}]}}])}(),function(){"use strict";angular.module("itcare.components").directive("ngPluralizeHtml",["$locale","$interpolate","$log",function(a,b,c){var d=/{}/g,e=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(f,g,h){function i(a){g.html(a||"")}var j,k=h.count,l=h.$attr.when&&g.attr(h.$attr.when),m=h.offset||0,n=f.$eval(l)||{},o={},p=b.startSymbol(),q=b.endSymbol(),r=p+k+"-"+m+q,s=angular.noop;angular.forEach(h,function(a,b){var c=e.exec(b);if(c){var d=(c[1]?"-":"")+lowercase(c[2]);n[d]=g.attr(h.$attr[b])}}),angular.forEach(n,function(a,c){o[c]=b(a.replace(d,r))}),f.$watch(k,function(b){var d=parseFloat(b),e=isNaN(d);if(e||d in n||(d=a.pluralCat(d-m)),!(d===j||e&&isNaN(j))){s();var g=o[d];void 0===g?(c.debug("ngPluralize: no rule defined for '"+d+"' in "+l),s=angular.noop,i()):s=f.$watch(g,i),j=d}})}}}])}();var d3="function"==typeof require?require("d3"):window.d3,CalHeatMap=function(){"use strict";function a(){d.verticalDomainLabel="top"===d.options.label.position||"bottom"===d.options.label.position,d.domainVerticalLabelHeight=null===d.options.label.height?Math.max(25,2*d.options.cellSize):d.options.label.height,d.domainHorizontalLabelWidth=0,""===d.options.domainLabelFormat&&null===d.options.label.height&&(d.domainVerticalLabelHeight=0),d.verticalDomainLabel||(d.domainVerticalLabelHeight=0,d.domainHorizontalLabelWidth=d.options.label.width),d.paint(),!1!==d.options.nextSelector&&d3.select(d.options.nextSelector).on("click."+d.options.itemNamespace,function(){return d3.event.preventDefault(),d.loadNextDomain(1)}),!1!==d.options.previousSelector&&d3.select(d.options.previousSelector).on("click."+d.options.itemNamespace,function(){return d3.event.preventDefault(),d.loadPreviousDomain(1)}),d.Legend.redraw(d.graphDim.width-d.options.domainGutter-d.options.cellPadding),d.afterLoad();var a=d.getDomainKeys();d.options.loadOnInit?d.getDatas(d.options.data,new Date(a[0]),d.getSubDomain(a[a.length-1]).pop(),function(){d.fill(),d.onComplete()}):d.onComplete(),d.checkIfMinDomainIsReached(a[0]),d.checkIfMaxDomainIsReached(d.getNextDomain().getTime())}function b(a,b){var c=d.options.cellSize*d._domainType[d.options.subDomain].column(a)+d.options.cellPadding*d._domainType[d.options.subDomain].column(a);return 2===arguments.length&&!0===b?c+=d.domainHorizontalLabelWidth+d.options.domainGutter+d.options.domainMargin[1]+d.options.domainMargin[3]:c}function c(a,b){var c=d.options.cellSize*d._domainType[d.options.subDomain].row(a)+d.options.cellPadding*d._domainType[d.options.subDomain].row(a);return 2===arguments.length&&!0===b&&(c+=d.options.domainGutter+d.domainVerticalLabelHeight+d.options.domainMargin[0]+d.options.domainMargin[2]),c}var d=this;this.allowedDataType=["json","csv","tsv","txt"],this.options={itemSelector:"#cal-heatmap",paintOnLoad:!0,range:12,cellSize:10,cellPadding:2,cellRadius:0,domainGutter:2,domainMargin:[0,0,0,0],domain:"hour",subDomain:"min",colLimit:null,rowLimit:null,weekStartOnMonday:!0,start:new Date,minDate:null,maxDate:null,data:"",dataType:this.allowedDataType[0],dataPostPayload:null,considerMissingDataAsZero:!1,loadOnInit:!0,verticalOrientation:!1,domainDynamicDimension:!0,label:{position:"bottom",align:"center",offset:{x:0,y:0},rotate:null,width:100,height:null},legend:[10,20,30,40],displayLegend:!0,legendCellSize:10,legendCellPadding:2,legendMargin:[0,0,0,0],legendVerticalPosition:"bottom",legendHorizontalPosition:"left",legendOrientation:"horizontal",legendColors:null,highlight:[],itemName:["item","items"],domainLabelFormat:null,subDomainTitleFormat:{empty:"{date}",filled:"{count} {name} {connector} {date}"},subDomainDateFormat:null,subDomainTextFormat:null,legendTitleFormat:{lower:"less than {min} {name}",inner:"between {down} and {up} {name}",upper:"more than {max} {name}"},animationDuration:500,nextSelector:!1,previousSelector:!1,itemNamespace:"cal-heatmap",tooltip:!1,onClick:null,afterLoad:null,afterLoadNextDomain:null,afterLoadPreviousDomain:null,onComplete:null,afterLoadData:function(a){return a},onMaxDomainReached:null,onMinDomainReached:null,onTooltip:function(a){return a}},this._domainType={min:{name:"minute",level:10,maxItemNumber:60,defaultRowNumber:10,defaultColumnNumber:6,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){return Math.floor(a.getMinutes()/d._domainType.min.row(a))},y:function(a){return a.getMinutes()%d._domainType.min.row(a)}},format:{date:"%H:%M, %A %B %-e, %Y",legend:"",connector:"at"},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()).getTime()}},hour:{name:"hour",level:20,maxItemNumber:function(a){switch(d.options.domain){case"day":return 24;case"week":return 168;case"month":return 24*(d.options.domainDynamicDimension?d.getDayCountInMonth(a):31)}},defaultRowNumber:6,defaultColumnNumber:function(a){switch(d.options.domain){case"day":return 4;case"week":return 28;case"month":return d.options.domainDynamicDimension?d.getDayCountInMonth(a):31}},row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){return"month"===d.options.domain?d.options.colLimit>0||d.options.rowLimit>0?Math.floor((a.getHours()+24*(a.getDate()-1))/d._domainType.hour.row(a)):Math.floor(a.getHours()/d._domainType.hour.row(a))+4*(a.getDate()-1):"week"===d.options.domain?d.options.colLimit>0||d.options.rowLimit>0?Math.floor((a.getHours()+24*d.getWeekDay(a))/d._domainType.hour.row(a)):Math.floor(a.getHours()/d._domainType.hour.row(a))+4*d.getWeekDay(a):Math.floor(a.getHours()/d._domainType.hour.row(a))},y:function(a){var b=a.getHours();if(d.options.colLimit>0||d.options.rowLimit>0)switch(d.options.domain){case"month":b+=24*(a.getDate()-1);break;case"week":b+=24*d.getWeekDay(a)}return Math.floor(b%d._domainType.hour.row(a))}},format:{date:"%Hh, %A %B %-e, %Y",legend:"%H:00",connector:"at"},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()).getTime()}},day:{name:"day",level:30,maxItemNumber:function(a){switch(d.options.domain){case"week":return 7;case"month":return d.options.domainDynamicDimension?d.getDayCountInMonth(a):31;case"year":return d.options.domainDynamicDimension?d.getDayCountInYear(a):366}},defaultColumnNumber:function(a){switch(a=new Date(a),d.options.domain){case"week":return 1;case"month":return d.options.domainDynamicDimension&&!d.options.verticalOrientation?d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()+1,0))-d.getWeekNumber(a)+1:6;case"year":return d.options.domainDynamicDimension?d.getWeekNumber(new Date(a.getFullYear(),11,31))-d.getWeekNumber(new Date(a.getFullYear(),0))+1:54}},defaultRowNumber:7,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){switch(d.options.domain){case"week":return Math.floor(d.getWeekDay(a)/d._domainType.day.row(a));case"month":return d.options.colLimit>0||d.options.rowLimit>0?Math.floor((a.getDate()-1)/d._domainType.day.row(a)):d.getWeekNumber(a)-d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));case"year":return d.options.colLimit>0||d.options.rowLimit>0?Math.floor((d.getDayOfYear(a)-1)/d._domainType.day.row(a)):d.getWeekNumber(a)}},y:function(a){var b=d.getWeekDay(a);if(d.options.colLimit>0||d.options.rowLimit>0)switch(d.options.domain){case"year":b=d.getDayOfYear(a)-1;break;case"week":b=d.getWeekDay(a);break;case"month":b=a.getDate()-1}return Math.floor(b%d._domainType.day.row(a))}},format:{date:"%A %B %-e, %Y",legend:"%e %b",connector:"on"},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()}},week:{name:"week",level:40,maxItemNumber:54,defaultColumnNumber:function(a){switch(a=new Date(a),d.options.domain){case"year":return d._domainType.week.maxItemNumber;case"month":return d.options.domainDynamicDimension?d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()+1,0))-d.getWeekNumber(a):5}},defaultRowNumber:1,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){switch(d.options.domain){case"year":return Math.floor(d.getWeekNumber(a)/d._domainType.week.row(a));case"month":return Math.floor(d.getMonthWeekNumber(a)/d._domainType.week.row(a))}},y:function(a){return d.getWeekNumber(a)%d._domainType.week.row(a)}},format:{date:"%B Week #%W",legend:"%B Week #%W",connector:"in"},extractUnit:function(a){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=b.getDay()-1;return c<0&&(c=6),b.setDate(b.getDate()-c),b.getTime()}},month:{name:"month",level:50,maxItemNumber:12,defaultColumnNumber:12,defaultRowNumber:1,row:function(){return d.getSubDomainRowNumber()},column:function(){return d.getSubDomainColumnNumber()},position:{x:function(a){return Math.floor(a.getMonth()/d._domainType.month.row(a))},y:function(a){return a.getMonth()%d._domainType.month.row(a)}},format:{date:"%B %Y",legend:"%B",connector:"in"},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth()).getTime()}},year:{name:"year",level:60,row:function(){return d.options.rowLimit||1},column:function(){return d.options.colLimit||1},position:{x:function(){return 1},y:function(){return 1}},format:{date:"%Y",legend:"%Y",connector:"in"},extractUnit:function(a){return new Date(a.getFullYear()).getTime()}}};for(var e in this._domainType)if(this._domainType.hasOwnProperty(e)){var f=this._domainType[e];this._domainType["x_"+e]={name:"x_"+e,level:f.type,maxItemNumber:f.maxItemNumber,defaultRowNumber:f.defaultRowNumber,defaultColumnNumber:f.defaultColumnNumber,row:f.column,column:f.row,position:{x:f.position.y,y:f.position.x},format:f.format,extractUnit:f.extractUnit}}this.lastInsertedSvg=null,this._completed=!1,this._domains=d3.map(),this.graphDim={width:0,height:0},this.legendDim={width:0,height:0},this.NAVIGATE_LEFT=1,this.NAVIGATE_RIGHT=2,this.RESET_ALL_ON_UPDATE=0,this.RESET_SINGLE_ON_UPDATE=1,this.APPEND_ON_UPDATE=2,this.DEFAULT_LEGEND_MARGIN=10,this.root=null,this.tooltip=null,this._maxDomainReached=!1,this._minDomainReached=!1,this.domainPosition=new DomainPosition,this.Legend=null,this.legendScale=null,this.DSTDomain=[],this._init=function(){return d.getDomain(d.options.start).map(function(a){return a.getTime()}).map(function(a){d._domains.set(a,d.getSubDomain(a).map(function(a){return{t:d._domainType[d.options.subDomain].extractUnit(a),v:null}}))}),d.root=d3.select(d.options.itemSelector).append("svg").attr("class","cal-heatmap-container"),d.tooltip=d3.select(d.options.itemSelector).attr("style",function(){var a=d3.select(d.options.itemSelector).attr("style");return(null!==a?a:"")+"position:relative;"}).append("div").attr("class","ch-tooltip"),d.root.attr("x",0).attr("y",0).append("svg").attr("class","graph"),d.Legend=new Legend(d),d.options.paintOnLoad&&a(),!0},this.paint=function(a){function e(b,c,e,f){var g=0;switch(a){case!1:return g=c[e],c[e]+=f,d.domainPosition.setPosition(b,g),g;case d.NAVIGATE_RIGHT:return d.domainPosition.setPosition(b,c[e]),i=f,j=d.domainPosition.getPositionFromIndex(1),d.domainPosition.shiftRightBy(j),c[e];case d.NAVIGATE_LEFT:return g=-f,i=-g,j=c[e]-d.domainPosition.getLast(),d.domainPosition.setPosition(b,g),d.domainPosition.shiftLeftBy(i),g}}function f(a){switch(g.label.rotate){case"right":a.attr("transform",function(a){var c="rotate(90), ";switch(g.label.position){case"right":c+="translate(-"+b(a)+" , -"+b(a)+")";break;case"left":c+="translate(0, -"+d.domainHorizontalLabelWidth+")"}return c});break;case"left":a.attr("transform",function(a){var c="rotate(270), ";switch(g.label.position){case"right":c+="translate(-"+(b(a)+d.domainHorizontalLabelWidth)+" , "+b(a)+")";break;case"left":c+="translate(-"+d.domainHorizontalLabelWidth+" , "+d.domainHorizontalLabelWidth+")"}return c})}}var g=d.options;0===arguments.length&&(a=!1);var h=d.root.select(".graph").selectAll(".graph-domain").data(function(){var b=d.getDomainKeys();return a===d.NAVIGATE_LEFT?b.reverse():b},function(a){return a}),i=0,j=0,k=h.enter().append("svg").attr("width",function(a){return b(a,!0)}).attr("height",function(a){return c(a,!0)}).attr("x",function(a){return g.verticalOrientation?(d.graphDim.width=Math.max(d.graphDim.width,b(a,!0)),0):e(a,d.graphDim,"width",b(a,!0))}).attr("y",function(a){return g.verticalOrientation?e(a,d.graphDim,"height",c(a,!0)):(d.graphDim.height=Math.max(d.graphDim.height,c(a,!0)),0)}).attr("class",function(a){var b="graph-domain",c=new Date(a);switch(g.domain){case"hour":b+=" h_"+c.getHours();case"day":b+=" d_"+c.getDate()+" dy_"+c.getDay();case"week":b+=" w_"+d.getWeekNumber(c);case"month":b+=" m_"+(c.getMonth()+1);case"year":b+=" y_"+c.getFullYear()}return b});d.lastInsertedSvg=k,k.append("rect").attr("width",function(a){return b(a,!0)-g.domainGutter-g.cellPadding}).attr("height",function(a){return c(a,!0)-g.domainGutter-g.cellPadding}).attr("class","domain-background");var l=k.append("svg").attr("x",function(){return"left"===g.label.position?d.domainHorizontalLabelWidth+g.domainMargin[3]:g.domainMargin[3]}).attr("y",function(){return"top"===g.label.position?d.domainVerticalLabelHeight+g.domainMargin[0]:g.domainMargin[0]}).attr("class","graph-subdomain-group"),m=l.selectAll("g").data(function(a){return d._domains.get(a)}).enter().append("g");m.append("rect").attr("class",function(a){return"graph-rect"+d.getHighlightClassName(a.t)+(null!==g.onClick?" hover_cursor":"")}).attr("width",g.cellSize).attr("height",g.cellSize).attr("x",function(a){return d.positionSubDomainX(a.t)}).attr("y",function(a){return d.positionSubDomainY(a.t)}).on("click",function(a){if(null!==g.onClick)return d.onClick(new Date(a.t),a.v)}).call(function(a){g.cellRadius>0&&a.attr("rx",g.cellRadius).attr("ry",g.cellRadius),null!==d.legendScale&&null!==g.legendColors&&g.legendColors.hasOwnProperty("base")&&a.attr("fill",g.legendColors.base),g.tooltip&&(a.on("mouseover",function(a){var b=this.parentNode.parentNode,c=function(c){d.tooltip.html(c).attr("style","display: block;");var e=d.positionSubDomainX(a.t)-d.tooltip[0][0].offsetWidth/2+g.cellSize/2,f=d.positionSubDomainY(a.t)-d.tooltip[0][0].offsetHeight-g.cellSize/2;e+=parseInt(b.getAttribute("x"),10),f+=parseInt(b.getAttribute("y"),10),e+=parseInt(d.root.select(".graph").attr("x"),10),f+=parseInt(d.root.select(".graph").attr("y"),10),e+=parseInt(b.parentNode.getAttribute("x"),10),f+=parseInt(b.parentNode.getAttribute("y"),10),d.tooltip.attr("style","display: block; left: "+e+"px; top: "+f+"px;")};c(d.options.onTooltip(new Date(a.t),a.v))}),a.on("mouseout",function(){d.tooltip.attr("style","display:none").html("")}))}),g.tooltip||m.append("title").text(function(a){return d.formatDate(new Date(a.t),g.subDomainDateFormat)}),""!==g.domainLabelFormat&&k.append("text").attr("class","graph-label").attr("y",function(a){var b=g.domainMargin[0];switch(g.label.position){case"top":b+=d.domainVerticalLabelHeight/2;break;case"bottom":b+=c(a)+d.domainVerticalLabelHeight/2}return b+g.label.offset.y*("right"===g.label.rotate&&"right"===g.label.position||"left"===g.label.rotate&&"left"===g.label.position?-1:1)}).attr("x",function(a){var c=g.domainMargin[3];switch(g.label.position){case"right":c+=b(a);break;case"bottom":case"top":c+=b(a)/2}return"right"===g.label.align?c+d.domainHorizontalLabelWidth-g.label.offset.x*("right"===g.label.rotate?-1:1):c+g.label.offset.x}).attr("text-anchor",function(){switch(g.label.align){case"start":case"left":return"start";case"end":case"right":return"end";default:return"middle"}}).attr("dominant-baseline",function(){return d.verticalDomainLabel?"middle":"top"}).text(function(a){return d.formatDate(new Date(a),g.domainLabelFormat)}).call(f),null!==g.subDomainTextFormat&&m.append("text").attr("class",function(a){return"subdomain-text"+d.getHighlightClassName(a.t)}).attr("x",function(a){return d.positionSubDomainX(a.t)+g.cellSize/2}).attr("y",function(a){return d.positionSubDomainY(a.t)+g.cellSize/2}).attr("text-anchor","middle").attr("dominant-baseline","central").text(function(a){return d.formatDate(new Date(a.t),g.subDomainTextFormat)}),!1!==a&&h.transition().duration(g.animationDuration).attr("x",function(a){return g.verticalOrientation?0:d.domainPosition.getPosition(a)}).attr("y",function(a){return g.verticalOrientation?d.domainPosition.getPosition(a):0});var n=d.graphDim.width,o=d.graphDim.height;g.verticalOrientation?d.graphDim.height+=i-j:d.graphDim.width+=i-j,h.exit().transition().duration(g.animationDuration).attr("x",function(c){if(g.verticalOrientation)return 0;switch(a){case d.NAVIGATE_LEFT:return Math.min(d.graphDim.width,n);case d.NAVIGATE_RIGHT:return-b(c,!0)}}).attr("y",function(b){if(!g.verticalOrientation)return 0;switch(a){case d.NAVIGATE_LEFT:return Math.min(d.graphDim.height,o);case d.NAVIGATE_RIGHT:return-c(b,!0)}}).remove(),d.resize()}};CalHeatMap.prototype={init:function(a,b){"use strict";function c(a,b,c){if((b&&!1===a||a instanceof Element||"string"==typeof a)&&""!==a)return!0;throw new Error("The "+c+" is not valid")}function d(a){switch(a){case"year":return"month";case"month":case"week":return"day";case"day":return"hour";default:return"min"}}function e(){if(!l._domainType.hasOwnProperty(m.domain)||"min"===m.domain||"x_"===m.domain.substring(0,2))throw new Error("The domain '"+m.domain+"' is not valid");if(!l._domainType.hasOwnProperty(m.subDomain)||"year"===m.subDomain)throw new Error("The subDomain '"+m.subDomain+"' is not valid");if(l._domainType[m.domain].level<=l._domainType[m.subDomain].level)throw new Error("'"+m.subDomain+"' is not a valid subDomain to '"+m.domain+"'");return!0}function f(){if(!a.hasOwnProperty("label")||a.hasOwnProperty("label")&&!a.label.hasOwnProperty("align")){switch(m.label.position){case"left":m.label.align="right";break;case"right":m.label.align="left";break;default:m.label.align="center"}"left"===m.label.rotate?m.label.align="right":"right"===m.label.rotate&&(m.label.align="left")}(!a.hasOwnProperty("label")||a.hasOwnProperty("label")&&!a.label.hasOwnProperty("offset"))&&("left"!==m.label.position&&"right"!==m.label.position||(m.label.offset={x:10,y:15}))}function g(){switch(m.legendVerticalPosition){case"top":m.legendMargin[2]=l.DEFAULT_LEGEND_MARGIN;break;case"bottom":m.legendMargin[0]=l.DEFAULT_LEGEND_MARGIN;break;case"middle":case"center":m.legendMargin["right"===m.legendHorizontalPosition?3:1]=l.DEFAULT_LEGEND_MARGIN}}function h(a){switch("number"==typeof a&&(a=[a]),Array.isArray(a)||(console.log("Margin only takes an integer or an array of integers"),a=[0]),a.length){case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];case 4:return a;default:return a.slice(0,4)}}function i(a){return"string"==typeof a?[a,a+(""!==a?"s":"")]:Array.isArray(a)?1===a.length?[a[0],a[0]+"s"]:a.length>2?a.slice(0,2):a:["item","items"]}function j(a){return a>0?a:null}function k(a){return a>0&&m.colLimit>0?(console.log("colLimit and rowLimit are mutually exclusive, rowLimit will be ignored"),null):a>0?a:null}var l=this,m=l.options=mergeRecursive(l.options,a);if(e(),c(m.itemSelector,!1,"itemSelector"),-1===l.allowedDataType.indexOf(m.dataType))throw new Error("The data type '"+m.dataType+"' is not valid data type");if(null===d3.select(m.itemSelector)[0][0])throw new Error("The node '"+m.itemSelector+"' specified in itemSelector does not exists");try{c(m.nextSelector,!0,"nextSelector"),c(m.previousSelector,!0,"previousSelector")}catch(a){return console.log(a.message),!1}a.hasOwnProperty("subDomain")||(this.options.subDomain=d(a.domain)),"string"==typeof m.itemNamespace&&""!==m.itemNamespace||(console.log("itemNamespace can not be empty, falling back to cal-heatmap"),m.itemNamespace="cal-heatmap");var n=["data","onComplete","onClick","afterLoad","afterLoadData","afterLoadPreviousDomain","afterLoadNextDomain","onTooltip"];for(var o in n)a.hasOwnProperty(n[o])&&(m[n[o]]=a[n[o]]);return m.subDomainDateFormat="string"==typeof m.subDomainDateFormat||"function"==typeof m.subDomainDateFormat?m.subDomainDateFormat:this._domainType[m.subDomain].format.date,m.domainLabelFormat="string"==typeof m.domainLabelFormat||"function"==typeof m.domainLabelFormat?m.domainLabelFormat:this._domainType[m.domain].format.legend,m.subDomainTextFormat="string"==typeof m.subDomainTextFormat&&""!==m.subDomainTextFormat||"function"==typeof m.subDomainTextFormat?m.subDomainTextFormat:null,m.domainMargin=h(m.domainMargin),m.legendMargin=h(m.legendMargin),m.highlight=l.expandDateSetting(m.highlight),m.itemName=i(m.itemName),m.colLimit=j(m.colLimit),m.rowLimit=k(m.rowLimit),a.hasOwnProperty("legendMargin")||g(),f(),void 0!==b&&b(),this._init()},expandDateSetting:function(a){"use strict";return Array.isArray(a)||(a=[a]),a.map(function(a){return"now"===a?new Date:a instanceof Date&&a}).filter(function(a){return!1!==a})},fill:function(a){"use strict";function b(a){if(null===d.legendScale)return!1;a.attr("fill",function(a){return null===a.v&&e.hasOwnProperty("considerMissingDataAsZero")&&!e.considerMissingDataAsZero&&e.legendColors.hasOwnProperty("base")?e.legendColors.base:null!==e.legendColors&&e.legendColors.hasOwnProperty("empty")&&(0===a.v||null===a.v&&e.hasOwnProperty("considerMissingDataAsZero")&&e.considerMissingDataAsZero)?e.legendColors.empty:a.v<0&&e.legend[0]>0&&null!==e.legendColors&&e.legendColors.hasOwnProperty("overflow")?e.legendColors.overflow:d.legendScale(Math.min(a.v,e.legend[e.legend.length-1]))})}function c(a){"function"==typeof e.subDomainTextFormat&&a.text(function(a){return e.subDomainTextFormat(a.t,a.v)})}var d=this,e=d.options;0===arguments.length&&(a=d.root.selectAll(".graph-domain"));var f=a.selectAll("svg").selectAll("g").data(function(a){return d._domains.get(a)});f.transition().duration(e.animationDuration).select("rect").attr("class",function(a){var b=d.getHighlightClassName(a.t).trim().split(" "),c=d.dateIsLessThan(a.t,new Date);return(null===d.legendScale||null===a.v&&e.hasOwnProperty("considerMissingDataAsZero")&&!e.considerMissingDataAsZero&&!e.legendColors.hasOwnProperty("base"))&&b.push("graph-rect"),c||-1!==b.indexOf("now")||b.push("future"),null!==a.v?b.push(d.Legend.getClass(a.v,null===d.legendScale)):e.considerMissingDataAsZero&&c&&b.push(d.Legend.getClass(0,null===d.legendScale)),null!==e.onClick&&b.push("hover_cursor"),b.join(" ")}).call(b),f.transition().duration(e.animationDuration).select("title").text(function(a){return d.getSubDomainTitle(a)}),f.transition().duration(e.animationDuration).select("text").attr("class",function(a){return"subdomain-text"+d.getHighlightClassName(a.t)}).call(c)},triggerEvent:function(a,b,c){"use strict";return!!(3===arguments.length&&c||null===this.options[a])||("function"==typeof this.options[a]?("function"==typeof b&&(b=b()),this.options[a].apply(this,b)):(console.log("Provided callback for "+a+" is not a function."),!1))},onClick:function(a,b){"use strict";return this.triggerEvent("onClick",[a,b])},afterLoad:function(){"use strict";return this.triggerEvent("afterLoad")},onComplete:function(){"use strict";var a=this.triggerEvent("onComplete",[],this._completed);return this._completed=!0,a},afterLoadPreviousDomain:function(a){"use strict";var b=this;return this.triggerEvent("afterLoadPreviousDomain",function(){var c=b.getSubDomain(a);return[c.shift(),c.pop()]})},afterLoadNextDomain:function(a){"use strict";var b=this;return this.triggerEvent("afterLoadNextDomain",function(){var c=b.getSubDomain(a);return[c.shift(),c.pop()]})},onMinDomainReached:function(a){"use strict";return this._minDomainReached=a,this.triggerEvent("onMinDomainReached",[a])},onMaxDomainReached:function(a){"use strict";return this._maxDomainReached=a,this.triggerEvent("onMaxDomainReached",[a])},checkIfMinDomainIsReached:function(a,b){"use strict";this.minDomainIsReached(a)&&this.onMinDomainReached(!0),2===arguments.length&&this._maxDomainReached&&!this.maxDomainIsReached(b)&&this.onMaxDomainReached(!1)},checkIfMaxDomainIsReached:function(a,b){"use strict";this.maxDomainIsReached(a)&&this.onMaxDomainReached(!0),2===arguments.length&&this._minDomainReached&&!this.minDomainIsReached(b)&&this.onMinDomainReached(!1)},formatNumber:d3.format(",g"),formatDate:function(a,b){"use strict";return arguments.length<2&&(b="title"),"function"==typeof b?b(a):d3.time.format(b)(a)},getSubDomainTitle:function(a){"use strict";if(null!==a.v||this.options.considerMissingDataAsZero){var b=a.v;return null===b&&this.options.considerMissingDataAsZero&&(b=0),this.options.subDomainTitleFormat.filled.format({count:this.formatNumber(b),name:this.options.itemName[1!==b?1:0],connector:this._domainType[this.options.subDomain].format.connector,date:this.formatDate(new Date(a.t),this.options.subDomainDateFormat)})}return this.options.subDomainTitleFormat.empty.format({date:this.formatDate(new Date(a.t),this.options.subDomainDateFormat)})},loadNextDomain:function(a){"use strict";if(this._maxDomainReached||0===a)return!1;var b=this.loadNewDomains(this.NAVIGATE_RIGHT,this.getDomain(this.getNextDomain(),a));return this.afterLoadNextDomain(b.end),this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(),b.start),!0},loadPreviousDomain:function(a){"use strict";if(this._minDomainReached||0===a)return!1;var b=this.loadNewDomains(this.NAVIGATE_LEFT,this.getDomain(this.getDomainKeys()[0],-a).reverse());return this.afterLoadPreviousDomain(b.start),this.checkIfMinDomainIsReached(b.start,b.end),!0},loadNewDomains:function(a,b){"use strict";function c(a){return{t:d._domainType[d.options.subDomain].extractUnit(a),v:null}}for(var d=this,e=a===this.NAVIGATE_LEFT,f=-1,g=b.length,h=this.getDomainKeys();++f<g;){if(e&&this.minDomainIsReached(b[f])){b=b.slice(0,f+1);break}if(!e&&this.maxDomainIsReached(b[f])){b=b.slice(0,f);break}}for(b=b.slice(-this.options.range),f=0,g=b.length;f<g;f++)this._domains.set(b[f].getTime(),this.getSubDomain(b[f]).map(c)),this._domains.remove(e?h.pop():h.shift());return h=this.getDomainKeys(),e&&(b=b.reverse()),this.paint(a),this.getDatas(this.options.data,b[0],this.getSubDomain(b[b.length-1]).pop(),function(){d.fill(d.lastInsertedSvg)}),{start:b[e?0:1],end:h[h.length-1]}},maxDomainIsReached:function(a){"use strict";return null!==this.options.maxDate&&this.options.maxDate.getTime()<a},minDomainIsReached:function(a){"use strict";return null!==this.options.minDate&&this.options.minDate.getTime()>=a},getDomainKeys:function(){"use strict";return this._domains.keys().map(function(a){return parseInt(a,10)}).sort(function(a,b){return a-b})},positionSubDomainX:function(a){"use strict";var b=this._domainType[this.options.subDomain].position.x(new Date(a));return b*this.options.cellSize+b*this.options.cellPadding},positionSubDomainY:function(a){"use strict";var b=this._domainType[this.options.subDomain].position.y(new Date(a));return b*this.options.cellSize+b*this.options.cellPadding},getSubDomainColumnNumber:function(a){"use strict";if(this.options.rowLimit>0){var b=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof b&&(b=b(a)),Math.ceil(b/this.options.rowLimit)}var c=this._domainType[this.options.subDomain].defaultColumnNumber;return"function"==typeof c&&(c=c(a)),this.options.colLimit||c},getSubDomainRowNumber:function(a){"use strict";if(this.options.colLimit>0){var b=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof b&&(b=b(a)),Math.ceil(b/this.options.colLimit)}var c=this._domainType[this.options.subDomain].defaultRowNumber;return"function"==typeof c&&(c=c(a)),this.options.rowLimit||c},getHighlightClassName:function(a){"use strict";if(a=new Date(a),this.options.highlight.length>0)for(var b in this.options.highlight)if(this.options.highlight[b]instanceof Date&&this.dateIsEqual(this.options.highlight[b],a))return" highlight"+(this.isNow(this.options.highlight[b])?" now":"");return""},isNow:function(a){"use strict";return this.dateIsEqual(a,new Date)},dateIsEqual:function(a,b){"use strict";switch(this.options.subDomain){case"x_min":case"min":return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()&&a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes();case"x_hour":case"hour":return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()&&a.getHours()===b.getHours();case"x_day":case"day":return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate();case"x_week":case"week":return a.getFullYear()===b.getFullYear()&&this.getWeekNumber(a)===this.getWeekNumber(b);case"x_month":case"month":return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth();default:return!1}},dateIsLessThan:function(a,b){"use strict";function c(a,b){switch(b){case"x_min":case"min":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()).getTime();case"x_hour":case"hour":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()).getTime();case"x_day":case"day":return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime();case"x_week":case"week":case"x_month":case"month":return new Date(a.getFullYear(),a.getMonth()).getTime();default:return a.getTime()}}return a instanceof Date||(a=new Date(a)),b instanceof Date||(b=new Date(b)),c(a,this.options.subDomain)<c(b,this.options.subDomain)},getDayOfYear:d3.time.format("%j"),getWeekNumber:function(a){"use strict";return(!0===this.options.weekStartOnMonday?d3.time.format("%W"):d3.time.format("%U"))(a)},getMonthWeekNumber:function(a){"use strict";"number"==typeof a&&(a=new Date(a));var b=this.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));return this.getWeekNumber(a)-b-1},getWeekNumberInYear:function(a){"use strict";"number"==typeof a&&(a=new Date(a))},getDayCountInMonth:function(a){"use strict";return this.getEndOfMonth(a).getDate()},getDayCountInYear:function(a){"use strict";return"number"==typeof a&&(a=new Date(a)),1===new Date(a.getFullYear(),1,29).getMonth()?366:365},getWeekDay:function(a){"use strict";return!1===this.options.weekStartOnMonday?a.getDay():0===a.getDay()?6:a.getDay()-1},getEndOfMonth:function(a){"use strict";return"number"==typeof a&&(a=new Date(a)),new Date(a.getFullYear(),a.getMonth()+1,0)},jumpDate:function(a,b,c){"use strict";var d=new Date(a);switch(c){case"hour":d.setHours(d.getHours()+b);break;case"day":d.setHours(d.getHours()+24*b);break;case"week":d.setHours(d.getHours()+24*b*7);break;case"month":d.setMonth(d.getMonth()+b);break;case"year":d.setFullYear(d.getFullYear()+b)}return new Date(d)},getMinuteDomain:function(a,b){"use strict";var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()),d=null;return d=b instanceof Date?new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()):new Date(+c+1e3*b*60),d3.time.minutes(Math.min(c,d),Math.max(c,d))},getHourDomain:function(a,b){"use strict";var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()),d=null;b instanceof Date?d=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()):(d=new Date(c),d.setHours(d.getHours()+b));var e=d3.time.hours(Math.min(c,d),Math.max(c,d)),f=0,g=e.length;for(f=0;f<g;f++)if(f>0&&e[f].getHours()===e[f-1].getHours()){this.DSTDomain.push(e[f].getTime()),e.splice(f,1);break}return"number"==typeof b&&e.length>Math.abs(b)&&e.splice(e.length-1,1),e},getDayDomain:function(a,b){"use strict";var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),d=null;return b instanceof Date?d=new Date(b.getFullYear(),b.getMonth(),b.getDate()):(d=new Date(c),d=new Date(d.setDate(d.getDate()+parseInt(b,10)))),d3.time.days(Math.min(c,d),Math.max(c,d))},getWeekDomain:function(a,b){"use strict";var c;!1===this.options.weekStartOnMonday?c=new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()):1===a.getDay()?c=new Date(a.getFullYear(),a.getMonth(),a.getDate()):0===a.getDay()?(c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c.setDate(c.getDate()-6)):c=new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()+1);var d=new Date(c),e=b;return"object"!=typeof b&&(e=new Date(d.setDate(d.getDate()+7*b))),!0===this.options.weekStartOnMonday?d3.time.mondays(Math.min(c,e),Math.max(c,e)):d3.time.sundays(Math.min(c,e),Math.max(c,e))},getMonthDomain:function(a,b){"use strict";var c=new Date(a.getFullYear(),a.getMonth()),d=null;return b instanceof Date?d=new Date(b.getFullYear(),b.getMonth()):(d=new Date(c),d=d.setMonth(d.getMonth()+b)),d3.time.months(Math.min(c,d),Math.max(c,d))},getYearDomain:function(a,b){"use strict";var c=new Date(a.getFullYear(),0),d=null;return d=b instanceof Date?new Date(b.getFullYear(),0):new Date(a.getFullYear()+b,0),d3.time.years(Math.min(c,d),Math.max(c,d))},getDomain:function(a,b){"use strict";switch("number"==typeof a&&(a=new Date(a)),arguments.length<2&&(b=this.options.range),this.options.domain){case"hour":var c=this.getHourDomain(a,b);return"number"==typeof b&&c.length<b&&(b>0?c.push(this.getHourDomain(c[c.length-1],2)[1]):c.shift(this.getHourDomain(c[0],-2)[0])),c;case"day":return this.getDayDomain(a,b);case"week":return this.getWeekDomain(a,b);case"month":return this.getMonthDomain(a,b);case"year":return this.getYearDomain(a,b)}},getSubDomain:function(a){"use strict";"number"==typeof a&&(a=new Date(a));var b=this,c=function(a,c){switch(c){case"year":return b.getDayCountInYear(a);case"month":return b.getDayCountInMonth(a);case"week":return 7}},d=function(a,b){switch(b){case"hour":return 60;case"day":return 1440;case"week":return 10080}},e=function(a,c){switch(c){case"day":return 24;case"week":return 168;case"month":return 24*b.getDayCountInMonth(a)}},f=function(a,c){if("month"===c){var d=new Date(a.getFullYear(),a.getMonth()+1,0),e=b.getWeekNumber(d),f=b.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));return f>e&&(f=0,e++),e-f+1}if("year"===c)return b.getWeekNumber(new Date(a.getFullYear(),11,31))};switch(this.options.subDomain){case"x_min":case"min":return this.getMinuteDomain(a,d(a,this.options.domain));case"x_hour":case"hour":return this.getHourDomain(a,e(a,this.options.domain));case"x_day":case"day":return this.getDayDomain(a,c(a,this.options.domain));case"x_week":case"week":return this.getWeekDomain(a,f(a,this.options.domain));case"x_month":case"month":return this.getMonthDomain(a,12)}},getNextDomain:function(a){"use strict";return 0===arguments.length&&(a=1),this.getDomain(this.jumpDate(this.getDomainKeys().pop(),a,this.options.domain),1)[0]},getPreviousDomain:function(a){"use strict";return 0===arguments.length&&(a=1),this.getDomain(this.jumpDate(this.getDomainKeys().shift(),-a,this.options.domain),1)[0]},getDatas:function(a,b,c,d,e,f){"use strict";var g=this;arguments.length<5&&(e=!0),arguments.length<6&&(f=this.APPEND_ON_UPDATE);var h=function(a){!1!==e?"function"==typeof e?a=e(a):"function"==typeof g.options.afterLoadData?a=g.options.afterLoadData(a):console.log("Provided callback for afterLoadData is not a function."):"csv"!==g.options.dataType&&"tsv"!==g.options.dataType||(a=this.interpretCSV(a)),g.parseDatas(a,f,b,c),"function"==typeof d&&d()};switch(typeof a){case"string":if(""===a)return h({}),!0;var i=this.parseURI(a,b,c),j="GET";null!==g.options.dataPostPayload&&(j="POST");var k=null;switch(null!==g.options.dataPostPayload&&(k=this.parseURI(g.options.dataPostPayload,b,c)),this.options.dataType){case"json":d3.json(i,h).send(j,k);break;case"csv":d3.csv(i,h).send(j,k);break;case"tsv":d3.tsv(i,h).send(j,k);break;case"txt":d3.text(i,"text/plain",h).send(j,k)}return!1;case"object":if(a===Object(a))return h(a),!1;default:return h({}),!0}},parseDatas:function(a,b,c,d){"use strict";b===this.RESET_ALL_ON_UPDATE&&this._domains.forEach(function(a,b){b.forEach(function(a,b,c){c[b].v=null})});var e={},f=function(a){return a.t};for(var g in a){var h=new Date(1e3*g),i=this.getDomain(h)[0].getTime();if(this.DSTDomain.indexOf(i)>=0&&this._domains.has(i-36e5)&&(i-=36e5),!isNaN(g)&&a.hasOwnProperty(g)&&this._domains.has(i)&&i>=+c&&i<+d){var j=this._domains.get(i);e.hasOwnProperty(i)||(e[i]=j.map(f));var k=e[i].indexOf(this._domainType[this.options.subDomain].extractUnit(h));b===this.RESET_SINGLE_ON_UPDATE?j[k].v=a[g]:isNaN(j[k].v)?j[k].v=a[g]:j[k].v+=a[g]}}},parseURI:function(a,b,c){"use strict";return a=a.replace(/\{\{t:start\}\}/g,b.getTime()/1e3),a=a.replace(/\{\{t:end\}\}/g,c.getTime()/1e3),a=a.replace(/\{\{d:start\}\}/g,b.toISOString()),a=a.replace(/\{\{d:end\}\}/g,c.toISOString())},interpretCSV:function(a){"use strict";var b,c,d={},e=Object.keys(a[0]);for(b=0,c=a.length;b<c;b++)d[a[b][e[0]]]=+a[b][e[1]];return d},resize:function(){"use strict";var a=this,b=a.options,c=b.displayLegend?a.Legend.getDim("width")+b.legendMargin[1]+b.legendMargin[3]:0,d=b.displayLegend?a.Legend.getDim("height")+b.legendMargin[0]+b.legendMargin[2]:0,e=a.graphDim.width-b.domainGutter-b.cellPadding,f=a.graphDim.height-b.domainGutter-b.cellPadding;this.root.transition().duration(b.animationDuration).attr("width",function(){return"middle"===b.legendVerticalPosition||"center"===b.legendVerticalPosition?e+c:Math.max(e,c)}).attr("height",function(){return"middle"===b.legendVerticalPosition||"center"===b.legendVerticalPosition?Math.max(f,d):f+d}),this.root.select(".graph").transition().duration(b.animationDuration).attr("y",function(){return"top"===b.legendVerticalPosition?d:0}).attr("x",function(){return"middle"!==b.legendVerticalPosition&&"center"!==b.legendVerticalPosition||"left"!==b.legendHorizontalPosition?0:c})},next:function(a){"use strict";return 0===arguments.length&&(a=1),this.loadNextDomain(a)},previous:function(a){"use strict";return 0===arguments.length&&(a=1),this.loadPreviousDomain(a)},jumpTo:function(a,b){"use strict";arguments.length<2&&(b=!1);var c=this.getDomainKeys(),d=c[0],e=c[c.length-1];return a<d?this.loadPreviousDomain(this.getDomain(d,a).length):b?this.loadNextDomain(this.getDomain(d,a).length):a>e&&this.loadNextDomain(this.getDomain(e,a).length)},rewind:function(){"use strict";this.jumpTo(this.options.start,!0)},updateQuota:function(a,b,c){"use strict";arguments.length<2&&(b=!0),arguments.length<3&&(c=this.RESET_ALL_ON_UPDATE);var d=this.getDomainKeys(),e=this;this.getDatas(a,new Date(d[0]),this.getSubDomain(d[d.length-1]).pop(),function(){e.fill()},b,c)},setLegend:function(){"use strict";var a=this.options.legend.slice(0);arguments.length>=1&&Array.isArray(arguments[0])&&(this.options.legend=arguments[0]),arguments.length>=2&&(Array.isArray(arguments[1])&&arguments[1].length>=2?this.options.legendColors=[arguments[1][0],arguments[1][1]]:this.options.legendColors=arguments[1]),(arguments.length>0&&!arrayEquals(a,this.options.legend)||arguments.length>=2)&&(this.Legend.buildColors(),this.fill()),this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding)},removeLegend:function(){"use strict";return!!this.options.displayLegend&&(this.options.displayLegend=!1,this.Legend.remove(),!0)},showLegend:function(){"use strict";return!this.options.displayLegend&&(this.options.displayLegend=!0,this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding),!0)},highlight:function(a){"use strict";return(this.options.highlight=this.expandDateSetting(a)).length>0&&(this.fill(),!0)},destroy:function(a){"use strict";return this.root.transition().duration(this.options.animationDuration).attr("width",0).attr("height",0).remove().each("end",function(){"function"==typeof a?a():void 0!==a&&console.log("Provided callback for destroy() is not a function.")}),null},getSVG:function(){"use strict";for(var a={".cal-heatmap-container":{},".graph":{},".graph-rect":{},"rect.highlight":{},"rect.now":{},"text.highlight":{},"text.now":{},".domain-background":{},".graph-label":{},".subdomain-text":{},".q0":{},".qi":{}},b=1,c=this.options.legend.length+1;b<=c;b++)a[".q"+b]={};var d=this.root,e=["stroke","stroke-width","stroke-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-miterlimit","fill","fill-opacity","fill-rule","marker","marker-start","marker-mid","marker-end","alignement-baseline","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","shape-rendering","text-transform","font-family","font","font-size","font-weight"],f=function(b,c,d){-1!==e.indexOf(c)&&(a[b][c]=d)},g=function(a){return d.select(a)[0][0]};for(var h in a)if(a.hasOwnProperty(h)){var i=g(h);if(null!==i)if("getComputedStyle"in window){var j=getComputedStyle(i,null);if(0!==j.length)for(var k=0;k<j.length;k++)f(h,j.item(k),j.getPropertyValue(j.item(k)));else for(var l in j)j.hasOwnProperty(l)&&f(h,l,j[l])}else if("currentStyle"in i){var m=i.currentStyle;for(var n in m)f(h,n,m[n])}}var o='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css"><![CDATA[ ';for(var p in a){o+=p+" {\n";for(var q in a[p])o+="\t"+q+":"+a[p][q]+";\n";o+="}\n"}return o+="]]></style>",o+=(new XMLSerializer).serializeToString(this.root[0][0]),o+="</svg>"}};var DomainPosition=function(){"use strict";this.positions=d3.map()};DomainPosition.prototype.getPosition=function(a){"use strict";return this.positions.get(a)},DomainPosition.prototype.getPositionFromIndex=function(a){"use strict";var b=this.getKeys();return this.positions.get(b[a])},DomainPosition.prototype.getLast=function(){"use strict";var a=this.getKeys();return this.positions.get(a[a.length-1])},DomainPosition.prototype.setPosition=function(a,b){"use strict";this.positions.set(a,b)},DomainPosition.prototype.shiftRightBy=function(a){"use strict";this.positions.forEach(function(b,c){this.set(b,c-a)});var b=this.getKeys();this.positions.remove(b[0])},DomainPosition.prototype.shiftLeftBy=function(a){"use strict";this.positions.forEach(function(b,c){this.set(b,c+a)});var b=this.getKeys();this.positions.remove(b[b.length-1])},DomainPosition.prototype.getKeys=function(){"use strict";return this.positions.keys().sort(function(a,b){return parseInt(a,10)-parseInt(b,10)})};var Legend=function(a){"use strict";this.calendar=a,this.computeDim(),null!==a.options.legendColors&&this.buildColors()};Legend.prototype.computeDim=function(){"use strict";var a=this.calendar.options;this.dim={width:a.legendCellSize*(a.legend.length+1)+a.legendCellPadding*a.legend.length,height:a.legendCellSize}},Legend.prototype.remove=function(){"use strict";this.calendar.root.select(".graph-legend").remove(),this.calendar.resize()},Legend.prototype.redraw=function(a){"use strict";function b(a){a.attr("width",i.legendCellSize).attr("height",i.legendCellSize).attr("x",function(a,b){return b*(i.legendCellSize+i.legendCellPadding)})}function c(){switch(i.legendHorizontalPosition){case"right":return"center"===i.legendVerticalPosition||"middle"===i.legendVerticalPosition?a+i.legendMargin[3]:a-f.getDim("width")-i.legendMargin[1];case"middle":case"center":return Math.round(a/2-f.getDim("width")/2);default:return i.legendMargin[3]}}function d(){return"bottom"===i.legendVerticalPosition?g.graphDim.height+i.legendMargin[0]-i.domainGutter-i.cellPadding:i.legendMargin[0]}if(!this.calendar.options.displayLegend)return!1;var e,f=this,g=this.calendar,h=g.root,i=g.options;this.computeDim();var j=i.legend.slice(0);j.push(j[j.length-1]+1);var k=g.root.select(".graph-legend");null!==k[0][0]?(h=k,e=h.select("g").selectAll("rect").data(j)):(h="top"===i.legendVerticalPosition?h.insert("svg",".graph"):h.append("svg"),h.attr("x",c()).attr("y",d()),e=h.attr("class","graph-legend").attr("height",f.getDim("height")).attr("width",f.getDim("width")).append("g").selectAll().data(j)),e.enter().append("rect").call(b).attr("class",function(a){return g.Legend.getClass(a,null===g.legendScale)}).attr("fill-opacity",0).call(function(a){null!==g.legendScale&&null!==i.legendColors&&i.legendColors.hasOwnProperty("base")&&a.attr("fill",i.legendColors.base)}).append("title"),e.exit().transition().duration(i.animationDuration).attr("fill-opacity",0).remove(),e.transition().delay(function(a,b){return i.animationDuration*b/10}).call(b).attr("fill-opacity",1).call(function(a){a.attr("fill",function(a,b){return null===g.legendScale?"":0===b?g.legendScale(a-1):g.legendScale(i.legend[b-1])}),a.attr("class",function(a){return g.Legend.getClass(a,null===g.legendScale)})}),e.select("title").text(function(a,b){return 0===b?i.legendTitleFormat.lower.format({min:i.legend[b],name:i.itemName[1]}):b===j.length-1?i.legendTitleFormat.upper.format({max:i.legend[b-1],name:i.itemName[1]}):i.legendTitleFormat.inner.format({down:i.legend[b-1],up:i.legend[b],name:i.itemName[1]})}),h.transition().duration(i.animationDuration).attr("x",c()).attr("y",d()).attr("width",f.getDim("width")).attr("height",f.getDim("height")),h.select("g").transition().duration(i.animationDuration).attr("transform",function(){return"vertical"===i.legendOrientation?"rotate(90 "+i.legendCellSize/2+" "+i.legendCellSize/2+")":""}),g.resize()},Legend.prototype.getDim=function(a){"use strict";var b="horizontal"===this.calendar.options.legendOrientation;switch(a){case"width":return this.dim[b?"width":"height"];case"height":return this.dim[b?"height":"width"]}},Legend.prototype.buildColors=function(){"use strict";var a=this.calendar.options;if(null===a.legendColors)return this.calendar.legendScale=null,!1;var b=[];if(Array.isArray(a.legendColors))b=a.legendColors;else{if(!a.legendColors.hasOwnProperty("min")||!a.legendColors.hasOwnProperty("max"))return a.legendColors=null,!1;b=[a.legendColors.min,a.legendColors.max]}var c=a.legend.slice(0);c[0]>0?c.unshift(0):c[0]<0&&c.unshift(c[0]-(c[c.length-1]-c[0])/c.length);var d=d3.scale.linear().range(b).interpolate(d3.interpolateHcl).domain([d3.min(c),d3.max(c)]),e=c.map(function(a){return d(a)});return this.calendar.legendScale=d3.scale.threshold().domain(a.legend).range(e),!0},Legend.prototype.getClass=function(a,b){"use strict";if(null===a||isNaN(a))return"";for(var c=[this.calendar.options.legend.length+1],d=0,e=this.calendar.options.legend.length-1;d<=e;d++){if(this.calendar.options.legend[0]>0&&a<0){c=["1","i"];break}if(a<=this.calendar.options.legend[d]){c=[d+1];break}}return 0===a&&c.push(0),c.unshift(""),(c.join(" r")+(b?c.join(" q"):"")).trim()},String.prototype.format=function(){"use strict";var a=this;for(var b in arguments[0])if(arguments[0].hasOwnProperty(b)){var c=new RegExp("\\{"+b+"\\}","gi");a=a.replace(c,arguments[0][b])}return a},"function"==typeof define&&define.amd?define(["d3"],function(){"use strict";return CalHeatMap}):"object"==typeof module&&module.exports?module.exports=CalHeatMap:window.CalHeatMap=CalHeatMap,function(){"use strict";angular.module("itcare.components").controller("LiveAvailabilityStatusCtrl",["$scope","$log","UIService",function(a,b,c,d){function e(){f.colors=c.colors}var f=this;e()}]).directive("liveAvailabilityStatus",function(){return{restrict:"E",templateUrl:"components/live-availability-status.template.html",bindToController:{liveAvailability:"=",translation:"="},controllerAs:"vm",controller:"LiveAvailabilityStatusCtrl"}})}(),function(){"use strict";angular.module("itcare.components").controller("MaintenancesTimelineCtrl",["$scope","$log","TranslationService",function(a,b,c){function d(){angular.forEach(f.maintenances,function(a){if(a.createdBy){var b=a.createdBy.indexOf("\\");if(b>-1)a.createdBy=a.createdBy.substring(b+1);else{var b=a.createdBy.indexOf("/");b>-1&&(a.createdBy=a.createdBy.substring(b+1))}}a.createdAtText=moment(a.createdAt).format("LLL"),a.startAtText=moment(a.startAt).format("LLL"),a.startAtTimeAgo=moment(a.startAt).fromNow(),a.endAtText=moment(a.endAt).format("LLL"),a.inProgress=moment().isBefore(moment(a.endAt))&&moment().isAfter(moment(a.startAt)),a.durationText=moment.duration(moment(a.endAt).diff(moment(a.startAt))).humanize()})}function e(c){b.debug("selected maintenance id : "+c),f.maintenanceId=c,a.removeMaintenance({id:c})}var f=this;f.remove=e,f.maintenanceId=void 0,f.activate=d,f.activate()}]).directive("maintenanceTimeline",function(){return{restrict:"E",scope:{removeMaintenance:"&onRemove",maintenances:"=",availableAction:"="},templateUrl:"components/maintenances-timeline.template.html",bindToController:{translation:"=",maintenances:"=",availableAction:"="},controllerAs:"vm",controller:"MaintenancesTimelineCtrl",link:function(a,b,c){a.$watch("maintenances",function(){a.vm.activate()},!0)}}})}(),function(){"use strict";angular.module("itcare.components").controller("MonitoringStatusHistoryCtrl",["$uibModalInstance","history","check",function(a,b,c){function d(){f.history=b,f.check=c}function e(){a.dismiss("cancel")}var f=this;f.cancel=e,d()}]).factory("MonitoringStatusHistoryService",["CiService","$uibModal",function(a,b){var c={};return c.openModal=function(c,d,e){if("instance"==c)var f=a.getInstanceMonitoringStatusHistory(d,e);else if("loadbalancer"==c)var f=a.getLoadBalancerMonitoringStatusHistory(d,e);else var f=a.getHardwareMonitoringStatusHistory(d,e);f.then(function(a){b.open({animation:!0,templateUrl:"components/monitoring-status-history-modal.template.html",controller:"MonitoringStatusHistoryCtrl",controllerAs:"sh",size:"lg",backdrop:"static",keyboard:!0,resolve:{history:function(){return a.data},check:function(){return e}}})})},c}])}(),angular.module("itcare.components").component("obsolescenceMap",{templateUrl:"components/obsolescence-map.template.html",controller:["UIService",ObsolescenceMapController],controllerAs:"obsMap",bindings:{platforms:"<"}}),function(){"use strict";angular.module("itcare.components").controller("ObsolescenceMetricsCtrl",["$scope","$log","$filter","$q","$state","UIService","TranslationService","CiService",function(a,b,c,d,e,f,g,h){function i(){m.obsoChart={},m.obsoPlatformChart={},m.phasesConfiguration={STANDARD:{theme:"success",order:1},END_OF_SALES:{theme:"warning",order:2},EXTENDED:{theme:"danger",order:3},END_OF_SUPPORT:{theme:"black",order:4},UNKNOWN:{theme:"gray-lighter",order:5}},m.colors=f.colors,j(),m.isService=void 0!==m.serviceId,void 0===m.metrics?l(0):k(m.metrics,[])}function j(){m.obsolescenceMonthPreview=0,m.obsolescenceSliderOptions={hideLimitLabels:!0,step:3,showTicks:!1,floor:0,ceil:36,vertical:!1,translate:function(a,b,c){return"<small>"+(0==a?g.get("NOW"):g.get("IN_N_MONTHS").format([a]))+"</small>"}},a.$on("slideEnded",function(a){l(m.obsolescenceMonthPreview)})}function k(a,b){m.obsoChart.options={chart:{type:"pieChart",donut:!1,x:function(a){return a.key},y:function(a){return a.y},showLabels:!1,duration:500,title:c("number")(a.score,2),showLegend:!1,valueFormat:function(a){return d3.format(",.0f")(a)},margin:{top:0,left:0,right:0,bottom:0},legend:{padding:18,margin:{top:5,bottom:5,left:0},tickFormat:function(a){return d3.format(",f")(a)}}}},m.obsoChart.data=[],angular.forEach(["STANDARD","END_OF_SALES","EXTENDED","END_OF_SUPPORT","UNKNOWN"],function(b){angular.isDefined(a.phasesDistribution[b])&&m.obsoChart.data.push({key:g.get("SUPPORT_PHASE."+b),y:a.phasesDistribution[b],color:f.colors[m.phasesConfiguration[b].theme]})});var d=[];angular.forEach(a.phasesDistribution,function(a,b){d.push({phase:b,count:a,order:m.phasesConfiguration[b].order})}),m.obsolescence={phases:d,score:a.score}}function l(a){var c=moment();c.add(a,"months");var e=c.format("YYYY-MM-DD[T]HH:mm:ss.SSSZ"),f={};m.isService?f.overall=h.getInstancesObsolescenceForService(m.serviceId,e):f.overall=h.getInstancesObsolescence(e),d.all(f).then(function(a){b.debug(a),m.firstPlatformLoading=!1,k(a.overall.data,[])})}var m=this;m.refreshObsolescence=l,i()}]).directive("obsolescenceMetrics",function(){return{restrict:"E",scope:{},templateUrl:"components/obsolescence-metrics.template.html",bindToController:{serviceId:"=?",metrics:"=?",showPlatforms:"=?",translation:"="},controllerAs:"vm",controller:"ObsolescenceMetricsCtrl"}})}(),function(){"use strict";function a(a,b,c,d,e){function f(){i.savedSearches=e.getPreference("recent-search"),g(i.savedSearches),b(function(){j||(j=!0,i.savedSearches=e.getPreference("recent-search"),g(i.savedSearches),j=!1,i.refreshCnt++)},1e4)}function g(a){i.isLoading=!0;var b=[];if(a)for(var e=0;e<a.length;e++){var f={self:a[e],searchParameters:{name:"",types:"",statuses:"",environments:"",tags:""},isOldSearch:!angular.isObject(a[e]),searchDisplay:{label:"All resources",icons:[]}};if(f.isOldSearch)f.searchParameters={name:a[e].search,type:"",status:"",environment:"",tags:""};else if(f.searchParameters={name:""+a[e].searchName,type:""+a[e].searchTypeSelected.join(","),status:""+a[e].searchStatusSelected.join(","),environment:""+a[e].searchEnvironmentSelected.join(","),tags:c.map(a[e].searchTagsSelected,function(a){return a&&a.tagKey&&a.tagValue?a.tagKey+":"+a.tagValue:""})},a[e]){if(a[e].searchStatusSelected&&a[e].searchStatusSelected.length>0){var g=c.map(a[e].searchStatusSelected,function(a){return d.get("ITCARE_SEARCHRESOURCES_STATUS_"+angular.uppercase(a))}).join(", ");f.searchDisplay.label=g,f.searchDisplay.icons.push({name:"fa-play",label:d.get("ITCARE_SEARCHRESOURCES_FIELD_STATUS"),value:g})}if(a[e].searchEnvironmentSelected&&a[e].searchEnvironmentSelected.length>0){var h=c.map(a[e].searchEnvironmentSelected,function(a){return d.get("ITCARE_ENVIRONMENT_"+angular.uppercase(a))}).join(", ");f.searchDisplay.label=h,f.searchDisplay.icons.push({name:"fa-mixcloud",label:d.get("ITCARE_SEARCHRESOURCES_FIELD_ENVIRONMENT"),value:h})}if(a[e].searchTypeSelected&&a[e].searchTypeSelected.length>0){var j=c.map(a[e].searchTypeSelected,function(a){return d.get("ITCARE_TYPE_"+angular.uppercase(a))}).join(", ");f.searchDisplay.label=j,f.searchDisplay.icons.push({name:"fa-cubes",label:d.get("ITCARE_SEARCHRESOURCES_FIELD_TYPE"),value:j})}if(a[e].searchTagsSelected&&a[e].searchTagsSelected.length>0){var k=c.map(a[e].searchTagsSelected,function(a){return a.tagKey+":"+a.tagValue}).join(", ");k=k?k.length>50?k.substr(0,50)+"...":k:"",f.searchDisplay.label=k,f.searchDisplay.icons.push({name:"fa-tags",label:d.get("ITCARE_SEARCHRESOURCES_FIELD_TAGS"),value:k})}if(a[e].searchName){var l=a[e].searchName;f.searchDisplay.label=l,f.searchDisplay.icons.push({name:"fa-font",label:d.get("ITCARE_SEARCHRESOURCES_FIELD_NAME"),value:l})}}f.searchDisplay.icons&&(f.searchDisplay.mainIcon=f.searchDisplay.icons[f.searchDisplay.icons.length-1],f.searchDisplay.icons.pop()),b.push(f)}i.lastSearches=angular.copy(b),i.isLoading=!1}function h(a){e.removePreference("recent-search",a),i.savedSearches=e.getPreference("recent-search"),g(i.savedSearches)}var i=this;i.refreshCnt=0,i.translation=a.translation,i.lastSearches=[],i.savedSearches=[],i.title=d.get("LAST_SERVICES_SEARCHES"),i.noRecentSearch=d.get("SEARCH");var g=g;i.removeSearch=h;var j=!1;f()}angular.module("itcare.components").component("recentSearch",{templateUrl:"components/recent-search.template.html",controller:["$rootScope","$interval","lodash","translationProvider","UserPreferencesService",a],controllerAs:"vm",bindings:{}})}(),function(){"use strict";angular.module("itcare.components").controller("SnapshotsTimelineCtrl",["$timeout","$scope","$log","TranslationService","REFRESH_INTERVAL",function(a,b,c,d,e){function f(){g()}function g(){if(angular.isArray(h.snapshots)&&h.snapshots.length>0){var a=moment(),b=moment(h.snapshots[0].expiresAt);h.isExpired=a>b}}var h=this;h.isExpired=!1,h.showWarningSnapshot=g,f()}]).directive("snapshotTimeline",function(){return{restrict:"E",templateUrl:"components/snapshots-timeline.template.html",bindToController:{snapshots:"="},controllerAs:"snapCtrl",controller:"SnapshotsTimelineCtrl"}})}(),angular.module("itcare.components").component("tagsSelector",{templateUrl:"components/tags-selector.template.html",controller:["CiService","$log","lodash",TagsSelectorController],controllerAs:"ts",bindings:{tags:"<",translation:"<",type:"<",forUpdate:"<",onValidityChange:"&"}}),function(){"use strict";function a(a){var b={};return b.promptTagsInModal=function(b,c,d,e){return a.open({animation:!0,templateUrl:"/components/tags-selector-modal.template.html",controller:"TagsSelectorModalController",controllerAs:"tsm",size:"lg",backdrop:"static",keyboard:!0,resolve:{translation:function(){return b},tags:function(){return void 0!==c?c:[]},forUpdate:function(){return e},type:function(){return d}}}).result},b}function b(a,b,c,d,e){function f(){void 0!=b&&(j.tags=angular.copy(b))}function g(){e.close(j.tags)}function h(){e.dismiss("cancel")}function i(a){j.selectorValid=a}var j=this;j.translation=a,j.forUpdate=d,j.type=c,j.tags=[],j.selectorValid=!0,j.submit=g,j.cancel=h,j.toggleFormSubmit=i,f()}angular.module("itcare.components").factory("TagsSelectorService",["$uibModal",a]),angular.module("itcare.components").controller("TagsSelectorModalController",["translation","tags","type","forUpdate","$uibModalInstance",b])}(),angular.module("itcare.components").component("objectStoresUsers",{templateUrl:"components/object-stores-users.template.html",controller:["$scope","ObjectStoresService","$log","lodash","$uibModal",ObjectStoresUsersController],controllerAs:"ouc",bindings:{cos:"<",translation:"<"}}),function(){"use strict";angular.module("itcare.components").controller("ActionsTimelineCtrl",["$uibModal","$rootScope","$scope","$log","TranslationService",function(a,b,c,d,e){function f(){}function g(){a.open({animation:!0,templateUrl:"components/actions-timeline-modal.template.html",controller:"ActionsHistoryCtrl",controllerAs:"history",size:"lg",backdrop:"static",keyboard:!0,resolve:{actionsFunction:function(){return h.callActionsFunction},actionsId:function(){return h.callActionsId}}})}var h=this;h.openModal=g,f()}]).controller("ActionsHistoryCtrl",["$uibModalInstance","$uibModal","$log","$scope","actionsFunction","actionsId",function(a,b,c,d,e,f){function g(){i.config={itemsPerPage:8,fillLastPage:!1},i.actionsSortType="submittedAt",i.actionsSortReverse="true",i.currentPage=1,i.maxSize=8,e(f).then(function(a){angular.isDefined(a)&&200===a.status&&(i.isLoading=!1,i.actions=a.data)},function(a){c.error("Failed to loading instance : "+a)})}function h(){a.dismiss("cancel")}var i=this;i.cancel=h,i.config={itemsPerPage:8,fillLastPage:!1},i.isLoading=!0,i.actions=[],i.actionsSortType="submittedAt",i.actionsSortReverse="true",i.currentPage=1,i.maxSize=8,g()}]).directive("actionsTimeline",function(){return{restrict:"A",templateUrl:"components/actions-timeline.template.html",bindToController:{callActionsFunction:"=",callActionsId:"="},controllerAs:"actions",controller:"ActionsTimelineCtrl"}})}(),angular.module("itcare.components").component("vulnerabilitiesActivity",{templateUrl:"components/vulnerabilities-activities.template.html",controller:["$scope","$filter","lodash","$log","TranslationService","$uibModal",VulnerabilityActivityController],controllerAs:"vActivity",bindings:{summary:"=",goToDetail:"&",translation:"<"}}),angular.module("itcare.components").component("vulnerabilitiesBrowser",{templateUrl:"components/vulnerabilities-browser.template.html",controller:["$rootScope","toaster","$uibModal","$timeout","$scope","$stateParams","$filter","lodash","$log","VulnerabilityService","UserService","TranslationService","TagsSelectorService","VulnerabilitiesReportService",VulnerabilityBrowserController],controllerAs:"vBrowser",bindings:{mode:"=",page:"<",size:"<",total:"<",service:"=",activeSearch:"=",activeSummary:"=",translation:"<"}}).directive("infiniteScrollTable",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(a,b,c,d){return{scope:{infiniteScrollTable:"&",infiniteScrollTableContainer:"=",infiniteScrollTableDistance:"=",infiniteScrollTableDisabled:"=",infiniteScrollTableUseDocumentBottom:"=",infiniteScrollTableListenForEvent:"@"},link:function(e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return y=angular.element(b),t=null,u=null,i=null,j=null,q=!0,x=!1,w=null,p=function(a){return a=a[0]||a,isNaN(a.offsetHeight)?a.document.documentElement.clientHeight:a.offsetHeight},r=function(a){if(a[0].getBoundingClientRect&&!a.css("none"))return a[0].getBoundingClientRect().top+s(a)},s=function(a){return a=a[0]||a,isNaN(window.pageYOffset)?a.document.documentElement.scrollTop:a.ownerDocument.defaultView.pageYOffset},o=function(){var b,c,d,g,h;return j===y?(b=p(j)+s(j[0].document.documentElement),d=r(f)+p(f)):(b=p(j),c=0,void 0!==r(j)&&(c=r(j)),d=r(f)-c+p(f)),x&&(d=p((f[0].ownerDocument||f[0].document).documentElement)),g=d-b,h=g<=p(j)*t+1,h?(i=!0,u?e.$$phase||a.$$phase?e.infiniteScrollTable():e.$apply(e.infiniteScrollTable):void 0):i=!1},v=function(a,b){var d,e,f;return f=null,e=0,d=function(){return e=(new Date).getTime(),c.cancel(f),f=null,a.call(),null},function(){var g,h;return g=(new Date).getTime(),h=b-(g-e),h<=0?(clearTimeout(f),c.cancel(f),f=null,e=g,a.call()):f?void 0:f=c(d,h,1)}},null!=d&&(o=v(o,d)),e.$on("$destroy",function(){if(j.unbind("scroll",o),null!=w)return w(),w=null}),m=function(a){return t=parseFloat(a)||0},e.$watch("infiniteScrollTableDistance",m),m(e.infiniteScrollTableDistance),l=function(a){if((u=!a)&&i)return i=!1,o()},e.$watch("infiniteScrollTableDisabled",l),l(e.infiniteScrollTableDisabled),n=function(a){return x=a},e.$watch("infiniteScrollTableUseDocumentBottom",n),n(e.infiniteScrollTableUseDocumentBottom),h=function(a){if(null!=j&&j.unbind("scroll",o),j=a,null!=a)return j.bind("scroll",o)},h(y),e.infiniteScrollTableListenForEvent&&(w=a.$on(e.infiniteScrollTableListenForEvent,o)),k=function(a){if(null!=a&&0!==a.length){if(a instanceof HTMLElement?a=angular.element(a):"function"==typeof a.append?a=angular.element(a[a.length-1]):"string"==typeof a&&(a=angular.element(document.querySelector(a))),null!=a)return h(a);throw new Exception("invalid infinite-scroll-container attribute.")}},e.$watch("infiniteScrollTableContainer",k),k(e.infiniteScrollTableContainer||[]),null!=g.infiniteScrollTableParent&&h(angular.element(f.parent())),null!=g.infiniteScrollTableImmediateCheck&&(q=e.$eval(g.infiniteScrollTableImmediateCheck)),c(function(){if(q)return o()},0,1)}}}]),function(){"use strict";angular.module("itcare.components").controller("VulnerabilitiesReportCtrl",["$uibModalInstance","VulnerabilityService","url",function(a,b,c){function d(){b.getVulnerabilityDetail(c).then(function(a){f.object=a.data,f.loading=!1})}function e(){a.close()}var f=this;f.loading=!0,f.object=void 0,f.close=e,d()}]).factory("VulnerabilitiesReportService",["CiService","$uibModal",function(a,b){var c={};return c.openReport=function(a){b.open({animation:!0,templateUrl:"components/vulnerabilities-report-modal.template.html",backdrop:"static",keyboard:!0,size:"lg",controller:"VulnerabilitiesReportCtrl",controllerAs:"rView",resolve:{url:[function(){return a}]}})},c}])}(),function(){"use strict";angular.module("itcare.components").directive("showErrors",["$timeout",function(a){return{restrict:"A",require:"^form",link:function(b,c,d,e){var f=c[0].querySelector("[name]"),g=angular.element(f),h=g.attr("name"),i=!1;g.bind("blur",function(){i=!0,c.toggleClass("has-error",e[h].$invalid),c.toggleClass("has-feedback",!0)}),b.$watch(function(){return e[h].$invalid},function(a){!i&&a||c.toggleClass("has-error",a)}),b.$on("show-errors-check-validity",function(){c.toggleClass("has-error",e[h].$invalid)}),b.$on("show-errors-reset",function(){a(function(){c.removeClass("has-error"),c.removeClass("has-feedback")},0,!1)})}}}])}(),angular.module("itcare.components").component("graphic",{templateUrl:"components/graphic.template.html",controller:["$timeout","$log","ChartService","TranslationService",GraphicController],controllerAs:"graphicCtrl",bindings:{config:"<",datas:"<",translation:"<"}}),angular.module("itcare.components").component("graphicBrowserView",{templateUrl:"components/graphic-browser-view.template.html",controller:["$timeout","lodash","$scope","$stateParams","$filter","lodash","$log","CiService","TranslationService","ChartService",GraphicBrowserViewController],controllerAs:"graphicBrowserCtrl",bindings:{resources:"<",configuration:"<",options:"<",translation:"<"}}).filter("math",["lodash",function(a){return function(b,c){var d=[];d=a.map(b,function(a){return a[1]});var e=d3.min(d);return"min"==c?e=d3.min(d):"max"==c?e=d3.max(d):"mean"==c&&(e=d3.mean(d)),d3.format(".03f")(e)}}]),angular.module("itcare.components").component("graphicPortalView",{templateUrl:"components/graphic-portal-view.template.html",controller:["$filter","lodash","$log","CiService","TranslationService","ChartService",GraphicShortViewController],controllerAs:"graphicCtrl",bindings:{resources:"<",configuration:"<",view:"<",dates:"<",translation:"<",displayOnInit:"<",goToInstance:"&",goToLoadBalancer:"&",goToHardware:"&"}}).filter("configLimitTo",[function(){return function(a,b){if(a){var c=Object.keys(a);if(c.length<1)return[];var d=new Object,e=0;return angular.forEach(c,function(c,f){if(e>=b)return!1;a[c].length>0&&(d[c]=a[c],e++)}),d}}}]),angular.module("itcare.components").component("graphicPeriodPicker",{templateUrl:"components/graphic-period-picker.template.html",controller:["$scope","$filter","$timeout","lodash","$log","$http","UIService","CiService","TranslationService",GraphicPeriodPickerController],controllerAs:"graphicPeriodPickerCtrl",bindings:{dates:"=",translation:"<"}}),function(){"use strict";angular.module("itcare.components").controller("VortextMessageRangesCtrl",["$scope","$filter","$log","$timeout","TranslationService","toaster","errorProvider","lodash","$window","$q",function(a,b,c,d,e,f,g,h,i,j){function k(){var b={start:null,end:null},d=angular.extend(b,s.options);c.debug("Options passed :"),c.debug(s.options),c.debug("Options merged :"),c.debug(d),s.maxDate=moment().add(1,"days").startOf("day"),s.nextRangeAllowed=!1,c.debug(s.datesModel),void 0===s.datesModel&&(c.debug("default date model"),s.datesModel={startDate:moment((new Date).getTime()-864e5),endDate:moment(new Date)}),s.currentRange=s.datesModel.endDate.unix()-s.datesModel.startDate.unix(),s.executeOnChange=function(){c.debug("Firing on change"),a.change({start:s.datesModel.startDate.unix(),end:s.datesModel.endDate.unix()})},c.debug("[Directive] $scope.fromRange : "+a.fromRange),s.ranges=[],s.ranges.push({period:"PERIOD_TODAY",start:moment().startOf("day"),end:moment().endOf("day")}),s.ranges.push({period:"PERIOD_YESTERDAY",start:moment().startOf("day").subtract(1,"days"),end:moment().startOf("day")}),s.ranges.push({period:"PERIOD_LAST_7_DAYS",start:moment().startOf("day").subtract(8,"days"),end:moment().endOf("day")}),s.ranges.push({period:"PERIOD_LAST_30_DAYS",start:moment().startOf("day").subtract(31,"days"),end:moment().endOf("day")}),s.ranges.push({period:"PERIOD_THIS_MONTH",start:moment().startOf("month"),end:moment().endOf("month")}),s.ranges.push({period:"PERIOD_LAST_MONTH",start:moment().subtract(1,"month").startOf("month"),end:moment().subtract(1,"month").endOf("month")});var f={};angular.forEach(s.ranges,function(a){f[e.get(a.period)]=[a.start,a.end]}),s.rangePickerAutoClose="always",r(),s.optionsCalendar={showDropdowns:!0,timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,alwaysShowCalendars:!0,dateLimit:{months:24},buttonClasses:["btn","btn-sm","btn-block"],applyClass:"btn-success",cancelClass:"btn-default",locale:{customRangeLabel:e.get("PERIOD_CUSTOM"),format:"L LT",applyLabel:e.get("OK"),cancelLabel:e.get("CANCEL")},opens:"right",eventHandlers:{"apply.daterangepicker":function(a){s.rangePickerAutoClose="always",s.rangePickerIsOpen=!1,m()},"hide.daterangepicker":function(a){s.rangePickerAutoClose="always",s.rangePickerIsOpen=!1},"cancel.daterangepicker":function(a){s.rangePickerAutoClose="always",s.rangePickerIsOpen=!1}},ranges:f}}function l(){s.currentRange=s.datesModel.endDate.unix()-s.datesModel.startDate.unix();var a=moment(s.datesModel.endDate).add(s.currentRange,"s");s.nextRangeAllowed=s.maxDate.unix()>=a.unix()}function m(){l(),r(),s.executeOnChange()}function n(a){return a.start.unix()===s.datesModel.startDate.unix()&&a.end.unix()===s.datesModel.endDate.unix()}function o(a){s.isRangeSelected(a)||(s.datesModel={startDate:moment(a.start),endDate:moment(a.end)},m())}function p(){for(var a=0;a<s.ranges.length;a++)if(s.isRangeSelected(s.ranges[a]))return!1;return!0}function q(){for(var a=0;a<s.ranges.length;a++)if(c.debug("Period "+s.ranges[a].period+" selected ? "+s.isRangeSelected(s.ranges[a])),s.isRangeSelected(s.ranges[a]))return s.ranges[a].period;return"PERIOD_CUSTOM"}function r(){c.debug("Recomputing label "+s.datesModel.startDate.unix()+":"+s.datesModel.endDate.unix());var a=q();s.rangePickerLabel="PERIOD_CUSTOM"!==a?e.get(a):b("amDateFormat")(s.datesModel.startDate,"LLL")+" - "+b("amDateFormat")(s.datesModel.endDate,"LLL"),c.debug("Label: "+s.rangePickerLabel+", period : "+a)}var s=this;s.isRangeSelected=n,s.selectRange=o,s.isCustomRangeSelected=p,k()}]).directive("vortextMessageRanges",function(){return{restrict:"E",scope:{change:"&onChange"},templateUrl:"components/vortext-messages-ranges.template.html",bindToController:{translation:"=",options:"=?",datesModel:"=?"},controllerAs:"vm",controller:"VortextMessageRangesCtrl"}})}(),function(){"use strict";angular.module("itcare.components").controller("VortextSubscriptionCtrl",["$scope","$filter","$log","$timeout","$uibModal","TranslationService","toaster","errorProvider","lodash","$window","$q",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var a={button:!0,text:"Souscrire  Vortext",classes:"nav-link"},b=angular.extend(a,n.options);c.debug("Options passed :"),c.debug(n.options),c.debug("Options merged :"),c.debug(b),c.debug(n.resource)}function m(){e.open({animation:a.animationsEnabled,templateUrl:"/messages/subscription/vortext-subscription.html",controller:"SubscriptionCtrl",controllerAs:"newSubscription",size:"lg",backdrop:"static",keyboard:!0,resolve:{resourceData:function(){return n.resource}}}).result.then(function(){g.pop("success",f.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_TITLE"),f.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_BODY"))},function(){c.debug("Modal dismissed at: "+new Date)})}var n=this;n.openVortextSubscriptionDialog=m,l()}]).directive("vortextSubscription",function(){return{restrict:"EA",templateUrl:"components/subscribe-vortext.template.html",bindToController:{translation:"=",resource:"=",options:"=?"},controllerAs:"subscription",controller:"VortextSubscriptionCtrl"}})}(),angular.module("itcare.components").component("objectStoresBrowser",{templateUrl:"components/object-stores-browser.template.html",controller:["$locale","$q","$rootScope","toaster","$uibModal","$timeout","$scope","$stateParams","$filter","Analytics","lodash","$log","ObjectStoresService","UserService","TranslationService","TagsSelectorService",ObjectStoresBrowserController],controllerAs:"osBrowser",bindings:{mode:"=",page:"<",size:"<",total:"<",create:"=",onRefresh:"&",service:"=",activeSearch:"=",activeSummary:"=",summary:"=",availableActions:"=",translation:"<"}}).directive("infiniteScrollTable",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(a,b,c,d){return{scope:{infiniteScrollTable:"&",infiniteScrollTableContainer:"=",infiniteScrollTableDistance:"=",infiniteScrollTableDisabled:"=",infiniteScrollTableUseDocumentBottom:"=",infiniteScrollTableListenForEvent:"@"},link:function(e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return y=angular.element(b),t=null,u=null,i=null,j=null,q=!0,x=!1,w=null,p=function(a){return a=a[0]||a,isNaN(a.offsetHeight)?a.document.documentElement.clientHeight:a.offsetHeight},r=function(a){if(a[0].getBoundingClientRect&&!a.css("none"))return a[0].getBoundingClientRect().top+s(a)},s=function(a){return a=a[0]||a,isNaN(window.pageYOffset)?a.document.documentElement.scrollTop:a.ownerDocument.defaultView.pageYOffset},o=function(){var b,c,d,g,h;return j===y?(b=p(j)+s(j[0].document.documentElement),d=r(f)+p(f)):(b=p(j),c=0,void 0!==r(j)&&(c=r(j)),d=r(f)-c+p(f)),x&&(d=p((f[0].ownerDocument||f[0].document).documentElement)),g=d-b,h=g<=p(j)*t+1,h?(i=!0,u?e.$$phase||a.$$phase?e.infiniteScrollTable():e.$apply(e.infiniteScrollTable):void 0):i=!1},v=function(a,b){var d,e,f;return f=null,e=0,d=function(){return e=(new Date).getTime(),c.cancel(f),f=null,a.call(),null},function(){var g,h;return g=(new Date).getTime(),h=b-(g-e),h<=0?(clearTimeout(f),c.cancel(f),f=null,e=g,a.call()):f?void 0:f=c(d,h,1)}},null!=d&&(o=v(o,d)),e.$on("$destroy",function(){if(j.unbind("scroll",o),null!=w)return w(),w=null}),m=function(a){return t=parseFloat(a)||0},e.$watch("infiniteScrollTableDistance",m),m(e.infiniteScrollTableDistance),l=function(a){if((u=!a)&&i)return i=!1,o()},e.$watch("infiniteScrollTableDisabled",l),l(e.infiniteScrollTableDisabled),n=function(a){return x=a},e.$watch("infiniteScrollTableUseDocumentBottom",n),n(e.infiniteScrollTableUseDocumentBottom),h=function(a){if(null!=j&&j.unbind("scroll",o),j=a,null!=a)return j.bind("scroll",o)},h(y),e.infiniteScrollTableListenForEvent&&(w=a.$on(e.infiniteScrollTableListenForEvent,o)),k=function(a){if(null!=a&&0!==a.length){if(a instanceof HTMLElement?a=angular.element(a):"function"==typeof a.append?a=angular.element(a[a.length-1]):"string"==typeof a&&(a=angular.element(document.querySelector(a))),null!=a)return h(a);throw new Exception("invalid infinite-scroll-container attribute.")}},e.$watch("infiniteScrollTableContainer",k),k(e.infiniteScrollTableContainer||[]),null!=g.infiniteScrollTableParent&&h(angular.element(f.parent())),null!=g.infiniteScrollTableImmediateCheck&&(q=e.$eval(g.infiniteScrollTableImmediateCheck)),c(function(){if(q)return o()},0,1)}}}]),angular.module("itcare.components").component("objectStoresActivity",{templateUrl:"components/object-stores-activity.template.html",controller:["$scope","$filter","lodash","$log","ObjectStoresService","TranslationService","$state",ObjectStoresActivityController],controllerAs:"osActivity",bindings:{summary:"=",translation:"<"}}),function(){"use strict";function a(a,b){var c={};return c.pick=function(c){var d=b.defer();return a.open({animation:!0,templateUrl:"/components/service-picker.template.html",controller:"ServicePickerCtrl",controllerAs:"sp",size:"lg",backdrop:"static",keyboard:!0,resolve:{actionRequired:function(){return c}}}).result.then(function(a){d.resolve(a)},function(){d.reject("User cancelled")}),d.promise},c}function b(a,b,c){function d(){}function e(){a.close(g.selectedService)}function f(){a.dismiss("cancel")}var g=this;g.submit=e,g.cancel=f,g.actionRequired=c,g.selectedService=void 0,g.error=void 0,d(),g.searchPromise=function(a){return b.search(a,"service").then(function(a){return a.data})},g.selectResource=function(a,d,e,f){if(a){b.getServiceDetail(a.id).then(function(a){if(c){var b=!1;angular.forEach(a.data.availableActions,function(a){"create-instance"==a.operation&&a.available&&(b=!0)}),b?(g.selectedService=a.data,g.error=void 0):(g.error="Not authorized to create instances for "+a.data.name,g.selectedService=void 0)}else g.selectedService=a.data,g.error=void 0},function(){g.error="Error loading service "+a.name,g.selectedService=void 0})}else g.selectedService=void 0}}angular.module("itcare.components").factory("ServicePickerService",["$uibModal","$q",a]),angular.module("itcare.components").controller("ServicePickerCtrl",["$uibModalInstance","CiService","actionRequired",b])}(),function(){"use strict";angular.module("itcare.compute",["ui.router","toaster","itcare.business"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){a.currentSection="compute",s.user=m.getCurrentUser(),k.disableFooter(),k.setTitle("Compute"),s.ui={colors:k.colors},q(),s.lastSearches=i.getPreference("recent-search"),s.lastServicesViews=i.getPreference("last-views")}function q(){l.getCloudOverview().then(function(a){s.overview=a.data,s.overviewLoading=!1},function(){s.overviewLoading=!1})}function r(a){"service"==a.type?f.go("services_detail.dashboard",{serviceId:a.id}):"instance"==a.type?f.go("services_detail.instance.information",{serviceId:a.serviceId,instanceId:a.id}):"hardware"==a.type?f.go("services_detail.hardware.information",{serviceId:a.id,id:a.resourceId}):"cluster"==a.type?f.go("services_detail.cluster.information",{serviceId:a.serviceId,clusterId:a.id}):f.go("services_detail.loadbalancer.information",{serviceId:a.serviceId,url:a.resourceName})}var s=this;s.user={},s.overview={},s.overviewLoading=!0,s.obsoChart={},s.countEvent=0,s.instanceObsolescenceTableData=[],s.instancesPerPhase={STANDARD:{count:0,platforms:[]},END_OF_SALES:{count:0,platforms:[]},EXTENDED:{count:0,platforms:[]},END_OF_SUPPORT:{count:0,platforms:[]}},s.platforms=[],s.goToLastView=r,p(),s.launchCreateInstance=function(){n.pick("create-instance").then(function(a){h.open({animation:!0,templateUrl:"/services/detail/automation/create-instance.html",controller:"InstanceCreationCtrl",controllerAs:"newInst",size:"lg",backdrop:"static",keyboard:!0,resolve:{service:function(){return a}}}).result.then(function(b){f.go("services_detail.dashboard",{serviceId:a.id})},function(){e.debug("Modal dismissed at: "+new Date)})},function(){})}}angular.module("itcare.compute").controller("ComputeCtrl",["$rootScope","$scope","lodash","$http","$log","$state","$filter","$uibModal","UserPreferencesService","TranslationService","UIService","CiService","UserService","ServicePickerService","Analytics",a])}(),function(){"use strict";angular.module("itcare.compute").config(["$stateProvider",function(a){a.state("compute",{url:"/compute",templateUrl:"/compute/compute.html",controllerAs:"computeCtrl",controller:"ComputeCtrl",ncyBreadcrumb:{label:"{{translation.COMPUTE}}"}})}])}(),function(){"use strict";angular.module("itcare.costs",["ui.router","toaster"])}(),function(){"use strict";function a(a,b,c,d,e){function f(){return a.currentSection="costs",g().then(function(){c.debug("Billed entities")})}function g(){return e.getBilledEntities().then(function(a){return h.billedEntities=a,h.billedEntities})}var h=this;h.billedEntities=[],f()}angular.module("itcare.costs").controller("CostsCtrl",a),a.$inject=["$rootScope","$scope","$log","$state","CostsService"]}(),function(){"use strict";angular.module("itcare.costs").config(["$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider",function(a,b,c){a.state("costs",{url:"/costs",templateUrl:"/costs/costs.html",controllerAs:"costs",controller:"CostsCtrl"})}])}(),function(){"use strict";function a(a,b){var c={};c.getBilledEntities=d;var d=function(){return a.get(b+"/billedentities")};return c}angular.module("itcare.costs").factory("CostsService",["$http","BACKEND_ENDPOINT",a])}(),function(){"use strict";angular.module("itcare.help",["ui.router","ui.bootstrap"])}(),function(){"use strict";function a(a,b,c){var d={};return d.displayModal=function(d,e){var e=angular.merge({lang:a.lang,size:"md"},e),f="help/"+e.lang+"/"+d+".html",g=["$uibModalInstance","$scope","$log","contentFile",function(a,b,c,d){function e(){b.contentFile=d}e(),b.close=function(){c.debug("click on close button"),a.dismiss("cancel")}}];b.open({templateUrl:"help/help-modal.html",controller:g,size:e.size,resolve:{contentFile:function(){return f}}}).result.then(function(){c.debug("Help modal closed")},function(){c.debug("Help modal dismissed")})},d.getTemplate=function(a,b){return"help/"+b+"/"+a+".html"},d}angular.module("itcare.help").factory("HelpService",["$rootScope","$uibModal","$log",a])}(),function(){"use strict";angular.module("itcare.agenda",["ngLodash","mwl.calendar","ngAnimate","ui.bootstrap"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){a.currentSection="agenda",g.setTitle("Agenda"),d.dateFormatter="moment",k.templateHelp=f.getTemplate("agenda-description",a.lang),k.events=c.data,angular.forEach(k.events,function(a){a.startsAt=new Date(a.startsAt),a.endsAt=new Date(a.endsAt),a.color=j(a.type),a.draggable=!1,a.resizable=!0})}function j(a){switch(a){case"patch":return{primary:g.colors.danger,secondary:g.colors.danger};default:return{primary:g.colors.primary,secondary:g.colors.primary}}}var k=this;k.templateHelp=void 0,k.events=[],k.calendarView="year",k.viewChangeEnabled=!1,k.changeColor=j,k.viewDate=new Date,k.cellIsOpen=!0,k.title="",i(),k.toggle=function(a,b,c){a.preventDefault(),a.stopPropagation(),c[b]=!c[b]},k.viewChangeClicked=function(a,b){return k.viewChangeEnabled},k.timespanClicked=function(a,b){"month"===k.calendarView?k.cellIsOpen&&moment(a).startOf("day").isSame(moment(k.viewDate).startOf("day"))||0===b.events.length||!b.inMonth?k.cellIsOpen=!1:(k.cellIsOpen=!0,k.viewDate=a):"year"===k.calendarView&&(k.cellIsOpen&&moment(a).startOf("month").isSame(moment(k.viewDate).startOf("month"))||0===b.events.length?k.cellIsOpen=!1:(k.cellIsOpen=!0,k.viewDate=a))}}angular.module("itcare.agenda").controller("AgendaCtrl",["$rootScope","$state","events","calendarConfig","$log","HelpService","UIService","TranslationService",a])}(),function(){"use strict";angular.module("itcare.agenda").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("agenda",{url:"/agenda",templateUrl:"/agenda/agenda.content.html",controller:"AgendaCtrl",controllerAs:"agenda",data:{restricted:!0},resolve:{events:["AgendaService",function(a){return a.getEvents()}]}})}])}(),function(){"use strict";angular.module("itcare.storage",["itcare.business","ngLodash","ngAnimate","rzModule","ui.bootstrap"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){a.currentSection="storage",b.setTitle("Storage"),r.loading=!1,m(),n(),o()}function m(a){r.summary.loading=!0,h.getObjectStoresSummary(void 0,a).then(function(a){r.summary=g.merge(r.summary,a.data),r.summary.loading=!1},function(a){e.error("Failed to refresh summary for object stores: "+a)})}function n(){g.forEach(j.data,function(a){var b="";a.available||g.forEach(a.unavailabilityCauses,function(a){b+=f.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),r.availableActions[a.operation]={available:a.available,errors:b}})}function o(){h.getStatus().then(function(b){r.serviceStatus=b.data,angular.forEach(r.serviceStatus,function(b,c){r.defaultConfForIndicators={legend:[100*b.definition.availabilityWarn,100*b.definition.availabilityTarget],itemName:["% "+a.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY,"% "+a.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY],tooltip:!0,toolTipAction:void 0};var d=[];if(e.debug(b),b.monthlyAvailabilities.length>0)for(var f=0;f<b.monthlyAvailabilities.length;f++)e.debug(b.monthlyAvailabilities[f]),null!=b.monthlyAvailabilities[f]&&(d=d.concat(b.monthlyAvailabilities[f].availability));e.debug(d),r.mapMonths[c]={data:i.getAvailabilityCalHeatmap(d),options:{displayLegend:!1,cellPadding:1,cellSize:7,domainGutter:0,domainMargin:5,legend:r.defaultConfForIndicators.legend,range:b.monthlyAvailabilities.length,tooltip:!1,domainLabelFormat:"%b",subDomainTextFormat:"",subDomainTitleFormat:{empty:"",filled:""},toolTipAction:void 0,onClick:function(a,b){var d=null;angular.forEach(b.monthlyAvailabilities,function(b){k(b.availability[0].date).month()==a.getMonth()&&(d=a.getMonth())}),null!=d&&p(d+1,c)}}},p((new Date).getMonth()+1,c)}),r.indicatorLoading=!1})}function p(a,b){e.debug("selecting month "+a),angular.forEach(r.serviceStatus[b].monthlyAvailabilities,function(c){var d=k(c.availability[0].date);d.month()==a-1&&(r.selectedAvailability[b]=c,r.selectedAvailabilityDate[b]=new Date(d.year(),d.month()))}),q(a)}function q(a){r.customStyle=".cal-year .m_"+a+" .domain-background { fill: #6f6f6f; } .cal-year .m_"+a+" .graph-label { fill: #efefef; }"}var r=this;r.title="",r.loading=!0,r.indicatorLoading=!0,r.summary={"last-creation":void 0,"total-stores":0,"total-objects":0,"total-gb":0,"total-regions":0,loading:!0},r.availableActions={},r.openCreateObjectStoresDialog=void 0,r.serviceStatus=[],r.selectedAvailability=[],r.selectedAvailabilityDate=[],r.mapMonths=[],r.getObjectStorageSummary=m,l()}angular.module("itcare.storage").controller("StorageCtrl",["$rootScope","UIService","$uibModal","$state","$log","TranslationService","lodash","ObjectStoresService","IndicatorService","availableActions","moment",a])}(),function(){"use strict";angular.module("itcare.storage").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("storage",{url:"/storage",templateUrl:"/storage/storage.home.html",controller:"StorageCtrl",controllerAs:"storage",data:{restricted:!0},resolve:{availableActions:["ObjectStoresService",function(a){return a.availableActions()}]},ncyBreadcrumb:{label:"{{translation.OBJECT_STORAGE_HOME_TITLE}}"}}).state("storage_detail",{url:"/storage/:id",templateUrl:"/storage/detail/storage-detail.html",controller:"StorageDetailCtrl",controllerAs:"storageDetailCtrl",resolve:{storageDetail:["ObjectStoresService","$stateParams",function(a,b){return a.getObjectStore(b.id)}]},ncyBreadcrumb:{label:"{{storageDetailCtrl.storage.id}}",parent:"storage"}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){a.currentSection="storage",y.storage=m.data,t(),o.setTitle("Storage Detail : "+y.storage.id)}function r(){p.getObjectStore(y.storage.id).success(function(a){y.storage=a})}function s(){c.go("storage")}function t(){var a={};k.forEach(y.storage.availableActions,function(b){var c="";b.available||k.forEach(b.unavailabilityCauses,function(a){c+=n.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),a[b.operation]={available:b.available,errors:c}}),y.storage.availableActions=a}function u(){i.open({animation:!0,templateUrl:"/storage/detail/update-object-store.html",controller:"ObjectEditionCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{objectStore:function(){return y.storage}}}).result.then(function(a){r()},function(){d.debug("Modal dismissed at: "+new Date)})}function v(b){f.promptTagsInModal(a.translation,y.storage.tags,"",b).then(function(a){b&&p.updateTags(y.storage.name,a).then(function(a){l.pop("success",n.get("TAGS_UPDATED_TITLE"),n.get("TAGS_UPDATED_BODY")),r()},function(a){d.error("Failed to update object stores: "+a)})})}function w(){i.open({animation:!0,templateUrl:"/storage/detail/delete-object-store.html",controller:"ObjectDeletionCtrl",controllerAs:"model",size:"lg",backdrop:"static",keyboard:!0,resolve:{objectStore:function(){return y.storage}}}).result.then(function(a){s()},function(){d.debug("Modal dismissed at: "+new Date)})}function x(a,b){return Number(100*Number(a/b).toFixed(5)).toFixed(2)}var y=this;y.storage={},y.showEditionModal=u,y.openTagsEditor=v,y.showDeletionModal=w,y.computeRatio=x,y.backToDashboard=s,y.refresh=r,q()}angular.module("itcare.storage").controller("StorageDetailCtrl",["$rootScope","$scope","$state","$log","$q","TagsSelectorService","UserService","CiService","$uibModal","$sce","lodash","toaster","storageDetail","TranslationService","UIService","ObjectStoresService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){for(var a=[],b=L;b<=M;b*=2)a.push(""+b);return a}function q(){I.templateMailHelp=o.getTemplate("create-object-store-email",a.lang),v(),w(),x(),I.steps=[{label:"LOCALIZATION",icon:"fa-globe"},{label:"SETTINGS",icon:"fa-cog"},{label:"QUOTA",icon:"fa-hdd-o"},{label:"CUSTOMIZATION",icon:"fa-table"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-bars"}],I.currentStep="LOCALIZATION",t()}function r(){I.wizardForm.name&&(I.finalName=(I.prefixName+I.name).toLowerCase(),I.wizardForm.name.$setValidity("patternValid",null!==I.nameRegexValidator.exec(I.finalName)),I.wizardForm.name.$setValidity("length",I.finalName.length<255),I.wizardForm.name.$error.patternValid||I.wizardForm.name.$error.length||(I.submitIsProcess?I.lastCheck=s:s()))}function s(){I.submitIsProcess=!0,I.availableName=!1,l.checkName(I.finalName).then(function(a){if(I.availableName=a.data,I.wizardForm.name&&I.wizardForm.name.$setValidity("notPresent",I.availableName),void 0!==I.lastCheck){var b=I.lastCheck;I.lastCheck=void 0,b()}I.submitIsProcess=!1})}function t(){c(function(){a.$broadcast("rzSliderForceRender")})}function u(a){I.selectedLocation=a}function v(){void 0!==n&&(I.selectedService.id=n.id,I.selectedService.name=n.name,I.selectedService.cloud=new String(n.cloud).replace(/ /g,"").replace(/&/g,""))}function w(){angular.isDefined(m)&&200===m.status&&(I.email=m.data.userEmail)}function x(){angular.isDefined(j)&&200===j.status&&(I.locations=j.data)}function y(){I.sliderQuota.options.disabled=!I.selectedQuota,I.sliderQuota.value=L}function z(a,b,c,d){"ACTIVE"===a.status||"PREPARATION"===a.status?(f.debug("selecting ci "+a),a.selected=!0,I.selectedService.id=a.id,I.selectedService.name=a.name,I.selectedService.cloud=a.cloud,I.selectedServiceError=void 0):(I.selectedService.id=void 0,I.selectedService.name=void 0,I.selectedService.cloud=void 0,I.selectedServiceError=k.get("OBJECT_STORAGE_CREATE_NAME_SERVICE_UNAVAILABLE",a.name))}function A(a){return l.searchServices(a).then(function(a){if(angular.isDefined(a)&&200===a.status)return a.data})}function B(){switch(I.currentStep){case"LOCALIZATION":return!(!I.selectedLocation||I.submitIsProcess);case"SETTINGS":return!(!I.wizardForm.email.$valid||!I.selectedService.name||I.submitIsProcess);case"QUOTA":return!I.submitIsProcess;case"CUSTOMIZATION":return!(!I.wizardForm.$valid||I.submitIsProcess);case"APP_WIZARD_STEP_SYNTHESIS":return!0}}function C(){switch(I.currentStep){case"LOCALIZATION":return!1;case"SETTINGS":case"QUOTA":case"CUSTOMIZATION":case"APP_WIZARD_STEP_SYNTHESIS":return!0}}function D(a){I.refreshSlider(),I.currentStep}function E(){switch(I.currentStep){case"LOCALIZATION":I.currentStep="SETTINGS";break;case"SETTINGS":I.selectedService.cloud=I.selectedService.cloud.replace(/[$\s]/,""),I.prefixName=J+I.selectedService.cloud+K,I.finalName=I.prefixName+I.name,I.currentStep="QUOTA";break;case"QUOTA":I.currentStep="CUSTOMIZATION";break;case"CUSTOMIZATION":I.currentStep="APP_WIZARD_STEP_SYNTHESIS"}D(I.currentStep)}function F(){switch(I.currentStep){case"SETTINGS":I.currentStep="LOCALIZATION";break;case"QUOTA":I.currentStep="SETTINGS";break;case"CUSTOMIZATION":I.currentStep="QUOTA";break;case"APP_WIZARD_STEP_SYNTHESIS":I.currentStep="CUSTOMIZATION"}D(I.currentStep)}function G(){I.submitIsProcess=!0;var a=I.selectedQuota?I.sliderQuota.value:0;l.create(I.name,a,I.selectedLocation.id,I.selectedService.id,I.email).then(function(a){if(g.trackEvent("Object Storage","Creation Completed"),I.submitIsProcess=!1,201!==a.status)f.debug("Failed to create object storage: "+a.status);else{var b=a.data;d.pop("success",k.get("OBJECT_STORAGE_CREATE_SUCCESS")),e.close(b)}},function(a){I.submitIsProcess=!1,f.error("Failed to create object storage: "+a.data[0].code)})}function H(){e.dismiss("cancel")}var I=this,J="cos-",K="-",L=1,M=10240;I.loaded=!1,I.modelWizard=void 0,I.isCurrentFormValid=!1,I.steps=[],I.customizationStep=[],I.wizardForm={},I.locations=void 0,I.selectedLocation=void 0,I.selectedQuota=!1,I.sliderQuota={options:{hideLimitLabels:!0,stepsArray:p(),precision:1,noSwitching:!0,disabled:!0,showSelectionBarEnd:!0,getSelectionBarColor:function(a){return"transparent"},translate:function(a,b,c){switch(c){case"model":case"high":return'<p><span class="label label-success-storage" style="top: -10px; left: -30px;">'+a+" Gb</span></p>"}}}},I.selectedService={id:void 0,name:void 0,cloud:void 0},I.email=void 0,I.selectedServiceError=void 0,I.name=void 0,I.prefixName=void 0,I.finalName=void 0,I.nameRegexValidator=/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$/i,I.templateMailHelp=void 0,I.submitIsProcess=!1,I.lastCheck=void 0,I.cancel=H,I.next=E,I.previous=F,I.submit=G,I.gotoStep=D,I.previousAuthorized=C,I.nextAuthorized=B,I.refreshSlider=t,I.selectLocation=u,I.selectQuota=y,I.computeServices=z,I.searchServices=A,I.checkName=r,q()}angular.module("itcare.storage").controller("ObjectCreationCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","Analytics","errorProvider","lodash","localizations","TranslationService","ObjectStoresService","defaultUser","defaultService","HelpService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){q.object.quotaSizeGb&&q.object.quotaSizeGb>0?(q.sliderQuota.value=q.object.quotaSizeGb,q.selectedQuota=!0):(q.selectedQuota=!1,q.sliderQuota.value=r),q.sliderQuota.options.disabled=!q.selectedQuota,m()}function m(){c(function(){a.$broadcast("rzSliderForceRender")})}function n(){q.sliderQuota.options.disabled=!q.selectedQuota,q.sliderQuota.value=q.selectedQuota?t:r,q.sliderQuota.options.step=s}function o(){q.submitIsProcess=!0;var a=k.updateQuota(q.object.name,q.sliderQuota.value);g.trackEvent("Object Storage","Update Completed"),a.then(function(a){q.submitIsProcess=!1,200!==a.status?f.debug("Failed to updateQuota object storage: "+a.status):(d.pop("success",j.get("OBJECT_STORAGE_UPDATE_SUCCESS")),e.close())},function(a){q.submitIsProcess=!1,f.error("Failed to create object storage: "+a.data[0].code)})}function p(){e.dismiss("cancel")}var q=this,r=0,s=1,t=2;q.loaded=!1,q.modelWizard=void 0,q.isCurrentFormValid=!1,q.steps=[],q.customizationStep=[],q.wizardForm={},q.object=i,q.submitIsProcess=!1,q.selectedQuota=!1,q.sliderQuota={value:r,options:{hideLimitLabels:!0,step:s,precision:1,ceil:10240,floor:1,noSwitching:!0,disabled:!0,showSelectionBarEnd:!0,getSelectionBarColor:function(a){return"transparent"},translate:function(a,b,c){switch(c){case"model":case"high":return q.sliderQuota.options.disabled?"":'<p><span class="label label-success-storage" style="top: -10px; left: -30px;">'+a+" Gb</span></p>"}}}},q.cancel=p,q.submit=o,q.refreshSlider=m,q.selectQuota=n,l()}angular.module("itcare.storage").controller("ObjectEditionCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","Analytics","lodash","objectStore","TranslationService","ObjectStoresService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){l.loaded=!0;var a=i.delete(l.object.name);d.trackEvent("Object Storage","Deletion Completed"),a.then(function(a){l.loaded=!1,200!==a.status?c.debug("Failed to delete object storage: "+a.status):(h.pop("success",f.get("ACTION_CONFIRM_DELETE")),b.close())},function(a){l.loaded=!1,c.error("Failed to create object storage: "+a.data[0].code)})}function k(){b.dismiss("cancel")}var l=this;l.loaded=!1,l.cancel=k,l.ok=j,l.object=g}angular.module("itcare.storage").controller("ObjectDeletionCtrl",["$scope","$uibModalInstance","$log","Analytics","errorProvider","TranslationService","objectStore","toaster","ObjectStoresService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){t.user=l}function n(){void 0==t.user.accessKey?p():o()}function o(){t.submitIsProcess=!0;var a=k.all([j.updateUserOperation(t.user.cos,t.user.accessKey,t.user.isLocked?"lock":"unlock"),j.updateUserOperation(t.user.cos,t.user.accessKey,"update_label",{label:t.user.label})]);g.trackEvent("Object Storage Users","Update Completed"),a.then(function(a){t.submitIsProcess=!1,200!==a[0].status||200!==a[1].status?(f.debug("Failed to update user: "+a[0].status),d.pop("error",i.get("OBJECT_STORAGE_EDIT_USER_ERROR")),e.close()):(d.pop("success",i.get("OBJECT_STORAGE_UPDATE_USER_SUCCESS")),e.close())},function(a){t.submitIsProcess=!1,f.error("Failed to update object stores user: "+a.data)})}function p(){t.submitIsProcess=!0;var a=j.createUser(l.cos,l.label);g.trackEvent("Object Storage Users","Creation Completed"),a.then(function(a){t.submitIsProcess=!1,201!==a.status?(f.debug("Failed to create user: "+a.status),d.pop("error",i.get("OBJECT_STORAGE_ADD_USER_ERROR")),e.close()):(d.pop("success",i.get("OBJECT_STORAGE_ADD_USER_CONFIRM")),q(a.data))},function(a){t.submitIsProcess=!1,f.error("Failed to create object stores user: "+a.data)})}function q(a){t.submitted=!0,t.secretKey=a.secretKey,t.accessKey=a.accessKey}function r(){e.dismiss("cancel")}function s(){e.close(void 0)}var t=this;t.submitIsProcess=!1,t.submitted=!1,t.secretKey=void 0,t.accesKey=void 0,t.form={},t.cancel=r,t.submit=n,t.close=s,m()}angular.module("itcare.storage").controller("ObjectStoresUserUpdateCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","Analytics","lodash","TranslationService","ObjectStoresService","$q","user",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){l.loaded=!0;var a=i.deleteUser(l.user.cos,l.user.accessKey);d.trackEvent("Object Storage User","Deletion Completed"),a.then(function(a){l.loaded=!1,200!==a.status?c.debug("Failed to delete user: "+a.status):(h.pop("success",f.get("ACTION_CONFIRM_DELETE")),b.close())},function(a){l.loaded=!1,c.error("Failed to create object storage: "+a.data[0].code)})}function k(){b.dismiss("cancel")}var l=this;l.loaded=!1,l.cancel=k,l.ok=j,l.user=g}angular.module("itcare.storage").controller("ObjectUserDeletionCtrl",["$scope","$uibModalInstance","$log","Analytics","errorProvider","TranslationService","user","toaster","ObjectStoresService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){r.user=k}function m(){void 0!=r.expirationField&&r.form.expiration.$setValidity("badsize",r.expirationField<1440)}function n(){r.submitIsProcess=!0,j.updateUserOperation(k.objectStore,k.accessKey,"change_secret",{expirationTimeMinutes:r.expirationField}).then(function(a){r.submitIsProcess=!1,200!==a.status?(f.debug("Failed to update secret key: "+a.status),d.pop("error",i.get("OBJECT_STORAGE_CHANGE_SECRET_ERROR")),e.close(void 0)):(d.pop("success",i.get("OBJECT_STORAGE_CHANGE_SECRET_SUCCESS")),o(a.data))},function(a){r.submitIsProcess=!1,f.error("Failed to create object stores user: "+a.data)})}function o(a){r.submitted=!0,r.secret=a.secret_key}function p(){e.dismiss("cancel")}function q(){e.close(void 0)}var r=this;r.submitIsProcess=!1,r.submitted=!1,r.secret=void 0,r.expirationField=0,r.form={},r.cancel=p,r.submit=n,r.close=q,r.checkExpiration=m,l()}angular.module("itcare.storage").controller("ObjectStoresUserChangeSecretCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","Analytics","lodash","TranslationService","ObjectStoresService","user",a])}(),function(){"use strict";angular.module("itcare.home",["ui.router","toaster","itcare.business","itcare.help"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(){return a.currentSection="home",O.user=t.getCurrentUser(),m.disableFooter(),m.setTitle("Home"),O.ui={colors:m.colors},O.overview=i.data,O.lastSearches=k.getPreference("recent-search"),O.lastServicesViews=k.getPreference("last-views"),w(),y(),z(),A(),x(),B(),C(),O.overview}function w(){d.get("/assets/agenda/agenda.json").then(function(a){angular.forEach(a.data,function(a){moment().month()==moment(a.startsAt).month()&&moment().year()==moment(a.startsAt).year()&&O.countEvent++})})}function x(){O.monitoringLoading=!0,n.getMonitoringOverview().then(function(a){angular.forEach(a.data.outages,function(a){var b=l.get("monitoring."+a.checkName);b=="monitoring."+a.checkName&&(b=a.checkName),a.display=a.resourceName+" ("+b+")",a.displayTheme="WARNING"==a.status?"warning":"red",a.displayLegend=a.serviceName+"-"+g("amTimeAgo")(a.since),a.displayIcon="WARNING"==a.status?"fa-exclamation-triangle":"fa-exclamation-circle",a.textClass="WARNING"==a.status?"text-warning":"text-danger"}),O.monitoringOverview=a.data,O.monitoringLoading=!1},function(){O.monitoringLoading=!1})}function y(){O.ticketsLoading=!0,r.getTicketsOverview().then(function(a){O.ticketsOverview=a.data,O.ticketsLoading=!1},function(){O.ticketsLoading=!1})}function z(){o.getVortextStats().then(function(a){O.messagesOverview=a.data,O.messagesLoading=!1},function(a){e.error("Failed to retrieve messages datas: "+a),O.messagesOverview=void 0,O.messagesLoading=!1})}function A(){p.getVulnerabilitiesSummary().then(function(a){O.vulnerabilitiesSummary.datas=a.data.vulnerabilitiesSummary,O.vulnerabilitiesSummary.loading=!1},function(a){e.error("Failed to refresh summary for vulnerabilities: "+a)})}function B(){q.getObjectStoresSummary().then(function(a){O.objectStorageSummary=c.merge(O.objectStorageSummary,a.data),O.objectStorageSummary.loading=!1},function(a){e.error("Failed to refresh summary for object stores: "+a)})}function C(){O.servicesStatuses=[];var a=q.getStatus(),b=o.getVortextStatus(),c=n.getApiStatus();a.then(function(a){angular.forEach(a.data,function(a){O.servicesStatuses.push({name:a.indicatorName,available:a.liveAvailability.available})})}),b.then(function(a){O.servicesStatuses.push({name:"Messages API",available:a.data.liveAvailability.available})}),c.then(function(a){O.servicesStatuses.push({name:"ITCare API",available:a.data.available})})}function D(a){j.displayModal(a)}function E(a){"service"==a.type?f.go("services_detail.dashboard",{serviceId:a.id}):"instance"==a.type?f.go("services_detail.instance.information",{serviceId:a.serviceId,instanceId:a.id}):"hardware"==a.type?f.go("services_detail.hardware.information",{serviceId:a.id,id:a.resourceId}):"cluster"==a.type?f.go("services_detail.cluster.information",{serviceId:a.serviceId,clusterId:a.id}):f.go("services_detail.loadbalancer.information",{serviceId:a.serviceId,url:a.resourceName})}function F(a){"instance"==a.resourceType?f.go("services_detail.instance.monitoring",{serviceId:a.serviceId,instanceId:a.resourceId}):"hardware"==a.resourceType?f.go("services_detail.hardware.monitoring",{serviceId:a.serviceId,id:a.resourceId}):f.go("services_detail.loadbalancer.monitoring",{serviceId:a.serviceId,url:a.resourceName})}function G(){f.go("vulnerabilities_detail")}function H(){f.go("storage")}function I(){f.go("monitoring",{statuses:"WARNING,CRITICAL",environments:"PRODUCTION"})}function J(){L(),f.go("tickets")}function K(a){M(a)}function L(){r.getTicketsOverview().then(function(a){b.updatedNotificationCount={toValidate:a.data.toValidateCount,awaitingResponse:a.data.awaitingResponseCount,total:a.data.awaitingResponseCount+a.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount)})}function M(a){r.getTicketsOverview().then(function(c){b.updatedNotificationCount={toValidate:c.data.toValidateCount,awaitingResponse:c.data.awaitingResponseCount,total:c.data.awaitingResponseCount+c.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount),f.go("tickets",{raiseUser:O.user.username,statuses:[a]})})}function N(){s.openModal(),u.trackEvent("Support","Ticket Creation Start Wizard","Home")}var O=this;O.user={},O.overview={},O.monitoringLoading=!0,O.monitoringOverview={},O.messagesOverview={},O.messagesLoading=!0,O.ticketsOverview={},O.ticketsLoading=!0,O.obsoChart={},O.countEvent=0,O.vulnerabilitiesSummary={datas:[],loading:!0},O.objectStorageSummary={"last-creation":void 0,"total-stores":0,"total-objects":0,"total-gb":0,loading:!0},O.instanceObsolescenceTableData=[],O.instancesPerPhase={STANDARD:{count:0,platforms:[]},END_OF_SALES:{count:0,platforms:[]},EXTENDED:{count:0,platforms:[]},END_OF_SUPPORT:{count:0,platforms:[]}},O.platforms=[],O.openHelp=D,O.createSupportTicket=N,O.goToLastView=E,O.goToAlert=F,O.goToMonitoring=I,O.goToVulnerabiltiesDetail=G,O.goToObjectStoresDetail=H,O.getVulnerabilitiesSummary=A,O.getObjectStorageSummary=B,O.getMessagesOverview=z,O.goToTicketing=J,O.filterMyTicketStatus=K,$.urlParam=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);return null==b?0:b[1]},$(document).ready(function(){$.urlParam("createTicket")&&O.createSupportTicket()}),v(),a.$on("$ticketOverviewCount",function(a,b){return O.ticketsOverview.toValidateCount=b.toValidate,O.ticketsOverview.awaitingResponseCount=b.awaitingResponse,O.ticketsOverview.inProgressCount=b.inProgress,O.ticketsOverview})}angular.module("itcare.home").controller("HomeCtrl",["$rootScope","$scope","lodash","$http","$log","$state","$filter","$uibModal","overview","HelpService","UserPreferencesService","TranslationService","UIService","CiService","MessagesService","VulnerabilityService","ObjectStoresService","TicketService","CreateTicketService","UserService","Analytics",a])}(),function(){"use strict";angular.module("itcare.home").config(["$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider",function(a,b,c){a.state("home",{url:"/home",templateUrl:"/home/home.html",controllerAs:"home",controller:"HomeCtrl",resolve:{overview:["CiService","$stateParams",function(a,b){return a.getCloudOverview()}]}})}])}(),function(){"use strict";angular.module("itcare.menu",["itcare.business","FBAngular","angular-cookie-law"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){var a=f(function(){if(!t&&b.user.isAuthenticated){t=!0;q.getTicketsOverview().then(function(a){b.updatedNotificationCount={toValidate:a.data.toValidateCount,awaitingResponse:a.data.awaitingResponseCount,inProgress:a.data.inProgressCount,total:a.data.awaitingResponseCount+a.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount),b.$emit("$ticketOverviewCount",b.updatedNotificationCount),t=!1},function(){t=!1})}},d);b.$on("$destroy",function(){f.cancel(a)})}function s(){q.getTicketsOverview().then(function(a){b.updatedNotificationCount={toValidate:a.data.toValidateCount,awaitingResponse:a.data.awaitingResponseCount,inProgress:a.data.inProgressCount,total:a.data.awaitingResponseCount+a.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount)})}b.user=l.getCurrentUser(),b.menuCollapsed=!0;var t=!1;r(),b.searchPromise=function(a){return k.search(a).then(function(a){var b=a.data;return angular.forEach(b,function(a){var c=b.indexOf(a);"LB_VSERVER"==a.type?a.type=p.get("LOADBALANCER"):"CI_GLOBAL_SERVICE"==a.type?a.type=p.get("SERVICE"):a.type=p.get("INSTANCE"),b[c]=a}),b})},b.selectResource=function(a,c,d,f){g.debug("selected resource : "+a.id+"/"+a.name+"/"+a.type),b.menuCollapsed=!0,"service"==a.resourceType?e.go("services_detail.dashboard",{serviceId:a.id}):("instance"==a.resourceType&&(g.debug("go to instance detail"),e.go("services_detail.instance.information",{instanceId:a.id,serviceId:a.serviceId})),"cluster"==a.resourceType&&(g.debug("go to cluster detail"),e.go("services_detail.cluster.information",{clusterId:a.id,serviceId:a.serviceId})),"loadbalancer"==a.resourceType&&(g.debug("go to loadbalancer detail"),e.go("services_detail.loadbalancer.information",{url:a.name,serviceId:a.serviceId})),"hardware"==a.resourceType&&(g.debug("go to hardware detail"),e.go("services_detail.hardware.information",{hardwareId:a.id,serviceId:a.serviceId}))),i.trackEvent("Search","Address Bar Search")},b.legalMentions=function(a){n.displayModal(a)},b.toggleMenu=function(){b.menuCollapsed=!b.menuCollapsed},b.logout=function(){l.logout().then(function(a){g.debug("logout performed."),l.removeCurrentUser(),e.go("login")},function(a){})},b.isCloudFiltersActive=function(){var a={},b=!1;try{m.getOrganizations().forEach(function(c){if(void 0!==c.selected&&!c.selected)throw b=!0,a;if(void 0!==c.clouds)try{c.clouds.forEach(function(c){if(void 0!=c.selected&&!c.selected)throw b=!0,a})}catch(b){if(b!==a)throw b}})}catch(b){if(b!==a)throw b}return b},b.computeCloudSummary=function(){return m.computeCloudSummary()},b.resetCloudFilters=function(){l.getUser().then(function(a){m.resetOrganizations(a.data.organizations);l.setCurrentUser(a.data),b.cloudSummary=b.computeCloudSummary(),s(),e.reload()},function(a){})},b.showCloudPicker=function(){var a=m.getOrganizations();o.promptCloudsInModal(p,a).then(function(a){m.setPreference("organizations",a),b.cloudSummary=b.computeCloudSummary(),s(),e.reload()})},b.goToSupportDashboard=function(){e.go("tickets",{raiseUser:l.currentUser.username})},b.openSupportRequestModal=function(){j.openModal(),i.trackEvent("Support","Ticket Creation Start Wizard","Menu")},b.tickets={toValidate:0,awaitingResponse:0,total:0},b.computeNotificationCount=function(){return q.getTicketsOverview().then(function(a){b.tickets.toValidate=a.data.toValidateCount,b.tickets.awaitingResponse=a.data.awaitingResponseCount,b.tickets.total=b.tickets.toValidate+b.tickets.awaitingResponse}),b.tickets},c.$on("$notificationCount",function(a,c){return b.tickets.toValidate=c.toValidate,b.tickets.awaitingResponse=c.awaitingResponse,b.tickets.total=c.total,b.tickets})}function b(a,b,c){b.user=a.getCurrentUser()}angular.module("itcare.menu").controller("MenuCtrl",["$exceptionHandler","$scope","$rootScope","REFRESH_INTERVAL_ACTIONS","$state","$interval","$log","lodash","Analytics","CreateTicketService","CiService","UserService","UserPreferencesService","MentionsService","CloudsSelectorService","TranslationService","TicketService",a]).controller("BodyCtrl",["UserService","$scope","$log",b])}(),function(){"use strict";angular.module("itcare.mentions",["ui.router","ui.bootstrap"])}(),function(){"use strict";function a(a,b,c){var d={};return d.displayModal=function(a,d){var d=angular.merge({size:"lg"},d),e="mentions/"+a+".html",f=["$uibModalInstance","$scope","$log","$location","contentFile",function(a,b,c,d,e){function f(){b.contentFile=e,b.locationPath=d.protocol()+"://"+d.host()}f();b.close=function(){c.debug("click on close button"),a.dismiss("cancel")}}];b.open({templateUrl:"mentions/legal-mentions-modal.html",controller:f,size:d.size,resolve:{contentFile:function(){return e}}}).result.then(function(){c.debug("Legal mentions modal closed")},function(){c.debug("Legal mentions modal dismissed")})},d.getTemplate=function(a){return"mentions/"+a+".html"},d}angular.module("itcare.mentions").factory("MentionsService",["$rootScope","$uibModal","$log",a])}(),function(){"use strict";angular.module("itcare.obsolescence",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","toaster"])}(),function(){"use strict";angular.module("itcare.obsolescence").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("instances_obsolescence_service",{url:"/compute/instances-obsolescence?serviceId",templateUrl:"/services/obsolescence/obsolescence.html",controller:"InstancesObsolescenceCtrl",controllerAs:"instanceObs",resolve:{platformsDefinitions:["PlatformsService",function(a){return a.getPlatforms()}],serviceInstance:["CiService","$stateParams",function(a,b){if(b.serviceId)return a.getResourcesByServiceId(b.serviceId,!1)}]},ncyBreadcrumb:{label:"{{translation.MENU_COMPUTE_OBSOLESCENCE_TITLE}}",parent:"compute"}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){h.debug("serviceInstance"+e),h.debug("get instances");var b=d.getInstancesObsolescenceByServiceDetails(g.serviceId);n.platforms=f.data,b.then(function(a){h.debug("got instances"),n.instanceObsolescence=a.data,g.serviceId&&(n.defaultServiceName=e.data.name);for(var b=0;b<n.instanceObsolescence.length;b++)if(n.instanceObsolescenceTableData.push({INSTANCES:n.instanceObsolescence[b].name,SERVICES:n.instanceObsolescence[b].serviceName,PLATFORM:null==n.instanceObsolescence[b].platform?null:n.instanceObsolescence[b].platform.name,"SUPPORT TYPE":null==n.instanceObsolescence[b].platform?null:n.instanceObsolescence[b].platform.supportPhase}),null==n.instanceObsolescence[b]&&(n.instanceObsolescence[b].serviceName=n.defaultServiceName),null!=n.instanceObsolescence[b].platform){var c=n.instanceObsolescence[b].platform;n.instancesPerPhase[c.supportPhase].count++;var d=i.filter(n.instancesPerPhase[c.supportPhase].platforms,function(a){return a.name==c.name});0!=d.length?d[0].count++:n.instancesPerPhase[c.supportPhase].platforms.push({name:c.name,count:1})}n.instancesPerPhase.END_OF_SUPPORT.platforms.sort(function(a,b){return b.count-a.count}),n.instancesPerPhase.EXTENDED.platforms.sort(function(a,b){return b.count-a.count}),n.instancesPerPhase.END_OF_SALES.platforms.sort(function(a,b){return b.count-a.count}),n.instancesPerPhase.STANDARD.platforms.sort(function(a,b){return b.count-a.count}),h.debug(n.platforms),n.columnsHeaders=[k.get("OBSOLESCENCE_INSTANCE_NAME"),k.get("OBSOLESCENCE_INSTANCE_SERVICE_NAME"),k.get("OBSOLESCENCE_INSTANCE_PLATFORM_NAME"),k.get("OBSOLESCENCE_INSTANCE_SUPPORT_PHASE")];var f=new Date,j=f.getDate()+"-"+(f.getMonth()+1)+"-"+f.getFullYear()+"-"+f.getHours()+"-"+f.getMinutes()+"-"+f.getSeconds();n.fileExportName="instances-obsolescence-"+j,n.loading=!1,h.debug("computed results")}),a.currentSection="instances obsolescence",j.setTitle("Instance obsolescence")}function m(){c.trackEvent("Obsolescence","Export CSV")}var n=this;n.instanceObsolescence=[],n.defaultServiceName="",n.instanceObsolescenceTableData=[],n.columnsHeaders=[],n.fileExportName="",n.limitDisplay=100,n.loading=!0,n.instancesPerPhase={STANDARD:{count:0,platforms:[]},END_OF_SALES:{count:0,platforms:[]},EXTENDED:{count:0,platforms:[]},END_OF_SUPPORT:{count:0,platforms:[]}},n.platforms=[],n.exportCsv=m,l()}angular.module("itcare.obsolescence").controller("InstancesObsolescenceCtrl",["$rootScope","$state","Analytics","CiService","serviceInstance","platformsDefinitions","$stateParams","$log","lodash","UIService","TranslationService",a])}(),function(){"use strict";angular.module("itcare.vulnerability",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","toaster"])}(),function(){"use strict";angular.module("itcare.vulnerability").config(["$stateProvider",function(a){a.state("vulnerabilities_detail",{url:"/security/vulnerabilities?serviceId",templateUrl:"/services/vulnerability/vulnerabilities-detail.html",controller:"VulnerabilitiesDetailCtrl",controllerAs:"vDetail",ncyBreadcrumb:{label:"{{translation.VULNERABILITY_ACTIVITY_BROWSE_TITLE}}"}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){a.currentSection="security",f.setTitle("Vulnerabilities"),f.disableFooter()}this.loading=!0,h()}angular.module("itcare.vulnerability").controller("VulnerabilitiesDetailCtrl",["$rootScope","$state","$stateParams","$log","lodash","UIService","TranslationService",a])}(),function(){"use strict";angular.module("itcare.login",["ui.router","itcare.business"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){return a.currentSection="login",j.enableFooter(),j.setTitle("Login"),o.unauthenticated=!e.getCurrentUser().isAuthenticated,o.unauthenticated?(o.unauthenticated=!0,i.get("/login/context.json").then(function(a){return o.resetPasswordLink=a.data.changePasswordService,o.useMfa=a.data.useMfa,o.ready=!0,c.debug(o.resetPasswordLink),o.resetPasswordLink},function(){return o.resetPasswordLink=null,o.ready=!0,o.resetPasswordLink})):(o.ready=!1,d.go("home"))}function m(){o.isLoading=!0,e.authenticate(o.username,o.password,o.rememberMe).then(function(b){200===b.status?(c.debug("authenticate successful and retrieve user"),o.isLoading=!1,o.uiInitializing=!0,e.getUser().then(function(b){c.debug("User logged:"+b.data.username),h.pop("success",g.get("LOGIN_SUCCESSFUL_MESSAGE_TITLE"),g.get("LOGIN_SUCCESSFUL_MESSAGE_BODY",[b.data.username])),e.setCurrentUser(b.data),o.unauthenticated=!e.getCurrentUser().isAuthenticated,o.unauthenticated||j.disableFooter(),f.getOrganizations(),b.data.username&&(void 0!==a.$nextState?(c.debug("redirecting to "),c.debug(a.$nextState),d.go(a.$nextState.name,a.$nextState.params)):d.transitionTo("home"))},function(a){c.error(a),h.pop("danger","Authentication failed","Internal error")})):(o.isLoading=!1,n(b,e))},function(a){o.isLoading=!1,n(a,e)})}function n(a,b){c.error("authenticate failed"),401==a.status?h.pop("error",g.get("LOGIN_FAILED_MESSAGE_TITLE"),g.get("LOGIN_FAILED_MESSAGE_BODY_BADCREDENTIALS")):h.pop("error",g.get("LOGIN_FAILED_MESSAGE_TITLE"),g.get("LOGIN_FAILED_MESSAGE_BODY_INTERNALERROR")),b.removeCurrentUser()}var o=this;o.username="",o.password="",o.rememberMe=void 0,o.authenticate=m,o.unauthenticated=void 0,o.rights={},o.isLoading=!1,o.uiInitializing=!1,o.ready=!1,l()}angular.module("itcare.login").controller("LoginCtrl",["$rootScope","$scope","$log","$state","UserService","UserPreferencesService","TranslationService","toaster","$http","UIService",a])}(),function(){"use strict";angular.module("itcare.login").config(["$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider",function(a,b,c){a.state("login",{url:"/login",templateUrl:"/login/login.html",controllerAs:"login",controller:"LoginCtrl"})}])}(),function(){"use strict";angular.module("itcare.tickets",["itcare.business","ui.bootstrap","ngLodash","ngAnimate","textAngular","ngMessages","toaster"])}(),function(){"use strict";angular.module("itcare.tickets").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("support",{url:"/support",templateUrl:"/ticket/support-home.html",controller:"HomeSupportCtrl",controllerAs:"homeSupportCtrl",ncyBreadcrumb:{label:"{{translation.SUPPORT_OVERVIEW_TITLE}}"}}).state("tickets",{url:"/support/tickets?title&ticketNumbers&ticketTypes&serviceTypes&statuses&teams&creationPeriodStart&creationPeriodEnd&updatePeriodStart&updatePeriodEnd&resourceIds&serviceIds&raiseUser&size&page",templateUrl:"/ticket/tickets.html",reloadOnSearch:!1,controller:"TicketsCtrl",controllerAs:"ticketsCtrl",resolve:{ticketStatuses:["TicketService",function(a){return a.getTicketStatuses()}],ticketTypes:["TicketService",function(a){return a.getTicketTypes()}],defaultRaiseUser:["UserService",function(a){return a.currentUser.username}],userInfos:["UserService",function(a){return a.getUser()}]},data:{restricted:!0},ncyBreadcrumb:{label:"{{translation.MENU_TICKET_DASHBOARD_TITLE}}",parent:"support"}}).state("ticket_detail",{url:"/support/tickets/:ticketId",templateUrl:"/ticket/detail/ticket-detail.html",controller:"TicketDetailCtrl",controllerAs:"ticketCtrl",resolve:{ticketDetail:["TicketService","$stateParams",function(a,b){return a.getTicketById(b.ticketId)}]},data:{restricted:!0},ncyBreadcrumb:{label:"{{translation.ITCARE_SERVICE_TICKETING_SEARCH_DETAIL_TITLE}} #{{ticketCtrl.ticket.id}}",parent:"tickets"}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){function z(){a.currentSection="support",x.setTitle("Support"),fa.statuses=s.data,fa.types=t.data,fa.monitoringLoading=!1,fa.raiseUser=u,fa.filters={searchTitle:n.title?n.title:"",searchTicketNumber:n.ticketNumbers?n.ticketNumbers:"",searchTicketTypes:n.ticketTypes?n.ticketTypes.split(","):[],searchServiceTypes:n.serviceTypes?n.serviceTypes.split(","):[],searchStatusSelected:n.statuses?n.statuses.split(","):[],searchUserTeams:n.teams?n.teams.split(","):[],creationPeriodStart:n.creationPeriodStart?n.creationPeriodStart:"",creationPeriodEnd:n.creationPeriodEnd?n.creationPeriodEnd:"",updatePeriodStart:n.updatePeriodStart?n.updatePeriodStart:"",updatePeriodEnd:n.updatePeriodEnd?n.updatePeriodEnd:"",searchServiceSelected:n.serviceIds?n.serviceIds.split(","):[],searchResourceSelected:n.resourceIds?n.resourceIds.split(","):[],raiseUser:n.raiseUser?n.raiseUser:"",sort:n.sort?n.sort:"",direction:n.direction?n.direction:""},ca(),fa.selectedPage=void 0!==n.page?n.page:1,fa.selectedPageSize=void 0!==n.size?n.size:15,fa.pagination={currentPage:fa.selectedPage,totalItems:0,pageSize:fa.selectedPageSize,sort:ja,direction:ka},A(),B(),P(),Y(),c.$on("change-lang",function(a,c){b.debug("The change-lang event has been dealed and the form has been reinit ")})}function A(){fa.searchTypes()}function B(){fa.searchStatuses()}function C(){return g.getTicketStatuses().then(F,$),fa.defaultTypes}function D(){return g.getTicketTypes().then(E,$),fa.defaultStatuses}function E(a){angular.isDefined(a)&&200===a.status&&(fa.defaultStatuses=a.data.join(","))}function F(a){angular.isDefined(a)&&200===a.status&&(fa.defaultTypes=a.data)}function G(){return fa.filters.searchStatusSelected.join(",")}function H(){var a=[];return angular.forEach(fa.filters.searchUserTeams,function(b){void 0!==b.id?a.push(b.id):a.push(b)}),a.join(",")}function I(){return fa.filters.searchTicketTypes.join(",")}function J(){return fa.filters.searchTitle}function K(){return fa.filters.searchTicketNumber}function L(){return fa.filters.serviceTypes}function M(){return fa.filters.raiseUser}function N(){var a=[];return angular.forEach(fa.filters.searchServiceSelected,function(b){void 0===b.id?a.push(b):a.push(b.id)}),a.join(",")}function O(){var a=[];return angular.forEach(fa.filters.searchResourceSelected,function(b){void 0===b.id?a.push(b):a.push(b.id)}),a.join(",")}function P(){da(!1)}function Q(){o.go("tickets",{title:J(),ticketNumbers:K(),statuses:G(),ticketTypes:I(),teams:H(),creationPeriodStart:"",creationPeriodEnd:"",updatePeriodStart:"",updatePeriodEnd:"",serviceIds:N(),resourceIds:O(),raiseUser:M(),sort:ja,direction:ka,page:fa.selectedPage,size:fa.selectedPageSize},{reload:!1}),R(!1)}function R(a){if(!fa.searchIsLoading){var b=g.getTickets(J(),K(),I(),L(),H(),G(),"","","","",N(),O(),M(),ja,ka,fa.selectedPage-1,fa.selectedPageSize);return a||(fa.searchIsLoading=!0),b.then(Z,$),fa.tickets}}function S(a){U(),fa.filters.raiseUser=f.getCurrentUser().username,fa.filters.size=fa.selectedPageSize,fa.filters.searchStatusSelected=[a],Q(),T(!1)}function T(a){a||(fa.overviewLoading=!0),g.getTicketsOverview().then(function(a){fa.ticketsOverview=a.data,fa.overviewLoading=!1,c.updatedNotificationCount={toValidate:fa.ticketsOverview.toValidateCount,awaitingResponse:fa.ticketsOverview.awaitingResponseCount,total:fa.ticketsOverview.awaitingResponseCount+fa.ticketsOverview.toValidateCount},c.$emit("$notificationCount",c.updatedNotificationCount)},function(){fa.overviewLoading=!1})}function U(){fa.filters={searchTitle:"",searchTicketNumber:"",searchTicketTypes:[],searchUserTeams:[],searchServiceTypes:[],searchStatusSelected:[],creationPeriodStart:"",creationPeriodEnd:"",updatePeriodStart:"",updatePeriodEnd:"",serviceIds:"",resourceIds:"",raiseUser:"",sort:ja,direction:ka}}function V(a){o.go("ticket_detail",{ticketId:a.id})}function W(){fa.selectedPage=fa.pagination.currentPage,Q()}function X(a){fa.selectedPageSize=a,Q()}function Y(){fa.searchTickets(!1)}function Z(a){angular.isDefined(a)&&200===a.status&&(fa.tickets=a.data.content,fa.pagination={totalItems:a.data.totalElements,currentPage:a.data.number+1,pageSize:fa.selectedPageSize}),fa.searchIsLoading=!1,ca(),ba(!0),aa()}function $(a){b.debug(angular.uppercase(a)),400===a.status&&j.pop("error",l.get("error.client.title"),l.get("error.client.400")),fa.searchIsLoading=!1}function _(){i.open({animation:!0,templateUrl:"/ticket/ticket-search-filter.html",controller:"TicketSearchFilterCtrl",controllerAs:"newFilter",size:"lg",backdrop:"static",keyboard:!0}).result.then(function(a){fa.filters.searchTitle=a.filters.searchTitle,fa.filters.searchTicketNumber=a.filters.searchTicketNumber,fa.filters.searchUserTeams=a.filters.searchUserTeams,fa.filters.searchTicketTypes=a.filters.searchTicketTypes,fa.filters.searchStatusSelected=a.filters.searchStatusSelected,fa.filters.raiseUser=a.filters.raiseUser,fa.filters.searchServiceSelected=a.filters.searchServiceSelected,fa.filters.searchResourceSelected=a.filters.searchResourceSelected,Q(),d.trackEvent("Support","Search")},function(){b.debug("Modal dismissed at: "+new Date)})}function aa(){fa.refreshCountdown=fa.refreshTimeSeconds,fa.refreshCountdownGraph={data:[fa.refreshTimeSeconds-fa.refreshCountdown,fa.refreshCountdown],labels:["A","B"]},void 0!==ia&&q.cancel(ia),ia=q(function(){fa.refreshCountdown=fa.refreshCountdown-1,fa.refreshCountdownGraph={data:[fa.refreshTimeSeconds-fa.refreshCountdown,fa.refreshCountdown],labels:["A","B"]}},6e4,fa.refreshTimeSeconds)}function ba(a){(void 0===ga||a)&&(void 0!==ga&&p.cancel(ga),void 0!==ha&&p.cancel(ha),b.debug("Initializing refresh..."),ha=p(function(){da(!0)},6e4*fa.refreshTimeSeconds),c.$on("$destroy",function(){p.cancel(ha)}),ga=p(function(){Q()},6e4*fa.refreshTimeSeconds),c.$on("$destroy",function(){p.cancel(ga)}))}function ca(){var a="";if(fa.filters.raiseUser.length>0&&(a+="<strong>"+w.get("ITCARE_SERVICE_TICKETING_FILTER_RAISE_USER_SUMMARY")+"</strong>: ",a+=fa.filters.raiseUser),fa.filters.searchStatusSelected.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+w.get("STATUSES")+"</strong>: ",a+=fa.filters.searchStatusSelected.join(" "+w.get("OR").toLowerCase()+" ")),fa.filters.searchTicketTypes.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+w.get("ITCARE_SERVICE_TICKETING_FILTER_TYPE_SUMMARY")+"</strong>: ",a+=fa.filters.searchTicketTypes.join(" "+w.get("OR").toLowerCase()+" ")),fa.filters.searchUserTeams.length>0){""!==a&&(a+=" - ");var b=[];angular.forEach(fa.filters.searchUserTeams,function(a){void 0!==a.id?b.push(String(a.id)):b.push(String(a))});var c=v.data.teams.filter(function(a){return b.indexOf(String(a.id))>-1}),d=[];angular.forEach(c,function(a){d.push(a.name)}),d.length>0&&(a+="<strong>"+w.get("ITCARE_SERVICE_TICKETING_FILTER_TEAM_SUMMARY")+"</strong>: ",a+=d.join(" "+w.get("OR").toLowerCase()+" "))}fa.filters.searchTicketNumber.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+w.get("ITCARE_SERVICE_TICKETING_FILTER_TCK_NUMBER_SUMMARY")+"</strong>: ",a+=fa.filters.searchTicketNumber),fa.filters.searchTitle.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+w.get("ITCARE_SERVICE_TICKETING_FILTER_TCK_TITLE_SUMMARY")+"</strong>: ",a+=fa.filters.searchTitle),fa.filtersSummary=a}function da(a){a||(fa.overviewLoading=!0),g.getTicketsOverview().then(function(a){fa.ticketsOverview=a.data,fa.overviewLoading=!1},function(){fa.overviewLoading=!1})}function ea(){y.openModal(),d.trackEvent("Support","Ticket Creation Start Wizard","Support Dashboard")}var fa=this;fa.ui=void 0,fa.stateName="tickets",fa.pageSizesAvailable=[15,30,50,100],fa.selectedPageSize=30,fa.refreshTimeSeconds=5,fa.selectedPage=1,fa.displayServices=!1,fa.truncateOutput=!0,fa.searchIsLoading=!1,fa.overviewLoading=!0,fa.pagination={},fa.ticketsOverview={},fa.tickets=[],fa.defaultTypes=[],fa.defaultStatuses=[],fa.refreshCountdown=void 0,fa.refreshCountdownGraph={data:[],labels:[]};var ga=void 0,ha=void 0,ia=void 0;fa.searchTickets=R,fa.changePage=W,fa.selectPageSize=X,fa.searchTypes=C,fa.searchStatuses=D,fa.goToTicket=V,fa.createSupportTicket=ea,fa.filterResults=_,fa.filterMyTicketStatus=S;var ja="CreationDate",ka="desc",Y=Y,$=$,Z=Z,A=A,P=P,B=B,G=G,I=I,H=H,J=J,K=K,L=L,M=M,N=N,O=O;z(),fa.suggestTicketsPromise=function(a){return g.suggest(a).then(function(a){return a.data})},fa.selectTicket=function(a,c,e,f){b.debug("selected ticket : "+a.id+"/"+a.title),o.go("ticket_detail",{ticketId:a.id}),d.trackEvent("Support","Suggest Search")}}angular.module("itcare.tickets").controller("TicketsCtrl",["$rootScope","$log","$scope","Analytics","UserPreferencesService","UserService","TicketService","CiService","$uibModal","toaster","translationProvider","errorProvider","ConfStateUiView","$stateParams","$state","$timeout","$interval","lodash","ticketStatuses","ticketTypes","defaultRaiseUser","userInfos","TranslationService","UIService","CreateTicketService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){return a.currentSection="support",w.user=m.getCurrentUser(),j.disableFooter(),j.setTitle("Support - Dashboard"),w.ui={colors:j.colors},p(),q(),w.overview}function p(){d.get("/assets/agenda/agenda.json").then(function(a){angular.forEach(a.data,function(a){moment().month()==moment(a.startsAt).month()&&moment().year()==moment(a.startsAt).year()&&w.countEvent++})})}function q(){w.ticketsLoading=!0,k.getTicketsOverview().then(function(a){w.ticketsOverview=a.data,w.ticketsLoading=!1},function(){w.ticketsLoading=!1})}function r(){t(),f.go("tickets")}function s(a){u(a)}function t(){k.getTicketsOverview().then(function(a){b.updatedNotificationCount={toValidate:a.data.toValidateCount,awaitingResponse:a.data.awaitingResponseCount,total:a.data.awaitingResponseCount+a.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount)})}function u(a){k.getTicketsOverview().then(function(c){b.updatedNotificationCount={toValidate:c.data.toValidateCount,awaitingResponse:c.data.awaitingResponseCount,total:c.data.awaitingResponseCount+c.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount),f.go("tickets",{raiseUser:w.user.username,statuses:[a]})})}function v(){l.openModal(),n.trackEvent("Support","Ticket Creation Start Wizard","Home")}var w=this;w.user={},w.ticketsOverview={},w.ticketsLoading=!0,w.countEvent=0,w.createSupportTicket=v,w.goToTicketing=r,w.filterMyTicketStatus=s,o(),a.$on("$ticketOverviewCount",function(a,b){return w.ticketsOverview.toValidateCount=b.toValidate,w.ticketsOverview.awaitingResponseCount=b.awaitingResponse,w.ticketsOverview.inProgressCount=b.inProgress,w.ticketsOverview})}angular.module("itcare.tickets").controller("HomeSupportCtrl",["$rootScope","$scope","lodash","$http","$log","$state","$filter","UserPreferencesService","TranslationService","UIService","TicketService","CreateTicketService","UserService","Analytics",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){U.filters.searchTicketNumber=a}function o(){U.addedTicketNumberFilter="",U.filters.searchTicketNumber=""}function p(a){U.filters.searchTitle=a}function q(){U.addedTicketTitleFilter="",U.filters.searchTitle=""}function r(a){U.filters.raiseUser=a}function s(){U.addedTicketUserFilter="",U.filters.raiseUser=""}function t(a,b,c,d){U.filters.searchStatusSelected.push(a),U.searchStatusPopoverOpen=!1}function u(a){var b=U.filters.searchStatusSelected.indexOf(a);b>-1&&U.filters.searchStatusSelected.splice(b,1)}function v(a,b,c,d){U.filters.searchTicketTypes.push(a),U.searchTypePopoverOpen=!1}function w(a){var b=U.filters.searchTicketTypes.indexOf(a);b>-1&&U.filters.searchTicketTypes.splice(b,1)}function x(){var a=U.defaultStatuses,b=[];return angular.forEach(a,function(a){-1==U.filters.searchStatusSelected.indexOf(a)&&b.push(a)}),b}function y(){var a=U.defaultTypes,b=[];return angular.forEach(a,function(a){-1==U.filters.searchTicketTypes.indexOf(a)&&b.push(a)}),b}function z(){var a=U.teams,b=[];return angular.forEach(a,function(a){-1==U.filters.searchUserTeams.indexOf(a)&&b.push(a)}),b}function A(a,b,c,d){U.filters.searchUserTeams.push(a),U.searchTeamPopoverOpen=!1}function B(a){var b=U.filters.searchUserTeams.indexOf(a);b>-1&&U.filters.searchUserTeams.splice(b,1)}function C(a){return k.search(a).then(function(a){return a.data})}function D(a,b,c,d){"service"===a.resourceType?U.filters.searchServiceSelected.push(a):U.filters.searchResourceSelected.push(a),U.searchServicePopoverOpen=!1,U.qServices=""}function E(a){var b=U.filters.searchServiceSelected.indexOf(a);b>-1&&U.filters.searchServiceSelected.splice(b,1)}function F(a){var b=U.filters.searchResourceSelected.indexOf(a);b>-1&&U.filters.searchResourceSelected.splice(b,1)}function G(){U.searchTicketTypes()}function H(){U.searchTicketStatuses()}function I(){U.searchUserTeams()}function J(){return m.getTicketTypes().then(P,Q),U.defaultTypes}function K(){return m.getTicketStatuses().then(O,Q),U.defaultStatuses}function L(){return l.getUser().then(M,N),U.teams}function M(a){angular.isDefined(a)&&200===a.status&&(U.teams=a.data.teams,angular.forEach(U.teams,function(a){V[a.id]={id:a.id,name:a.name}}),c.teams&&(U.filters.searchUserTeams=[],angular.forEach(c.teams.split(","),function(a){if(void 0!==V[a]){h.debug(V[a]),U.filters.searchUserTeams.push(V[a]);var b=U.teams.map(function(a){return a.id}).indexOf(V[a].id);U.teams.splice(b,1)}})))}function N(a){U.teams=[]}function O(a){angular.isDefined(a)&&200===a.status&&(U.defaultStatuses=a.data)}function P(a){angular.isDefined(a)&&200===a.status&&(U.defaultTypes=a.data)}function Q(a){h.debug(angular.uppercase(a)),400===a.status&&e.pop("error",errorProvider.get("error.client.title"),errorProvider.get("error.client.400")),U.searchIsLoading=!1}function R(){g.close(U)}function S(){U.filters={searchTitle:c.title?c.title:"",searchTicketNumber:c.ticketNumbers?c.ticketNumbers:"",searchTicketTypes:c.ticketTypes?c.ticketTypes.split(","):[],searchUserTeams:c.teams?c.teams.split(","):[],searchStatusSelected:c.statuses?c.statuses.split(","):[],searchServiceSelected:[],searchResourceSelected:[],raiseUser:c.raiseUser?c.raiseUser:""},G(),H(),I()}function T(){g.dismiss("cancel")}var U=this;U.addedTicketNumberFilter="",U.addedTicketTitleFilter="",U.addedTicketUserFilter="",U.defaultTypes=[],U.defaultStatuses=[],U.teams=[];var V={};U.cancel=T,U.addTicketNumberFilter=n,U.removeTicketNumberFilter=o,U.addUserFilter=r,U.removeUserTitle=s,U.addTicketTitleFilter=p,U.removeTicketTitle=q,U.addStatus=t,U.removeStatus=u,U.addType=v,U.removeType=w,U.searchTeams=z,U.addTeam=A,U.removeTeams=B,U.removeServiceFilter=E,U.removeResourceFilter=F,U.addServiceFilter=D,U.searchStatus=x,U.searchTypes=y,U.searchServices=C,U.searchTicketTypes=J,U.searchTicketStatuses=K,U.searchUserTeams=L,U.changeSearch=R;var H=H,G=G,I=I,Q=Q,M=M;S()}angular.module("itcare.tickets").controller("TicketSearchFilterCtrl",["$scope","$state","$stateParams","$timeout","toaster","$interval","$uibModalInstance","$log","lodash","TranslationService","CiService","UserService","TicketService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){a.currentSection="tickets",z.ticket=m.data,t(),s(),r(),o.setTitle("Ticket Detail : "+z.ticket.id)}function q(){c.go("tickets",{raiseUser:g.currentUser.username})}function r(){var a="";return k.find(k.reverse(z.ticket.events),function(b){"RESOLVE"===b.type&&(a=b.userlogin.split("\\")[1])}),"TO_VALIDATE"===z.ticket.status&&(g.currentUser.username==a?z.canCloseTicket=!1:z.canCloseTicket=!0),z.canCloseTicket}function s(){if(null!=z.ticket.serviceId){z.ticketGlobalServiceUploading=!0;var a=h.getServiceDetailNoViewByGlobalServiceId(z.ticket.serviceId,{ignoreLoadingBar:!0});a.then(function(a){200!==a.status?d.error("Failed to add retrieve global service"):(z.ticketGlobalServiceUploading=!1,z.ticketGlobalService=a.data)},function(){d.error("Failed to add retrieve global service"),z.ticketGlobalServiceUploading=!1})}if(null!=z.ticket.resourceId)if(isNaN(z.ticket.resourceId))z.ticketResource=z.ticket.resourceId,z.ticketResourceType="loadbalancer";else{var a=h.getInstanceDetailNoViewById({instanceId:z.ticket.resourceId},!0);z.ticketResourceUploading=!0,a.then(function(a){200!==a.status?d.error("Failed to add retrieve instance"):(z.ticketResourceUploading=!1,z.ticketResource=a.data.name,z.ticketResourceType="instance")},function(){d.error("Failed to add retrieve instance"),z.ticketResourceUploading=!1})}}function t(){"AWAITING_RESPONSE"===z.ticket.status?z.informationRequestEvent=k.find(k.reverse(z.ticket.events),function(a){return"INFORMATION_REQUEST"===a.type}):z.informationRequestEvent=void 0,"TO_VALIDATE"===z.ticket.status?z.resolveEvent=k.find(k.reverse(z.ticket.events),function(a){return"RESOLVE"===a.type}):z.resolveEvent=void 0}function u(){f.getTicketsOverview().then(function(a){b.updatedNotificationCount={toValidate:a.data.toValidateCount,awaitingResponse:a.data.awaitingResponseCount,total:a.data.awaitingResponseCount+a.data.toValidateCount},b.$emit("$notificationCount",b.updatedNotificationCount)})}function v(a){i.open({animation:!0,templateUrl:"/ticket/detail/actions/ticket-action-add-actions.html",controller:"TicketAddActionCtrl",controllerAs:"newTckAction",size:"lg",backdrop:"static",keyboard:!0,resolve:{ticketId:function(){return z.ticket.id},ticketEventType:function(){return a}}}).result.then(function(a){w()},function(){d.debug("Modal dismissed at: "+new Date)})}function w(){f.getTicketById(z.ticket.id).then(function(a){z.ticket=a.data,t(),u()})}function x(a,b){if(a.length>0){var c=!1,d=[];z.attachmentsUploading=!0;var g=function(a,b){return f.addAttachment(a,b)};(function(a){return a.reduce(function(a,b){return a.then(function(a){return void 0!=a&&d.push(a.data),g(z.ticket.id,b)},function(){c=!0})},e.when(void 0))})(a).then(function(a){d.push(a.data),angular.forEach(d,function(a){z.ticket.attachments.push(a)}),z.attachmentsUploading=!1,l.pop("success",n.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ACTION"),n.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_SUCCESS"))},function(){z.attachmentsUploading=!1})}else b.length>0&&"maxSize"==b[0].$error&&l.pop("error",n.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ACTION"),n.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ERROR_MAX_SIZE").format([b[0].name,b[0].$errorParam]))}function y(a){f.downloadAttachment(z.ticket.id,a)}var z=this;z.id="",z.events=[],z.ticket=void 0,z.attachmentsUploading=!1,z.canCloseTicket=!1,z.selectAttachments=x,z.downloadAttachment=y,z.showTicketActionsModal=v,z.backToDashboard=q,z.informationRequestEvent=void 0,z.resolveEvent=void 0,z.ticketGlobalService=null,z.ticketGlobalServiceUploading=!1,z.ticketResource=null,z.ticketResourceType=null,z.ticketResourceUploading=!1,p()}angular.module("itcare.tickets").controller("TicketDetailCtrl",["$rootScope","$scope","$state","$log","$q","TicketService","UserService","CiService","$uibModal","$sce","lodash","toaster","ticketDetail","TranslationService","UIService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){J.steps=K,J.currentStep="TICKET_TYPE",void 0!=o&&(J.resourceIsFilled=void 0!=o.id,"instance"==o.type||"loadbalancer"==o.type?(J.ticket.resourceId=o.id,J.ticket.serviceId=o.serviceId):J.ticket.serviceId=o.id,J.qResource=o.serviceName)}function r(a,b){return d.debug(""!=b&&Object.values(a).indexOf(b)>-1),""!=b&&Object.values(a).indexOf(b)>-1}function s(a){if(J.ticket.type=a,J.ticket.type===J.REQUEST?J.steps=L:J.steps=M,f(function(){J.next()},200),J.ticket.type===J.REQUEST){J.loading=!0;i.getSupportCatalog(J.ticket.type).then(function(a){J.supportCatalog=a.data,u(),J.loading=!1},function(a){J.loading=!1,F()})}}function t(a){J.ticket.urgency=a,f(function(){J.next()},200),J.loading=!0,i.getSupportCatalog(J.ticket.type).then(function(a){J.supportCatalog=a.data,u(),J.loading=!1},function(a){J.loading=!1,F()})}function u(){J.categories=[],angular.forEach(J.supportCatalog,function(a){if(a.supportCategoryEn&&(a.supportCategoryEn=a.supportCategoryEn.join("-")),a.supportCategoryFr&&(a.supportCategoryFr=a.supportCategoryFr.join("-")),angular.forEach(["supportCategory","supportDescription","supportTitle","supportPrerequirement"],function(b){a[b]=v(a,b)}),a.supportCategory){var b=a.supportCategory,c=l.find(J.categories,function(a){return a.name===b});void 0===c&&(c={name:b,items:[]},J.categories.push(c)),c.items.push(a)}else{a.supportCategory="Hors catalogue",a.supportCategoryFr="Hors catalogue",a.supportCategoryEn="Out of catalogue";var b=a.supportCategory,c=l.find(J.categories,function(a){return a.name===b});void 0===c&&(c={name:b,items:[]},J.categories.push(c)),c.items.push(a)}})}function v(a,c){if(void 0===a||void 0===c||null===c||""===c.trim())return"";var d=c+"En",e=c+"Fr";"fr"===b.lang&&(d=c+"Fr",e=c+"En");var f=a[d],g=a[e];return void 0===f||null===f||""===f.trim()?void 0===g||null===g||""===g.trim()?"":g:f}function w(a){n.open({controller:"CatalogueDetailController",controllerAs:"vm",templateUrl:"ticket/creation/detail/catalogue-details.html",size:"lg",resolve:{detail:function(){return a}}}).result.then(function(){},function(){})}function x(a){J.ticket.requestTypeId=a.id,J.ticket.supportTitle=a.supportTitle,J.ticket.supportDescription=a.supportDescription,J.loading=!0,i.getSupportCatalogItem(a.id).then(function(a){a.data.formYamlDefinition?p.getFormInstanceFromYaml(a.data.formYamlDefinition,b.lang).then(function(a){J.form=a,J.loading=!1,E()},function(a){J.form=void 0,J.loading=!1,d.error(a),E()}):(J.form=void 0,J.loading=!1,E())},function(){J.loading=!1})}function y(){if(void 0!==J.form){var a="";angular.forEach(J.form.fields,function(b){b.visible&&("section"==b.type?a+=""+(b.label?b.label:b.id):a+="- "+(b.label?b.label:b.id)+" : ","attachment"===b.type?(b.value||"object"==typeof b.value)&&(a+=b.value.name,J.attachments.push(b.value)):void 0!==b.value&&(a+=b.value),a+="\n")}),J.ticket.body=a}}function z(a){J.attachments.splice(a,1)}function A(a,b){b.length>0&&"maxSize"==b[0].$error&&h.pop("error",j.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ACTION"),j.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ERROR_MAX_SIZE").format([b[0].name,b[0].$errorParam])),angular.forEach(a,function(a){J.attachments.push(a)})}function B(){switch(J.currentStep){case"TICKET_TYPE":return void 0!==J.ticket.type;case"INCIDENT_URGENCY":return void 0!==J.ticket.urgency;case"INCIDENT_TYPE":case"REQUEST_TYPE":return void 0!==J.ticket.requestTypeId;case"TICKET_FILL":return void 0===J.form?J.ticket.title&&J.ticket.body:J.form&&J.ticket.title&&J.form.isValid();default:return!1}}function C(){return!0}function D(a){J.currentStep}function E(){switch(J.currentStep){case"TICKET_TYPE":J.ticket.type===J.INCIDENT?J.currentStep="INCIDENT_URGENCY":J.currentStep="REQUEST_TYPE";break;case"INCIDENT_URGENCY":J.currentStep="INCIDENT_TYPE";break;case"REQUEST_TYPE":case"INCIDENT_TYPE":J.currentStep="TICKET_FILL";break;case"TICKET_FILL":y(),J.ticketDescription=J.ticket.body,J.currentStep="APP_WIZARD_STEP_SYNTHESIS";break;case"APP_WIZARD_STEP_SYNTHESIS":J.currentStep="CONFIRMATION"}J.gotoStep(J.currentStep)}function F(){switch(J.currentStep){case"INCIDENT_URGENCY":J.currentStep="TICKET_TYPE";break;case"INCIDENT_TYPE":J.currentStep="INCIDENT_URGENCY";break;case"REQUEST_TYPE":J.currentStep="TICKET_TYPE";break;case"TICKET_FILL":J.ticket.type===J.INCIDENT?J.currentStep="INCIDENT_TYPE":J.currentStep="REQUEST_TYPE";break;case"APP_WIZARD_STEP_SYNTHESIS":J.currentStep="TICKET_FILL"}D(J.currentStep)}function G(){J.ticketCreationLoading=!0,J.ticket.body=J.ticketDescription,void 0!==J.ticket.ccMailRecipients&&""!==J.ticket.ccMailRecipients?J.ticket.ccMailRecipients=J.ticket.ccMailRecipients.split(";"):J.ticket.ccMailRecipients=[],i.createTicket(J.ticket).then(function(a){if(J.ticketCreated=a.data,g.trackEvent("Support","Ticket Creation Completed"),J.attachments.length>0){var b=!1,d=function(a,b){return i.addAttachment(a,b)};(function(a){return a.reduce(function(a,c){return a.then(function(){return d(J.ticketCreated.id,c)},function(){b=!0})},c.when(""))})(J.attachments).then(function(){J.ticketCreationLoading=!1,J.errorsInAddingAttachments=b,E()},function(){J.errorsInAddingAttachments=b,J.ticketCreationLoading=!1,E()})}else J.ticketCreationLoading=!1,J.errorsInAddingAttachments=!1,E()},function(a){J.ticketCreationLoading=!1,J.errorsInAddingAttachments=!1,h.pop("error","Error","Support request could not be created, try again."),d.error("unable to create ticket "+a)})}function H(){m.dismiss("cancel")}function I(){m.close(J.ticketCreated)}var J=this;J.loaded=!1,J.modelWizard=void 0,J.isCurrentFormValid=!1,J.resourceIsFilled=!1,J.steps=[],J.wizardForm={},J.cancel=H,J.next=E,J.previous=F,J.submit=G,J.close=I,J.gotoStep=D,J.previousAuthorized=C,J.nextAuthorized=B,J.selectTicketType=s,J.foo=r,J.selectIncidentUrgency=t,J.selectItemCatalog=x,J.displayCatalogueDetailHelp=w,J.ticket={type:void 0,requestTypeId:void 0,supportTitle:void 0,supportDescription:void 0,urgency:void 0,resourceId:void 0,serviceId:void 0,title:void 0,body:void 0,ccMailRecipients:""},J.ticketDescription=void 0,J.form=void 0,J.attachments=[],J.deleteAttachment=z,J.selectAttachments=A,J.ticketForm={},J.INCIDENT="Incident",J.REQUEST="Request",J.DEFAULT_TCK="STD_TCK",J.supportCatalog=void 0,J.loading=!1,J.ticketCreationLoading=!1;var K=[{label:"TICKET_TYPE",icon:"fa-adjust"},{label:"TICKET_FILL",icon:"fa-pencil-square-o"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-users"},{label:"CONFIRMATION",icon:"fa-check"}],L=[{label:"TICKET_TYPE",icon:"fa-adjust"},{label:"REQUEST_TYPE",icon:"fa-list-ul"},{label:"TICKET_FILL",icon:"fa-pencil-square-o"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-users"},{label:"CONFIRMATION",icon:"fa-check"}],M=[{label:"TICKET_TYPE",icon:"fa-adjust"},{label:"INCIDENT_URGENCY",icon:"fa-exclamation-circle"},{label:"INCIDENT_TYPE",icon:"fa-list-ul"},{label:"TICKET_FILL",icon:"fa-pencil-square-o"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-users"},{label:"CONFIRMATION",icon:"fa-check"}];q(),$(document).ready(function(){if("REQUEST_TYPE"==$.urlParam("step")?(q(),J.currentStep="TICKET_TYPE",J.ticket.type=J.REQUEST,s(J.REQUEST)):"INCIDENT_URGENCY"==$.urlParam("step")&&(q(),J.currentStep="TICKET_TYPE",J.ticket.type=J.INCIDENT,s(J.INCIDENT),"ACTIVITY_OK"==$.urlParam("inc")?t("ACTIVITY_OK"):"ACTIVITY_DOWN"==$.urlParam("inc")?t("ACTIVITY_DOWN"):"ACTIVITY_DEGRADED"==$.urlParam("inc")&&t("ACTIVITY_DEGRADED")),null!=$.urlParam("item")&&0!=$.urlParam("item")){J.currentStep="TICKET_TYPE";var a={id:$.urlParam("item"),supportTitle:void 0};console.log("XXXYY: "+b.lang),x(a)}}),J.gotoTicket=function(a){e.go("ticket_detail",{ticketId:a}),J.close()},J.searchPromise=function(a){return k.search(a).then(function(a){var b=a.data;return angular.forEach(b,function(a){var c=b.indexOf(a);"LB_VSERVER"==a.type?a.type=j.get("LOADBALANCER"):"CI_GLOBAL_SERVICE"==a.type?a.type=j.get("SERVICE"):a.type=j.get("INSTANCE"),b[c]=a}),b})},J.selectResource=function(a,b,c,e){d.debug("selected resource : "+a.id+"/"+a.name+"/"+a.type),"service"==a.resourceType?(J.ticket.serviceId=a.id,J.ticket.resourceId=a.id):"loadbalancer"==a.resourceType?(J.ticket.resourceId=a.name,J.ticket.serviceId=a.serviceId):(J.ticket.resourceId=a.id,J.ticket.serviceId=a.serviceId)}}angular.module("itcare.tickets").controller("TicketCreationCtrl",["$scope","$rootScope","$q","$log","$state","$timeout","Analytics","toaster","TicketService","TranslationService","CiService","lodash","$uibModalInstance","$uibModal","resource","MFForm",a])}(),function(){"use strict";function a(a,b){var c={};return c.openModal=function(c){b.open({animation:!0,templateUrl:"/ticket/creation/create-ticket.modal.html",controller:"TicketCreationCtrl",controllerAs:"nt",size:"lg",backdrop:"static",keyboard:!0,resolve:{resource:c}}).result.then(function(b){a.debug("ticket created"),a.debug(b)},function(){a.debug("ticket dismissed")})},c}angular.module("itcare.business").factory("CreateTicketService",["$log","$uibModal",a])}(),function(){"use strict";function a(a,b,c,d){function e(){f.catalogue=d,b.debug(d)}var f=this;f.close=close,e(),a.ok=function(){c.close()}}angular.module("itcare.tickets").controller("CatalogueDetailController",["$scope","$log","$uibModalInstance","detail",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){p.typeAction=i}function n(){var a={type:i,details:p.comment,createdAt:null,username:k.getCurrentUser().username};l.createEvent(h,a).then(function(a){200!==a.status?f.debug("Failed to add note: "+a.status):(d.pop("success",j.get("ITCARE_SERVICE_TICKETING_ACTION_SUCCESS_TITLE_"+p.typeAction),j.get("ITCARE_SERVICE_TICKETING_ACTION_SUCCESS_BODY_"+p.typeAction)),e.close())},function(a){f.error("Failed to add note: "+a.statusText)})}function o(){e.dismiss("cancel")}var p=this;p.cancel=o,p.submit=n,p.typeAction="",m()}angular.module("itcare.tickets").controller("TicketAddActionCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","lodash","ticketId","ticketEventType","TranslationService","UserService","TicketService",a])}(),function(){"use strict";angular.module("itcare.services",["itcare.business","ui.bootstrap","ngLodash","ngAnimate","mgcrea.ngStrap.helpers.dimensions","mgcrea.ngStrap.helpers.debounce","mgcrea.ngStrap.affix","mgcrea.ngStrap.scrollspy","mgcrea.ngStrap","rzModule","angularMoment","toaster","ui.select","infinite-scroll"])}(),function(){"use strict";angular.module("itcare.services").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("services_detail",{url:"/services/:serviceId",templateUrl:"/services/detail/service-detail.html",controller:"ServiceDetailCtrl",controllerAs:"detailCtrl",abstract:!0,data:{restricted:!0},resolve:{serviceDetail:["CiService","$stateParams",function(a,b){return a.getServiceDetailByGlobalServiceId(b.serviceId)}]}}).state("services_detail.dashboard",{url:"",templateUrl:"/services/detail/service-detail-dashboard.html",controller:"ServiceDetailDashboardCtrl",controllerAs:"dashboardCtrl",resolve:{configurationData:["ChartService","$stateParams",function(a,b){return a.getConfiguration(b.serviceId,"service")}]},ncyBreadcrumb:{label:"Service {{detailCtrl.service.name}}",parent:"compute"}}).state("services_detail.indicator",{url:"/indicators/:indicatorId",templateUrl:"/services/detail/service-detail-indicator.html",controller:"ServiceDetailIndicatorCtrl",controllerAs:"app",resolve:{indicatorData:["IndicatorService","$stateParams","$log",function(a,b,c){return a.getIndicator(b.serviceId,b.indicatorId,"definition,live-availability")}],availabilityThisMonth:["IndicatorService","$stateParams","$log",function(a,b,c){var d=moment();return a.getIndicatorAvailability(b.serviceId,b.indicatorId,d.year(),d.month()+1)}],configurationData:["ChartService","$stateParams",function(a,b){return a.getConfigurationByIndicator(b.serviceId,b.indicatorId)}]},ncyBreadcrumb:{label:"{{app.indicator.name}}",parent:"services_detail.dashboard"}}).state("services_detail.cluster",{url:"/clusters/:clusterId",abstract:!0,templateUrl:"/services/detail/service-detail-cluster.html",controller:"ServiceDetailClusterCtrl",controllerAs:"clusterCtrl",params:{views:null},resolve:{clusterData:["CiService","$stateParams","$log",function(a,b,c){return c.debug("resolving detail.cluster"),a.getClusterDetailById(b)}]}}).state("services_detail.cluster.information",{url:"",templateUrl:"/services/detail/service-detail-cluster-information.html",controller:"ServiceDetailClusterInformationCtrl",controllerAs:"clusterInfoCtrl",ncyBreadcrumb:{label:"{{clusterInfoCtrl.cluster.name}}",parent:"services_detail.dashboard"}}).state("services_detail.instance",{url:"/instances/:instanceId",abstract:!0,templateUrl:"/services/detail/service-detail-instance.html",controller:"ServiceDetailInstanceCtrl",controllerAs:"instanceCtrl",params:{views:null},resolve:{instanceData:["CiService","$stateParams","$log",function(a,b,c){return c.debug("resolving detail.instance"),a.getInstanceDetailById(b)}]}}).state("services_detail.instance.information",{url:"",templateUrl:"/services/detail/service-detail-instance-information.html",controller:"ServiceDetailInstanceInformationCtrl",controllerAs:"instanceInfoCtrl",resolve:{configurationData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.instanceId,"instance","summary")}]},ncyBreadcrumb:{label:"{{instanceCtrl.instance.name}}",parent:"services_detail.dashboard"}}).state("services_detail.instance.monitoring",{url:"/monitoring",templateUrl:"/services/detail/service-detail-instance-monitoring.html",controller:"ServiceDetailInstanceMonitoringCtrl",controllerAs:"instanceMonitoringCtrl",ncyBreadcrumb:{label:"{{translation.MONITORING}}",parent:"services_detail.instance.information"}}).state("services_detail.instance.performance",{url:"/performance?name&start&end",templateUrl:"/services/detail/service-detail-instance-performance.html",controller:"ServiceDetailInstancePerformanceCtrl",controllerAs:"perf",reloadOnSearch:!1,resolve:{configurationData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.instanceId,"instance")}]},ncyBreadcrumb:{label:"{{translation.APP_PERFORMANCE}}",parent:"services_detail.instance.information"}}).state("services_detail.loadbalancer",{url:"/loadbalancers/{url}",abstract:!0,templateUrl:"/services/detail/service-detail-loadbalancer.html",controller:"ServiceDetailLoadBalancerCtrl",controllerAs:"lb",resolve:{loadBalancerData:["CiService","$stateParams","$log",function(a,b,c){return c.debug("resolving detail.loadbalancer"),a.getLoadBalancerDetailByUrl(b.url,!1)}]}}).state("services_detail.loadbalancer.information",{url:"",templateUrl:"/services/detail/service-detail-loadbalancer-information.html",controller:"ServiceDetailLoadBalancerInformationCtrl",controllerAs:"lbInfoCtrl",resolve:{configurationLBData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.url,"loadbalancer","summary")}]},ncyBreadcrumb:{label:"{{translation.LOADBALANCER}} {{lb.loadBalancer.url}}",parent:"services_detail.dashboard"}}).state("services_detail.loadbalancer.monitoring",{url:"/monitoring",templateUrl:"/services/detail/service-detail-loadbalancer-monitoring.html",controller:"ServiceDetailLoadBalancerMonitoringCtrl",controllerAs:"lbMonitoringCtrl",ncyBreadcrumb:{label:"{{translation.MONITORING}}",parent:"services_detail.loadbalancer.information"}}).state("services_detail.loadbalancer.performance",{url:"/performance?name&start&end",templateUrl:"/services/detail/service-detail-loadbalancer-performance.html",controller:"ServiceDetailLoadBalancerPerformanceCtrl",controllerAs:"perf",reloadOnSearch:!1,resolve:{configurationLBData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.url,"loadbalancer")}]},ncyBreadcrumb:{label:"{{translation.APP_PERFORMANCE}}",parent:"services_detail.loadbalancer.information"}}).state("services_detail.hardware",{url:"/hardwares/:hardwareId",abstract:!0,templateUrl:"/services/detail/service-detail-hardware.html",controller:"ServiceDetailHardwareCtrl",controllerAs:"h",params:{hardwareId:null},resolve:{hardwareData:["CiService","$stateParams","$log",function(a,b,c){return c.debug("resolving detail.hardware"),a.getHardwareDetailById(b.hardwareId,!1)}]}}).state("services_detail.hardware.information",{url:"",templateUrl:"/services/detail/service-detail-hardware-information.html",controller:"ServiceDetailHardwareInformationCtrl",controllerAs:"hInfoCtrl",resolve:{configurationData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.hardwareId,"hardware","summary")}]},ncyBreadcrumb:{label:"{{translation.HARDWARE}} {{h.hardware.name}}",parent:"services_detail.dashboard"}}).state("services_detail.hardware.monitoring",{url:"/monitoring",templateUrl:"/services/detail/service-detail-hardware-monitoring.html",controller:"ServiceDetailHardwareMonitoringCtrl",controllerAs:"hardwareMonitoringCtrl",ncyBreadcrumb:{label:"{{translation.MONITORING}}",parent:"services_detail.hardware.information"}}).state("services_detail.hardware.performance",{url:"/performance?name&start&end",templateUrl:"/services/detail/service-detail-hardware-performance.html",controller:"ServiceDetailHardwarePerformanceCtrl",controllerAs:"perf",reloadOnSearch:!1,resolve:{configurationData:["ChartService","$stateParams","$log",function(a,b,c){return a.getConfiguration(b.hardwareId,"hardware")}]},ncyBreadcrumb:{label:"{{translation.APP_PERFORMANCE}}",parent:"services_detail.hardware.information"}})}])}(),function(){"use strict";angular.module("itcare.messages",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","toaster"])}(),function(){"use strict";function a(){return function(a){return"SENT"==a?"fa fa-fw fa-check text-success":"SEND_FAILED"==a||"INVALID_CREDENTIALS"==a||"UNKNOWN_ERROR"==a||"INVALID_REQUEST"==a||"LIMIT_REACHED"==a||"RECIPIENT_NOT_ALLOWED"==a||"LIMIT_REACHED"==a||"RECIPIENT_UNKNOWN"==a||"UNKNOWN"==a?"fa fa-fw fa-times text-danger":"PENDING"==a?"fa fa-fw fa-spin fa-refresh":void 0}}angular.module("itcare.messages").filter("messageStatusClass",a)}(),function(){"use strict";function MessagesCtrl($rootScope,$log,$scope,$state,Analytics,UserPreferencesService,UserService,MessagesService,CiService,IndicatorService,HelpService,$uibModal,lodash,moment,toaster,translationProvider,errorProvider,ConfStateUiView,$stateParams,vortextStatuses,vortextServices,TranslationService,UIService){function activate(){UIService.setTitle("Messages"),vm.stateName="message.search",vm.services=vortextServices.data,angular.forEach(vortextServices.data,function(a){vortextServicesMap[a.key]={id:a.id,name:a.name}}),vm.statuses=vortextStatuses.data,$stateParams.from&&$stateParams.to?vm.datesModel={startDate:moment.unix($stateParams.from),endDate:moment.unix($stateParams.to)}:vm.datesModel={startDate:moment().startOf("day"),endDate:moment().endOf("day")},$log.debug("vm.datesModel startDate "+vm.datesModel.startDate),$log.debug("vm.datesModel endDate "+vm.datesModel.endDate),isInArray(UserService.getCurrentUser().authorities,"VORTEXT_MANAGEMENT")&&(vm.canManageVortext=!0),vm.filters={searchPhoneNumber:$stateParams.phoneNumber?$stateParams.phoneNumber:"",searchStatusSelected:$stateParams.statuses?$stateParams.statuses.split(","):[],searchVortextServiceSelected:[]},$stateParams.services&&angular.forEach($stateParams.services.split(","),function(a){vm.filters.searchVortextServiceSelected.push(lodash.find(vm.services,function(b){return b.id==a}))}),vm.limitDefault=50,limit=50,$log.debug("init pagination["+$stateParams.page+"]"),vm.pagination={currentPage:void 0!==$stateParams.page?$stateParams.page:1,totalItems:0,pageSize:PAGE_SIZE},$log.debug("init pagination["+vm.pagination.currentPage+"]"),initStatus(),initSearch(),$scope.$on("change-lang",function(a,b){$log.debug("The change-lang event has been dealed and the form has been reinit ")})}function vortextStats(){MessagesService.getVortextStats().then(function(a){vm.vortextStatistics=a.data,vm.messagesOverviewLoading=!1})}function vortextStatus(){MessagesService.getVortextStatus().then(function(a){vm.serviceStatus=a.data,vm.defaultConfForIndicators={legend:[100*vm.serviceStatus.definition.availabilityWarn,100*vm.serviceStatus.definition.availabilityTarget],itemName:["% "+$rootScope.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY,"% "+$rootScope.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY],tooltip:!0,toolTipAction:void 0};var b=[];if($log.debug(vm.serviceStatus),vm.serviceStatus.monthlyAvailabilities.length>0)for(var c=0;c<vm.serviceStatus.monthlyAvailabilities.length;c++)$log.debug(vm.serviceStatus.monthlyAvailabilities[c]),b=b.concat(vm.serviceStatus.monthlyAvailabilities[c].availability);$log.debug(b),vm.mapMonths={data:IndicatorService.getAvailabilityCalHeatmap(b),options:{displayLegend:!1,cellPadding:1,cellSize:7,domainGutter:0,domainMargin:5,legend:vm.defaultConfForIndicators.legend,range:vm.serviceStatus.monthlyAvailabilities.length,tooltip:!1,domainLabelFormat:"%b",subDomainTextFormat:"",subDomainTitleFormat:{empty:"",filled:""},toolTipAction:void 0,onClick:function(a,b){var c=null;angular.forEach(vm.serviceStatus.monthlyAvailabilities,function(b){moment(b.availability[0].date).month()==a.getMonth()&&(c=a.getMonth())}),null!=c&&selectAvailabilityMonth(c+1)}}},selectAvailabilityMonth((new Date).getMonth()+1)})}function selectAvailabilityMonth(a){$log.debug("selecting month "+a),angular.forEach(vm.serviceStatus.monthlyAvailabilities,function(b){var c=moment(b.availability[0].date);c.month()==a-1&&(vm.selectedAvailability=b,vm.selectedAvailabilityDate=new Date(c.year(),c.month()))}),highlightAvailabilityMonth(a)}function highlightAvailabilityMonth(a){vm.customStyle=".cal-year .m_"+a+" .domain-background { fill: #6f6f6f; } .cal-year .m_"+a+" .graph-label { fill: #efefef; }"}function searchMessages(a){if($log.debug("search launched"),!vm.searchIsLoading){if(vm.isFormValid()){resetErrorsInForm();vm.limitDefault;vm.messages=[];var b=moment(vm.datesModel.startDate).utc().format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),c=moment(vm.datesModel.endDate).utc().format("YYYY-MM-DDTHH:mm:ss.SSSZZ");vm.limitSearch=limit;var d=MessagesService.getMessagesWithPagination(getSearchVortextServiceSelected(),getSearchVortextStatusSelected(),b,c,vm.filters.searchPhoneNumber,vm.pagination.currentPage-1,vm.limitSearch);vm.searchIsLoading=!0,d.then(callBackSearch,callBackSearchError)}return vm.messages}}function changePage(){$log.debug(vm.pagination.currentPage),changeSearch()}function changeSearch(){Analytics.trackEvent("Messages","Search"),$state.go("messages",{services:getSearchVortextServiceSelected(),statuses:getSearchVortextStatusSelected(),from:vm.datesModel.startDate.unix(),to:vm.datesModel.endDate.unix(),phoneNumber:vm.filters.phoneNumber},{}),searchMessages()}function isFormValid(){return!0}function isInArray(a,b){return a.indexOf(b)>-1}function initSearch(){$log.debug("init search"),vm.searchMessages(!0)}function initStatus(){vm.vortextStatus(),vm.vortextStats()}function getStats(){MessagesService.getMessagesWithPagination("","",from,to,"",vm.pagination.currentPage-1,20,!0).then(function(a){var b={chart:{type:"discreteBarChart",height:200,x:function(a){return a.label},y:function(a){return a.value},showControls:!1,showLegend:!1,showValues:!0,staggerLabels:!0,valueFormat:function(a){return d3.format("d")(a)},duration:300,xAxis:{showMaxMin:!1},showXAxis:!0,showYAxis:!1}},c={};angular.copy(b,c),c.chart.x=function(a){return TranslationService.get("ITCARE_MESSAGES_"+a.label)},vm.messagesChart={options:c,data:[{key:"Messages",values:[]}]},angular.forEach(a.data.messagesDistribution,function(a,b){vm.messagesChart.data[0].values.push({label:b,value:a})})})}function resetErrorsInForm(){angular.isDefined(vm.formSearchService)&&(vm.formSearchService.searchPhoneNumber.$invalid=!1)}function displayErrorsInForm(errors){angular.forEach(errors,function(value,key){var codeMessage=errorProvider.get(value.code),errorMessage=codeMessage;value.on.length&&(errorMessage=codeMessage.replace("%s",value.on),eval("vm.formSearchService."+value.on+".$invalid = true"),eval("vm.formSearchService."+value.on+".$error = errorMessage"),$log.debug("There are new error: "+errorMessage))})}function callBackSearchError(a){$log.debug(angular.uppercase(a)),400===a.status&&(toaster.pop("error",errorProvider.get("error.client.title"),errorProvider.get("error.client.400")),displayErrorsInForm(a.data)),vm.searchIsLoading=!1}function callBackSearch(a){if(angular.isDefined(a)&&200===a.status){var b=a.data.content,c=0;if(vm.resultTotalItems=a.data.totalElements,null!=b&&(c=b.length),vm.messages=[],c>0)for(var d=0;d<b.length;d++){var e=vortextServicesMap[b[d].accountId]||null;e&&(b[d].service={id:e.id,name:e.name}),b[d].lastSentTryAt||(b[d].lastSentTryAt=b[d].statusCheckedAt),"SENT"!=b[d].status||b[d].deliveryDurationSeconds||(b[d].deliveryDurationSecondsFallback=moment(parseInt(b[d].statusCheckedAt)).diff(moment(parseInt(b[d].requestedAt)),"seconds")),vm.messages.push(b[d])}vm.pagination={totalItems:a.data.totalElements,currentPage:a.data.number+1,pageSize:PAGE_SIZE},$log.debug(vm.pagination)}vm.searchIsLoading=!1}function getSearchVortextServiceSelected(){var a=[];return angular.forEach(vm.filters.searchVortextServiceSelected,function(b){a.push(b.id)}),a.join(",")}function getSearchVortextStatusSelected(){return vm.filters.searchStatusSelected.join(",")}function selectItem(a){a.ticked=!a.ticked}function displayHelp(a){$uibModal.open({controller:"MessageDetailController",controllerAs:"vm",templateUrl:"messages/detail/message-details.html",size:"lg",resolve:{detail:function(){return a}}}).result.then(function(){},function(){})}function openMessagesSubscriptionDialog(){$uibModal.open({animation:$scope.animationsEnabled,templateUrl:"/messages/messages-vortext-subscription.html",controller:"MessagesSubscriptionCtrl",controllerAs:"newSubscribe",size:"lg",backdrop:"static",keyboard:!0}).result.then(function(){toaster.pop("success",TranslationService.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_TITLE"),TranslationService.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_BODY"))},function(){$log.debug("Modal dismissed at: "+new Date)})}$rootScope.currentSection="messages";var vm=this,vm=this;vm.formSearchService,vm.services=[],vm.statuses=[],vm.searchIsLoading=!1,vm.messagesOverviewLoading=!0,vm.canManageVortext=!1,vm.messages=[],vm.ui=void 0,vm.stateName="messages_search",vm.pagination={},vm.serviceStatus={},vm.vortextStatistics={},vm.messagesChart={},vm.searchMessages=searchMessages,vm.isFormValid=isFormValid,vm.selectItem=selectItem,vm.displayHelp=displayHelp,vm.vortextStatus=vortextStatus,vm.vortextStats=vortextStats,vm.changePage=changePage,vm.changeSearch=changeSearch,vm.limitDefault=void 0;var limit=void 0;$scope.openMessagesSubscriptionDialog=openMessagesSubscriptionDialog;var PAGE_SIZE=50,vortextServicesMap={},initSearch=initSearch,resetErrorsInForm=resetErrorsInForm,displayErrorsInForm=displayErrorsInForm,callBackSearchError=callBackSearchError,callBackSearch=callBackSearch,getSearchVortextServiceSelected=getSearchVortextServiceSelected,getSearchVortextStatusSelected=getSearchVortextStatusSelected,initStatus=initStatus;$scope.user=UserService.getCurrentUser(),activate()}angular.module("itcare.messages").controller("MessagesCtrl",["$rootScope","$log","$scope","$state","Analytics","UserPreferencesService","UserService","MessagesService","CiService","IndicatorService","HelpService","$uibModal","lodash","moment","toaster","translationProvider","errorProvider","ConfStateUiView","$stateParams","vortextStatuses","vortextServices","TranslationService","UIService",MessagesCtrl])}(),function(){"use strict";angular.module("itcare.messages").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("messages",{url:"/messages?services&statuses&from&to&phoneNumber",templateUrl:"/messages/messages.html",reloadOnSearch:!1,controller:"MessagesCtrl",controllerAs:"messagesSearch",resolve:{vortextServices:["MessagesService",function(a){return a.getVortextServices()}],vortextStatuses:["MessagesService",function(a){return a.getMessagStatuses()}]},data:{restricted:!0},ncyBreadcrumb:{label:"{{translation.MESSAGES}}"}}).state("messages_search",{url:"/messages?services&statuses&from&to&phoneNumber&page",templateUrl:"/messages/messages.html",controller:"MessagesCtrl",controllerAs:"messagesSearch",resolve:{vortextServices:["MessagesService",function(a){return a.getVortextServices()}],vortextStatuses:["MessagesService",function(a){return a.getMessagStatuses()}]},data:{restricted:!0}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){m(),s.templateHelp=k.getTemplate("vortext-subscription",a.lang)}function m(){s.searchUserEmail()}function n(){return g.debug("search user email launched"),i.getUser().then(p,o),s.emailAddress}function o(a){g.debug(angular.uppercase(a)),s.emailAddress=null}function p(a){angular.isDefined(a)&&200===a.status&&(s.emailAddress=a.data.userEmail)}function q(){var b={accountId:e.id,email:s.emailAddress,roles:a.selected.roles};g.debug(b),j.createSubscription(b).then(function(a){f.pop("success",h.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_TITLE"),h.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_BODY"))},function(a){f.pop("danger","Unable to subsribe to vortext","Internal error")}),d.close()}function r(){d.dismiss("cancel")}var s=this;s.emailAddress=null,s.searchUserEmail=n,s.cancel=r,s.submit=q,s.resourceData=e;var m=m,o=o,p=p;l(),a.selected={roles:["sms_poster"]}}angular.module("itcare.messages").controller("SubscriptionCtrl",["$scope","$state","$timeout","$uibModalInstance","resourceData","toaster","$log","TranslationService","UserService","MessagesService","HelpService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){m(),n(),o(),A.templateHelp=k.getTemplate("vortext-subscription",a.lang)}function m(){A.searchUserEmail()}function n(){A.searchServicesEnvironments()}function o(){A.searchServicesStatuses()}function p(){return f.debug("search user email launched"),h.getUser().then(v,u),A.emailAddress}function q(){return i.getEnvironment().then(t,u),A.defaultEnvironments}function r(){return i.getStatus().then(s,u),A.defaultStatuses}function s(a){angular.isDefined(a)&&200===a.status&&(A.defaultStatuses=a.data.join(","))}function t(a){angular.isDefined(a)&&200===a.status&&(A.defaultEnvironments=a.data.join(","))}function u(a){f.debug(angular.uppercase(a)),A.emailAddress=null}function v(a){angular.isDefined(a)&&200===a.status&&(A.emailAddress=a.data.userEmail)}function w(a){return i.getServicesWithPaginate(A.defaultEnvironments,A.defaultStatuses,a,"",0,20,!1).then(function(a){return a.data})}function x(a,b,c,d){if(a.vortextEnabled)A.autocompleteSelection=void 0,A.autocompleteSelectionError=g.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SERVICE_SELECTION_CUSTOM_ERROR").format([a.name]);else{f.debug("selecting ci "+a),a.selected=!0,A.autocompleteSelection=a.name,A.accoundId=a.id,A.autocompleteSelectionError=void 0;var e=A.customSelection.indexOf(a.id);-1!==e?A.customSelectionTable[e]=a:A.customSelection.push(a.id)}}function y(){var a={accountId:A.accoundId,email:A.emailAddress};f.debug(a),j.createSubscription(a).then(function(a){e.pop("success",g.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_TITLE"),g.get("ITCARE_SERVICE_MESSAGE_SUBSCRIBE_SUCCEED_BODY"))},function(a){e.pop("danger","Unable to subsribe to vortext","Internal error")}),d.close()}function z(){d.dismiss("cancel")}var A=this;A.emailAddress=null,A.accoundId="",A.customSelection=[],A.customSelectionTable=[],A.autocompleteSelection=void 0,A.autocompleteSelectionError=void 0,A.defaultEnvironments=[],A.defaultStatuses=[],A.templateHelp=void 0,A.searchUserEmail=p,A.searchServicesEnvironments=q,A.searchServicesStatuses=r,A.setCustomSelection=x,A.searchResources=w,A.cancel=z,A.submit=y;var m=m,n=n,o=o,u=u,v=v;l(),a.selected={roles:["sms_poster"]}}angular.module("itcare.messages").controller("MessagesSubscriptionCtrl",["$scope","$state","$timeout","$uibModalInstance","toaster","$log","TranslationService","UserService","CiService","MessagesService","HelpService",a])}(),function(){"use strict";function a(a,b,c,d){function e(){f.message=d,b.debug(d)}var f=this;f.close=close,e(),a.ok=function(){c.close()}}angular.module("itcare.messages").controller("MessageDetailController",["$scope","$log","$uibModalInstance","detail",a])}(),function(){"use strict";angular.module("itcare.monitoring",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","toaster"])}(),function(){"use strict";angular.module("itcare.monitoring").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("monitoring",{url:"/monitoring?resourceName&monitoringCheck&statuses&environments&acknowledged&team",templateUrl:"/monitoring/monitoring.html",reloadOnSearch:!1,controller:"MonitoringCtrl",controllerAs:"monitoringCtrl",resolve:{monitoringStatuses:["MonitoringService",function(a){return a.getMonitoringStatuses()}]},data:{restricted:!0},ncyBreadcrumb:{label:"{{translation.MENU_MONITORING_CONSOLE_TITLE}}"}}).state("monitoring_items",{url:"/monitoring?resourceName&monitoringCheck&statuses&page&acknowledged&team",templateUrl:"/monitoring/monitoring.html",reloadOnSearch:!1,controller:"MonitoringCtrl",controllerAs:"monitoringCtrl",data:{restricted:!0},resolve:{monitoringStatuses:["MonitoringService",function(a){return a.getMonitoringStatuses()}]}})}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(){a.currentSection="monitoring",v.setTitle("Monitoring"),v.setFullScreenChangeListener(Ca),Ga.statuses=t.data,Ga.monitoringLoading=!1,Ga.filters={searchMonitoringCheck:s.monitoringCheck?s.monitoringCheck.split(","):[],searchStatusSelected:s.statuses?s.statuses.split(","):[],searchEnvironmentSelected:s.environments?s.environments.split(","):[],searchResourceSelected:s.resourceName?s.resourceName.split(","):[],searchServiceSelected:s.serviceIds?s.serviceIds.split(","):[],acknowledged:"true"==s.acknowledged?"true":"false"==s.acknowledged?"false":"all",team:"it"===s.team?"it":"client"===s.team?"client":"all"},Ga.acknowledged=Ga.filters.acknowledged,Ga.team=Ga.filters.team,F(),s.serviceIds&&angular.forEach(s.serviceIds.split(","),function(a){Ga.filters.searchServiceSelected.push(m.find(Ga.serviceIds,function(b){return b.id==a}))}),b.debug("init pagination["+s.page+"]"),Ga.pagination={currentPage:void 0!==s.page?s.page:1,totalItems:0,pageSize:Ga.selectedPageSize,sort:Ha},b.debug("init pagination["+Ga.pagination.currentPage+"]"),H(),I(),J(),B(),c.$on("change-lang",function(a,c){b.debug("The change-lang event has been dealed and the form has been reinit ")})}function x(a){if(!Ga.searchIsLoading){var b=i.getMonitoringItems(ua(),va(),wa(),sa(),ta(),Ga.pagination.currentPage-1,Ga.filters.acknowledged,Ga.filters.team,Ga.selectedPageSize,Ha);return a||(Ga.searchIsLoading=!0),b.then(D,C),Ga.monitoringItems}}function y(a){void 0===c.sortType||void 0===c.sortReverse?(b.debug("default sorting ... (-duration)"),Ha="-duration"):"since"==a&&1==c.sortReverse?(b.debug("sorting ... (-duration)"),Ha="-duration"):"since"==a&&0==c.sortReverse?(b.debug("sorting ... (+duration)"),Ha="+duration"):"resourceName"==a&&0==c.sortReverse?(b.debug("sorting ... (+resourceName)"),Ha="+resourceName"):"resourceName"==a&&1==c.sortReverse?(b.debug("sorting ... (-resourceName)"),Ha="-resourceName"):"checkName"==a&&0==c.sortReverse?(b.debug("sorting ... (+monitoringCheck)"),Ha="+monitoringCheck"):"checkName"==a&&1==c.sortReverse?(b.debug("sorting ... (-monitoringCheck)"),Ha="-monitoringCheck"):Ha="-duration",A()}function z(){b.debug(Ga.pagination.currentPage),A()}function A(){d.go("monitoring",{serviceIds:ua(),resourceName:va(),statuses:sa(),monitoringCheck:wa(),acknowledged:Ga.acknowledged,team:Ga.team},{}),x(!1)}function B(){b.debug("init search"),Ga.searchMonitoringItems(!1)}function C(a){b.debug(angular.uppercase(a)),400===a.status&&o.pop("error",q.get("error.client.title"),q.get("error.client.400")),Ga.searchIsLoading=!1}function D(a){angular.isDefined(a)&&200===a.status&&(Ga.monitoringItems=a.data.content,Ga.pagination={totalItems:a.data.totalElements,currentPage:a.data.number+1,pageSize:Ga.selectedPageSize},angular.forEach(Ga.monitoringItems,function(a){var b=Ga.monitoringItems.indexOf(a);a.selected=!1,Ga.monitoringItems[b]=a})),Ga.searchIsLoading=!1,F(),E(!0),G()}function E(a){(void 0===Ia||a)&&(void 0!==Ia&&e.cancel(Ia),void 0!==Ja&&e.cancel(Ja),b.debug("Initializing refresh..."),Ja=e(function(){K(!0)},1e3*Ga.refreshTimeSeconds),c.$on("$destroy",function(){e.cancel(Ja)}),Ia=e(function(){A()},1e3*Ga.refreshTimeSeconds),c.$on("$destroy",function(){e.cancel(Ia)}))}function F(){var a="";if(Ga.filters.searchResourceSelected.length>0){a+="<strong>"+u.get("RESOURCES")+"</strong>: ";var b=[];angular.forEach(Ga.filters.searchResourceSelected,function(a){var c=a.startsWith("!")?u.get("CONTAINS_NOT").toLowerCase():u.get("CONTAINS").toLowerCase(),d=a.startsWith("!")?a.substring(1):a;b.push(c+" '"+d+"'")}),a+=b.join(" "+u.get("OR").toLowerCase()+" ")}if(Ga.filters.searchMonitoringCheck.length>0){""!==a&&(a+=" - "),a+="<strong>"+u.get("CHECKS")+"</strong>: ";var b=[];angular.forEach(Ga.filters.searchMonitoringCheck,function(a){var c=a.startsWith("!")?u.get("CONTAINS_NOT").toLowerCase():u.get("CONTAINS").toLowerCase(),d=a.startsWith("!")?a.substring(1):a;b.push(c+" '"+d+"'")}),a+=b.join(" "+u.get("OR").toLowerCase()+" ")}Ga.filters.searchStatusSelected.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+u.get("STATUSES")+"</strong>: ",a+=Ga.filters.searchStatusSelected.join(" "+u.get("OR").toLowerCase()+" ")),"all"!==Ga.filters.acknowledged&&(""!==a&&(a+=" - "),"true"==Ga.filters.acknowledged?a+="<strong>"+u.get("ITCARE_MONITORING_ACKNOWLEDGED_FILTER_TRUE")+"</strong>":a+="<strong>"+u.get("ITCARE_MONITORING_ACKNOWLEDGED_FILTER_FALSE")+"</strong>"),"all"!==Ga.filters.team&&(""!==a&&(a+=" - "),"it"==Ga.filters.team?a+="<strong>"+u.get("ITCARE_SERVICE_MONITORING_SEARCH_OPERATION_TEAM_FILTER_IT")+"</strong>":a+="<strong>"+u.get("ITCARE_SERVICE_MONITORING_SEARCH_OPERATION_TEAM_FILTER_CLIENT")+"</strong>"),Ga.filters.searchEnvironmentSelected.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+u.get("ENVIRONMENTS")+"</strong>: ",a+=Ga.filters.searchEnvironmentSelected.join(" "+u.get("OR").toLowerCase()+" ")),Ga.filters.searchServiceSelected.length>0&&(""!==a&&(a+=" - "),a+="<strong>"+u.get("SERVICES")+"</strong>: ",a+=Ga.filters.searchServiceSelected.join(" "+u.get("OR").toLowerCase()+" ")),Ga.filtersSummary=a}function G(){Ga.refreshCountdown=Ga.refreshTimeSeconds,Ga.refreshCountdownGraph={data:[Ga.refreshTimeSeconds-Ga.refreshCountdown,Ga.refreshCountdown],labels:["A","B"]},void 0!==Ka&&f.cancel(Ka),Ka=f(function(){Ga.refreshCountdown=Ga.refreshCountdown-1,Ga.refreshCountdownGraph={data:[Ga.refreshTimeSeconds-Ga.refreshCountdown,Ga.refreshCountdown],labels:["A","B"]}},1e3,Ga.refreshTimeSeconds)}function H(){Ga.searchServicesEnvironments()}function I(){Ga.searchServicesStatuses()}function J(){K(!1)}function K(a){a||(Ga.overviewLoading=!0),j.getMonitoringOverview().then(function(a){Ga.monitoringOverview=a.data,Ga.overviewLoading=!1})}function L(){return j.getEnvironment().then(O,C),Ga.defaultEnvironments}function M(){return j.getStatus().then(N,C),Ga.defaultStatuses}function N(a){angular.isDefined(a)&&200===a.status&&(Ga.defaultStatuses=a.data.join(","))}function O(a){angular.isDefined(a)&&200===a.status&&(Ga.defaultEnvironments=a.data)}function P(a){var b=[];return angular.forEach(a,function(a){b.push(a.id)}),b.join(",")}function Q(){l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-search-filter.html",controller:"MonitoringSearchFilterCtrl",controllerAs:"newFilter",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitorStatuses:function(){return Ga.statuses}}}).result.then(function(a){g.trackEvent("Monitoring","Search"),a.filters.acknowledged="true"==a.filters.acknowledged?"true":"false"==a.filters.acknowledged?"false":"all",a.filters.team="it"==a.filters.team?"it":"client"==a.filters.team?"client":"all",d.go("monitoring",{serviceIds:a.filters.searchServiceSelected.join(","),resourceName:a.filters.searchResourceSelected.join(","),statuses:a.filters.searchStatusSelected.join(","),monitoringCheck:a.filters.searchMonitoringCheck.join(","),environments:a.filters.searchEnvironmentSelected.join(","),acknowledged:a.filters.acknowledged,team:a.filters.team},{});var b=i.getMonitoringItems(P(a.filters.searchServiceSelected),a.filters.searchResourceSelected.join(","),a.filters.searchMonitoringCheck.join(","),a.filters.searchStatusSelected.join(","),a.filters.searchEnvironmentSelected.join(","),Ga.pagination.currentPage-1,a.filters.acknowledged,a.filters.team,Ga.selectedPageSize,Ha);return Ga.searchIsLoading=!0,b.then(D,C),Ga.filters=a.filters,F(),angular.forEach(Ga.monitoringItems,function(a){var b=Ga.monitoringItems.indexOf(a);a.selected=!1,Ga.monitoringItems[b]=a}),Ga.monitoringItems},function(){b.debug("Modal dismissed at: "+new Date)})}function R(a){return j.searchServices(a).then(function(a){return a.data})}function S(a){var b=[];return b.push({name:Ga.qResources}),b}function T(a,c,d,e){b.debug("added service"),b.debug(a),Ga.filters.searchServiceSelected.length>0?(Ga.selectedServiceEnabled=!1,Ga.filters.searchServiceSelected=[]):(Ga.selectedServiceEnabled=!0,Ga.filters.searchServiceSelected.push(a),Ga.searchServicePopoverOpen=!1,Ga.qServices="")}function U(){-1!=Ga.filters.searchResourceSelected.indexOf(Ga.addedResourceFilter)&&0!=Ga.filters.searchResourceSelected.length||null==Ga.addedResourceFilter||""===Ga.addedResourceFilter||Ga.filters.searchResourceSelected.push(Ga.addedResourceFilter)}function V(){-1!=Ga.filters.searchMonitoringCheck.indexOf(Ga.addedCheckFilter)&&0!=Ga.filters.searchMonitoringCheck.length||null==Ga.addedCheckFilter||""===Ga.addedCheckFilter||Ga.filters.searchMonitoringCheck.push(Ga.addedCheckFilter)}function W(a){var b=Ga.filters.searchServiceSelected.indexOf(a);b>-1&&Ga.filters.searchServiceSelected.splice(b,1)}function X(a,c,d,e){b.debug("added service"),b.debug(a),Ga.filters.searchStatusSelected.push(a),Ga.searchStatusPopoverOpen=!1}function Y(a){var b=Ga.filters.searchStatusSelected.indexOf(a);b>-1&&Ga.filters.searchStatusSelected.splice(b,1)}function Z(){var a=Ga.defaultEnvironments;b.debug(Ga.defaultEnvironments);var c=[];return angular.forEach(a,function(a){-1==Ga.filters.searchEnvironmentSelected.indexOf(a)&&c.push(a)}),c}function $(a,c,d,e){b.debug(a),Ga.filters.searchEnvironmentSelected.push(a),Ga.searchEnvironmentPopoverOpen=!1}function _(a){var b=Ga.filters.searchEnvironmentSelected.indexOf(a);b>-1&&Ga.filters.searchEnvironmentSelected.splice(b,1)}function aa(a){-1!=Ga.filters.searchResourceSelected.indexOf(a)&&0!=Ga.filters.searchResourceSelected.length||Ga.filters.searchResourceSelected.push(a)}function ba(a){var b=Ga.filters.searchResourceSelected.indexOf(a);b>-1&&Ga.filters.searchResourceSelected.splice(b,1)}function ca(a){-1!=Ga.filters.searchMonitoringCheck.indexOf(a)&&0!=Ga.filters.searchMonitoringCheck.length||Ga.filters.searchMonitoringCheck.push(a)}function da(a){var b=Ga.filters.searchMonitoringCheck.indexOf(a);b>-1&&Ga.filters.searchMonitoringCheck.splice(b,1)}function ea(a){if(a.checked)Ga.selectedItems.push(a);else{var b=Ga.selectedItems.indexOf(a);b>-1&&Ga.selectedItems.splice(b,1)}}function fa(){var a=[];return angular.forEach(Ga.selectedItems,function(b){a.push({resourceId:b.resourceId,resourceType:b.resourceType,resourceName:b.resourceName,checkName:b.checkName})}),a}function ga(){var a=[];return angular.forEach(Ga.selectedItems,function(b){["WARNING","CRITICAL","UNKNOWN"].indexOf(b.status)>=0&&a.push({resourceId:b.resourceId,resourceType:b.resourceType,resourceName:b.resourceName,checkName:b.checkName})}),a}function ha(){var a=[];return angular.forEach(Ga.selectedItems,function(b){b.acknowledged&&a.push({resourceId:b.resourceId,resourceType:b.resourceType,resourceName:b.resourceName,checkName:b.checkName})}),a}function ia(){Ga.selectedItems=[],angular.forEach(Ga.monitoringItems,function(a){a.checked=!1})}function ja(a){var b=a.serviceId;return Ga.selectedItems.indexOf(b)>-1}function ka(){g.trackEvent("Monitoring","Acknowledgment Start"),l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-acknowledge-check.html",controller:"AknowledgeCheckCtrl",controllerAs:"newAknowledge",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitoringItems:function(){return ga()}}}).result.then(function(a){g.trackEvent("Monitoring","Acknowledgment Completed"),ia(),A()},function(){b.debug("Modal dismissed at: "+new Date),ia()})}function la(){g.trackEvent("Monitoring","Disacknowledgment Start"),l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-disacknowledge-check.html",controller:"DisAknowledgeCheckCtrl",controllerAs:"newDisAknowledge",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitoringItems:function(){return ha()}}}).result.then(function(a){g.trackEvent("Monitoring","Disacknowledgment Completed"),ia(),A()},function(){ia(),b.debug("Modal dismissed at: "+new Date)})}function ma(a,c){l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-operations-team.html",controller:"MonitoringOperationsTeamCtrl",controllerAs:"newOperationsTeam",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitoringItems:function(){return fa()}}}).result.then(function(a){ia(),B()},function(){b.debug("Modal dismissed at: "+new Date)})}function na(){l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-schedule-downtime.html",controller:"MonitoringScheduleDowntimeCtrl",controllerAs:"newMonitoringScheduleDowntime",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitoringItems:function(){return fa()}}}).result.then(function(a){var c={description:a.description,startAt:n(a.ranges.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),endAt:n(a.ranges.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),resources:a.synthesisResources};ia(),i.createMaintenance(c).then(function(a){b.debug("Creating maintenance http status : "+a.status),202===a.status?o.pop("success",u.get("ACTION_CONFIRM_CREATE_DOWNTIME")):b.debug("Unable to perform this action "+a.status)},function(a){b.error("Failed to create maintenance: "+a)})},function(){ia(),b.info("Modal dismissed at: "+new Date)})}function oa(){l.open({animation:!0,templateUrl:"/monitoring/actions/monitoring-delete-downtime.html",controller:"MonitoringDeleteDowntimeCtrl",controllerAs:"delMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{monitoringItems:function(){return fa()}}}).result.then(function(a){var d=[];angular.forEach(a.synthesisResources,function(a){d.push(a.downtimeId)});var e=i.deleteMaintenance(d);ia(),e.then(function(a){b.debug("Delete maintenance http status : "+a.status),202===a.status?(o.pop("success",u.get("ACTION_MENU_DELETE_MAINTENANCE_PROCESS")),c.setInstanceDataModel()):b.debug("there is no automation for this instance, status "+a.status)},function(a){b.error("Failed to delete maintenance: "+a)})},function(){ia(),b.info("Modal dismissed at: "+new Date)})}function pa(a){"instance"==a.resourceType?d.go("services_detail.instance.information",{serviceId:a.serviceId,instanceId:a.resourceId}):"loadbalancer"==a.resourceType?d.go("services_detail.loadbalancer.information",{serviceId:a.serviceId,url:a.resourceId}):"cluster"==a.resourceType?d.go("services_detail.cluster.information",{serviceId:a.serviceId,clusterId:a.resourceId}):d.go("services_detail.hardware.information",{serviceId:a.serviceId,hardwareId:a.resourceId})}function qa(a){return j.searchMonitoringChecks(a).then(function(a){return a.data})}function ra(a,c,d,e){b.debug("selecting resource "+a),Ga.selectedResource=a.name}function sa(){return Ga.filters.searchStatusSelected.join(",")}function ta(){return Ga.filters.searchEnvironmentSelected.join(",")}function ua(){var a=[];return angular.forEach(Ga.filters.searchServiceSelected,function(b){a.push(b.id)}),a.join(",")}function va(){return Ga.filters.searchResourceSelected.join(",")}function wa(){return Ga.filters.searchMonitoringCheck.join(",")}function xa(){var a=!1;return angular.forEach(Ga.selectedItems,function(b){["WARNING","CRITICAL","UNKNOWN"].indexOf(b.status)>=0&&(a=!0)}),a}function ya(){var a=!1;return angular.forEach(Ga.selectedItems,function(b){b.acknowledged&&(a=!0)}),a}function za(a){d.go("monitoring",{serviceIds:"",resourceName:"",statuses:a,environments:"",monitoringCheck:""},{}),Ga.filters.searchResourceSelected=[],Ga.filters.searchMonitoringCheck=[],Ga.filters.searchStatusSelected=[a],Ga.filters.searchEnvironmentSelected=[],Aa()}function Aa(){Ga.monitoringItems=[];var a=i.getMonitoringItems(ua(),va(),wa(),sa(),ta(),0,Ga.acknowledged,Ga.team,Ga.selectedPageSize,Ha);return Ga.searchIsLoading=!0,a.then(D,C),Ga.monitoringItems}function Ba(a,b,c){k.openModal(b,c,a)}function Ca(a){b.debug("Full screen changed"),a?v.disableHeader():v.enableHeader(),Ga.fullScreenMode=a}function Da(){Ga.fullScreenMode=v.toggleFullScreen(!0)}function Ea(){Ga.displayServices=!Ga.displayServices}function Fa(){Ga.truncateOutput=!Ga.truncateOutput}var Ga=this;Ga.services=[],Ga.statuses=[],Ga.searchIsLoading=!1,Ga.acknowledged="all",Ga.team="all",Ga.monitoringItems=[],Ga.selectedItems=[],Ga.ui=void 0,Ga.stateName="monitoring_items",Ga.pagination={},Ga.serviceStatus={},Ga.defaultEnvironments=[],Ga.defaultStatuses=[],Ga.selectedResource="",Ga.selectedServiceName="",Ga.selectedServiceEnabled=!1,Ga.addedResourceFilter="",Ga.addedCheckFilter="",Ga.autocompleteSelection=void 0,Ga.monitoringOverview={},Ga.monitoringLoading=!0,Ga.overviewLoading=!0,Ga.pageSizesAvailable=[15,30,50,100],Ga.selectedPageSize=30,Ga.fullScreenMode=!1,Ga.displayServices=!1,Ga.truncateOutput=!0,Ga.selectedAll=!1,Ga.filtersSummary="",Ga.filterResults=Q,Ga.searchServices=R,Ga.addService=T,Ga.removeService=W,Ga.addStatus=X,Ga.removeStatus=Y,Ga.searchEnvironment=Z,Ga.addEnvironment=$,Ga.removeEnvironment=_,Ga.addResourceFilter=U,Ga.addCheckFilter=V,Ga.addResource=aa,Ga.removeResource=ba,Ga.addMonitoringCheck=ca,Ga.removeMonitoringCheck=da,Ga.checkItem=ea,Ga.uncheckItem=ja,Ga.showAknowledgeModal=ka,Ga.showDisaknowledgeModal=la,Ga.showOperationsTeamsModal=ma,Ga.showScheduleDowntimeModal=na,Ga.showDeleteScheduleDowntimeModal=oa,Ga.goToResource=pa,Ga.showMonitoringStatusHistory=Ba,Ga.goToMonitoring=za,Ga.searchServicesEnvironments=L,Ga.searchServicesStatuses=M,Ga.toggleFullScreenMode=Da,Ga.toggleServicesDisplay=Ea,Ga.toggleTruncateOutput=Fa,Ga.searchServices=R,Ga.resourceSearch=S,Ga.searchResources=qa,Ga.selectSearchMonitoringResource=ra,Ga.computeAcknowledgeAvailableActions=xa,Ga.computeDisacknowledgeAvailableActions=ya,Ga.searchMonitoringItems=x,Ga.changePage=z,Ga.changeSearch=A,Ga.changeSortingMonitoring=y,Ga.refreshTimeAvailable=[20,30,60],Ga.refreshTimeSeconds=60,Ga.refreshCountdown=void 0,Ga.refreshCountdownGraph={data:[],labels:[]};var Ha="-duration",Ia=void 0,Ja=void 0,Ka=void 0,B=B,C=C,D=D,sa=sa,ua=ua,va=va,wa=wa,I=I,J=J,H=H;w(),c.refreshServices=function(a){return j.searchServices(a).then(function(a){Ga.services=a.data})},c.sortType="since",c.sortReverse=!0,Ga.requestResource=[]}angular.module("itcare.monitoring").controller("MonitoringCtrl",["$rootScope","$log","$scope","$state","$timeout","$interval","Analytics","UserPreferencesService","MonitoringService","CiService","MonitoringStatusHistoryService","$uibModal","lodash","moment","toaster","translationProvider","errorProvider","ConfStateUiView","$stateParams","monitoringStatuses","TranslationService","UIService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){-1!=(a?L.filters.searchResourceSelected.indexOf(L.addedResourceFilter):L.filters.searchResourceSelected.indexOf("!"+L.addedResourceFilter))&&0!=L.filters.searchResourceSelected.length||null==L.addedResourceFilter||""===L.addedResourceFilter||(a?L.filters.searchResourceSelected.push(L.addedResourceFilter):L.filters.searchResourceSelected.push("!"+L.addedResourceFilter))}function p(a){var b=L.filters.searchResourceSelected.indexOf(a);b>-1&&L.filters.searchResourceSelected.splice(b,1)}function q(a){-1!=(a?L.filters.searchMonitoringCheck.indexOf(L.addedCheckFilter):L.filters.searchMonitoringCheck.indexOf("!"+L.addedCheckFilter))&&0!=L.filters.searchMonitoringCheck.length||null==L.addedCheckFilter||""===L.addedCheckFilter||(a?L.filters.searchMonitoringCheck.push(L.addedCheckFilter):L.filters.searchMonitoringCheck.push("!"+L.addedCheckFilter))}function r(a){var b=L.filters.searchMonitoringCheck.indexOf(a);b>-1&&L.filters.searchMonitoringCheck.splice(b,1)}function s(a,b,c,d){L.filters.searchStatusSelected.push(a),L.searchStatusPopoverOpen=!1}function t(a){var b=L.filters.searchStatusSelected.indexOf(a);b>-1&&L.filters.searchStatusSelected.splice(b,1)}function u(a,b,c,d){L.filters.searchEnvironmentSelected.push(a),L.searchEnvironmentPopoverOpen=!1}function v(a){var b=L.filters.searchEnvironmentSelected.indexOf(a);b>-1&&L.filters.searchEnvironmentSelected.splice(b,1)}function w(a,b,c,d){L.filters.searchServiceSelected.push(a),L.searchServicePopoverOpen=!1,L.qServices=""}function x(a){var b=L.filters.searchServiceSelected.indexOf(a);b>-1&&L.filters.searchServiceSelected.splice(b,1)}function y(a){return l.searchServices(a).then(function(a){return a.data})}function z(){var a=L.statuses,b=[];return angular.forEach(a,function(a){-1==L.filters.searchStatusSelected.indexOf(a)&&b.push(a)}),b}function A(){var a=L.defaultEnvironments,b=[];return angular.forEach(a,function(a){-1==L.filters.searchEnvironmentSelected.indexOf(a)&&b.push(a)}),b}function B(){L.searchServicesEnvironments()}function C(){L.searchServicesStatuses()}function D(){return l.getEnvironment().then(G,H),L.defaultEnvironments}function E(){return l.getStatus().then(F,H),L.defaultStatuses}function F(a){angular.isDefined(a)&&200===a.status&&(L.defaultStatuses=a.data.join(","))}function G(a){angular.isDefined(a)&&200===a.status&&(L.defaultEnvironments=a.data)}function H(a){h.debug(angular.uppercase(a)),400===a.status&&e.pop("error",errorProvider.get("error.client.title"),errorProvider.get("error.client.400")),L.searchIsLoading=!1}function I(){g.close(L)}function J(){L.filters={searchMonitoringCheck:c.monitoringCheck?c.monitoringCheck.split(","):[],searchStatusSelected:c.statuses?c.statuses.split(","):[],searchEnvironmentSelected:c.environments?c.environments.split(","):[],searchResourceSelected:c.resourceName?c.resourceName.split(","):[],searchServiceSelected:c.serviceIds?c.serviceIds.split(","):[],acknowledged:"true"==c.acknowledged?"true":"false"==c.acknowledged?"false":"all",team:"it"==c.team?"it":"client"==c.team?"client":"all"},c.serviceIds&&angular.forEach(c.serviceIds.split(","),function(a){L.filters.searchServiceSelected.push(i.find(L.serviceIds,function(b){return b.id==a}))}),B(),C()}function K(){g.dismiss("cancel")}var L=this;L.resourceNameFilter=[{filter:k.get("RESOURCE_FILTER_IN"),contains:!0},{filter:k.get("RESOURCE_FILTER_NOT"),contains:!1}],L.selectedResourceNameFilter=L.resourceNameFilter[0],L.selectedCheckNameFilter=L.resourceNameFilter[0],L.addedResourceFilter="",L.addedCheckFilter="",L.statuses=j,L.defaultEnvironments=[],L.defaultStatuses=[],L.cancel=K,L.addResourceFilter=o,L.removeResourceFilter=p,L.addCheckFilter=q,L.removeMonitoringCheck=r,L.addStatus=s,L.removeStatus=t,L.addEnvironment=u,L.removeEnvironment=v,L.addServiceFilter=w,L.searchServices=y,L.removeServiceFilter=x,L.searchStatus=z,L.searchEnvironment=A,L.searchServicesEnvironments=D,L.searchServicesStatuses=E,L.changeSearch=I;var C=C,B=B,H=H;J()}angular.module("itcare.monitoring").controller("MonitoringSearchFilterCtrl",["$scope","$state","$stateParams","$timeout","toaster","$interval","$uibModalInstance","$log","lodash","monitorStatuses","TranslationService","CiService","UserService","MonitoringService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){}function t(){var a=I.isStandard?{checks:I.monitoringItems,team:I.selectedOperationTeamsWho.team,businessHours:I.businessHours}:{checks:I.monitoringItems,team:I.selectedOperationTeamsWho.team,businessHours:I.businessHours,ticket:I.ticket};I.ticketCreationLoading=!0,q.updateOperationTeams(a).then(function(a){if(j.debug("updateOperationTeamsPromise status : "+a.status),200===a.status)if(I.ticketCreated=a.data.ticket,I.attachments.length>0){var b=!1,c=function(a,b){return n.addAttachment(a,b)},e=function(a){return a.reduce(function(a,d){return a.then(function(){return c(I.ticketCreated.id,d)},function(){b=!0})},d.when(""))};e(I.attachments).then(function(){I.ticketCreationLoading=!1,I.errorsInAddingAttachments=b,E()},function(){I.errorsInAddingAttachments=b,I.ticketCreationLoading=!1,E()})}else I.ticketCreationLoading=!1,I.errorsInAddingAttachments=!1,E();else j.debug("Error while doing this operation "+a.status)},function(a){j.error("Failed to update operation team: "+a)})}function u(a){I.selectedOperationTeamsWho=a}function v(a){I.businessHours=a}function w(){i.dismiss("cancel")}function x(){i.close(I.ticketCreated)}function y(a){I.currentStep}function z(){angular.forEach(I.previewMonitoringChecks.checks,function(a){if("CEGEDIMIT"===I.selectedOperationTeamsWho.team){if(!1===a.standard)return void(I.isStandard=!1)}else I.isStandard=!0}),j.debug(I.isStandard)}function A(){I.ticket.requestTypeId=I.surveyDelegationTemplate,I.loading=!0,n.getSupportCatalogItem(I.surveyDelegationTemplate).then(function(b){b.data.formYamlDefinition?r.getFormInstanceFromYaml(b.data.formYamlDefinition,a.lang).then(function(a){I.form=a,I.loading=!1},function(a){I.form=void 0,I.loading=!1,j.error(a)}):(I.form=void 0,I.loading=!1)},function(){I.loading=!1})}function B(){if(void 0!==I.form){var a="";angular.forEach(I.form.fields,function(b){b.visible&&("section"==b.type?a+=""+(b.label?b.label:b.id):a+="- "+(b.label?b.label:b.id)+" : ","attachment"===b.type?(b.value||"object"==typeof b.value)&&(a+=b.value.name,I.attachments.push(b.value)):void 0!==b.value&&(a+=b.value),a+="\n")}),I.ticket.body=a,I.ticket.type=I.surveyDelegationTicketType,void 0!==I.ticket.ccMailRecipients&&""!==I.ticket.ccMailRecipients?I.ticket.ccMailRecipients=I.ticket.ccMailRecipients.split(";"):I.ticket.ccMailRecipients=[]}}function C(a){I.attachments.splice(a,1)}function D(a,b){b.length>0&&"maxSize"==b[0].$error&&g.pop("error",m.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ACTION"),m.get("ITCARE_SERVICE_TICKETING_SEARCH_ACTION_ADD_ATTACHEMENT_ERROR_MAX_SIZE").format([b[0].name,b[0].$errorParam])),angular.forEach(a,function(a){I.attachments.push(a)})}function E(){switch(I.currentStep){case"OPERATION_TEAM":I.currentStep="OPERATION_PERIOD","CEGEDIMIT"==I.selectedOperationTeamsWho.team?I.operationTeamsWhen=I.operationTeamsWhenCegedimIt:I.operationTeamsWhen=I.operationTeamsWhenCustomer;break;case"OPERATION_PERIOD":I.previewLoading=!0;var a={checks:I.monitoringItems,businessHours:I.businessHours,team:I.selectedOperationTeamsWho.team};q.previewUpdateOperationTeams(a).then(function(a){I.previewLoading=!1,I.previewMonitoringChecks=a.data,z(),A(),I.ticketDescription=I.ticket.body,I.isStandard?I.currentStep="APP_WIZARD_STEP_SYNTHESIS":I.currentStep="PROCEDURE_SUBMISSION"},function(){I.previewLoading=!1});break;case"PROCEDURE_SUBMISSION":I.currentStep="APP_WIZARD_STEP_SYNTHESIS",B();break;case"APP_WIZARD_STEP_SYNTHESIS":I.currentStep="CONFIRMATION"}y(I.currentStep)}function F(){switch(I.currentStep){case"OPERATION_PERIOD":I.currentStep="OPERATION_TEAM";break;case"PROCEDURE_SUBMISSION":I.currentStep="OPERATION_PERIOD";break;case"APP_WIZARD_STEP_SYNTHESIS":I.isStandard?I.currentStep="OPERATION_PERIOD":I.currentStep="PROCEDURE_SUBMISSION"}y(I.currentStep)}function G(){switch(I.currentStep){case"OPERATION_TEAM":return void 0!==I.selectedOperationTeamsWho;case"OPERATION_PERIOD":return void 0!==I.businessHours;case"PROCEDURE_SUBMISSION":return I.form&&I.ticket.title&&I.form.isValid()}}function H(){return!0}var I=this;I.monitoringItems=l,I.operationTeamsWho=[{team:"CEGEDIMIT",name:m.get("ITCARE_SERVICE_MONITORING_OPERATION_TEAM_CEGEDIMIT")},{team:"CLIENT",name:m.get("ITCARE_SERVICE_MONITORING_OPERATION_TEAM_CUSTOMER")}],I.surveyDelegationTemplate="C_SURVEY_DELEGATION",I.surveyDelegationTicketType="Request",I.selectedOperationTeamsWho=void 0,I.businessHours=void 0,I.form=void 0,I.ticketDescription=void 0,I.isStandard=!0,I.ticketCreationLoading=!1,I.cancel=w,I.close=x,I.changeOperationTeams=t,I.previousAuthorized=H,I.nextAuthorized=G,I.previous=F,I.next=E,I.gotoStep=y,I.selectOperationTeam=u,I.selectOperationTeamWhen=v,I.manageStandardCheck=z,I.selectItemCatalog=A,I.previewMonitoringChecks=[],I.attachments=[],I.deleteAttachment=C,I.selectAttachments=D,I.ticket={type:void 0,requestTypeId:void 0,title:void 0,body:void 0,ccMailRecipients:""},I.previewLoading=!1,I.steps=[{label:"OPERATION_TEAM",icon:"fa-users"},{label:"OPERATION_PERIOD",icon:"fa-calendar-o"},{label:"PROCEDURE_SUBMISSION",icon:"fa-envelope"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-bars"},{label:"CONFIRMATION",icon:"fa-check"}],I.currentStep="OPERATION_TEAM",s(),I.gotoTicket=function(a){c.go("ticket_detail",{ticketId:a}),I.close()}}angular.module("itcare.monitoring").controller("MonitoringOperationsTeamCtrl",["$rootScope","$scope","$state","$q","$stateParams","$timeout","toaster","$interval","$uibModalInstance","$log","lodash","monitoringItems","TranslationService","TicketService","CiService","UserService","MonitoringService","MFForm",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){u.steps=[{label:"ITCARE_SERVICE_MONITORING_WIZARD_STEP_HELP",icon:"fa-at"},{label:"MAINTENANCE_WIZARD_STEP_RESOURCE",icon:"fa-check-square-o"},{label:"MAINTENANCE_WIZARD_STEP_SCHEDULE",icon:"fa-calendar-o"}],u.synthesisResources=[],u.currentStep=0}function n(){u.synthesisResources=[],angular.forEach(u.resources,function(a){u.synthesisResources.push({resourceName:a.name,checkName:a.checkName})})}function o(){switch(u.isNextAuthorized=!1,u.currentStep){case 0:case 1:case 2:u.isNextAuthorized=!0}}function p(){return!0}function q(){e.debug("[Action: NEXT ] - current step id : "+u.currentStep),u.isNextAuthorized&&(0==u.currentStep?(u.resources=h,n(),o(),u.currentStep++):1==u.currentStep&&(n(),u.currentStep++),o(),e.debug("[Action: NEXT ] - new step id : "+u.currentStep))}function r(){e.debug("[Action: PREVIOUS ] - current step id : "+u.currentStep),2==u.currentStep?u.currentStep--:1==u.currentStep&&u.currentStep--,0==u.currentStep&&(u.isNextAuthorized=!0),e.debug("[Action: PREVIOUS ] - new step id : "+u.currentStep)}function s(){u.form.$valid&&d.close(u),e.debug("[Action: SUBMIT FORM ] - send form to server")}function t(){d.dismiss("cancel")}var u=this;u.steps=[],u.resources=[],u.synthesisResources=[],u.isNextAuthorized=!0,u.description="",u.ranges={startDate:null,endDate:null},u.minDate=moment(),u.rangePickerAutoClose="always",u.optionsCalendar={showDropdowns:!0,timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,alwaysShowCalendars:!0,dateLimit:{months:6},buttonClasses:["btn","btn-sm","btn-block"],applyClass:"btn-success",cancelClass:"btn-default",locale:{customRangeLabel:j.get("PERIOD_CUSTOM"),format:"L LT",applyLabel:j.get("OK"),cancelLabel:j.get("CANCEL")},opens:"right",eventHandlers:{"apply.daterangepicker":function(a){moment(u.ranges.startDate).format("MM.DD.YYYY HH:mm:ss"),moment(u.ranges.endDate).format("MM.DD.YYYY HH:mm:ss")},"hide.daterangepicker":function(a){},"cancel.daterangepicker":function(a){}}},u.cancel=t,u.next=q,u.previous=r,u.submitMaintenance=s,u.previousAuthorized=p,u.nextAuthorize=o,m(),a.authoritiesFilter=function(a){return g.filter(a.availableActions,function(a){return"create-maintenance"==a.operation&&1==a.available})}}angular.module("itcare.monitoring").controller("MonitoringScheduleDowntimeCtrl",["$scope","$state","$timeout","$uibModalInstance","$log","errorProvider","lodash","monitoringItems","CiService","TranslationService","$q","UtilService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){o.steps=[{label:"MAINTENANCE_WIZARD_STEP_RESOURCE",icon:"fa-check-square-o"}],o.synthesisResources=h,o.currentStep=0}function m(){d.close(o)}function n(){d.dismiss("cancel")}var o=this;o.synthesisResources=[],o.cancel=n,o.submit=m,l()}angular.module("itcare.monitoring").controller("MonitoringDeleteDowntimeCtrl",["$scope","$state","$timeout","$uibModalInstance","errorProvider","toaster","lodash","monitoringItems","TranslationService","$q","UtilService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){o.loaded=!0}function m(){var a={},b=o.comment,c=j.getCurrentUser().username;a.checks=o.monitoringItems,a.user=c,a.comment=b,k.acknowledgeCheck(a).then(function(a){200!==a.status?f.debug("Failed to add aknowledge: "+a.status):(d.pop("success",i.get("ACKNOWLEDGE_SERVICE_SUCCESS_TITLE"),i.get("ACKNOWLEDGE_SERVICE_SUCCESS_BODY")),e.close())},function(a){f.error("Failed to add acknowledgee: "+a.data[0].code)})}function n(){e.dismiss("cancel")}var o=this;o.loaded=!1,o.monitoringItems=h,o.comment="",o.cancel=n,o.submit=m,l()}angular.module("itcare.monitoring").controller("AknowledgeCheckCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","lodash","monitoringItems","TranslationService","UserService","MonitoringService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){var a={},e=i.getCurrentUser().username;a.checks=m.monitoringItems,a.user=e,j.disAcknowledgeCheck(a).then(function(a){200!==a.status?c.debug("Failed to remove acknowledge: "+a.status):(d.pop("success",g.get("DISACKNOWLEDGE_SERVICE_SUCCESS_TITLE"),g.get("DISACKNOWLEDGE_SERVICE_SUCCESS_BODY")),b.close())},function(a){c.error("Failed to remove acknowledge: "+a.data[0].code)})}function l(){b.dismiss("cancel")}var m=this;m.loaded=!1,m.monitoringItems=f,m.cancel=l,m.ok=k}angular.module("itcare.monitoring").controller("DisAknowledgeCheckCtrl",["$scope","$uibModalInstance","$log","toaster","errorProvider","monitoringItems","TranslationService","$q","UserService","MonitoringService",a])}(),function(){"use strict";angular.module("itcare.search",["itcare.business","ui.bootstrap","ngLodash","ngAnimate","mgcrea.ngStrap.helpers.dimensions","mgcrea.ngStrap.helpers.debounce","mgcrea.ngStrap.affix","mgcrea.ngStrap.scrollspy","mgcrea.ngStrap","rzModule","angularMoment","toaster","ui.select","infinite-scroll"])}(),function(){"use strict";angular.module("itcare.search").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("search",{url:"/compute/search?:name&type&status&environment&tags&limit&page",templateUrl:"/search/search.html",reloadOnSearch:!1,controller:"SearchCtrl",controllerAs:"searchCtrl",data:{restricted:!0},resolve:{environments:["CiService",function(a){return a.getEnvironment()}]},ncyBreadcrumb:{label:"{{translation.MENU_COMPUTE_RESOURCES_TITLE}}",parent:"compute"}})}])}(),function(){"use strict";function SearchCtrl($rootScope,$log,$scope,$stateParams,$state,$sce,toaster,lodash,translationProvider,errorProvider,ConfStateUiView,Analytics,UserPreferencesService,CiService,TranslationService,UIService,TagsSelectorService,environments){function activate(){vm.currentPage=1,vm.limitDefault=50,limit=50;var a=!0;vm.stateName="search",vm.ui=ConfStateUiView.getUILocalStorage(vm.stateName,{filterCollapsed:!0,searchName:"",searchTypeSelected:[],searchStatusSelected:[],searchEnvironmentSelected:[],searchTagsSelected:[]}),vm.lastSearches=UserPreferencesService.getPreference("recent-search"),vm.lastServicesViews=UserPreferencesService.getPreference("last-views");for(var b=[{name:"page",field:""},{name:"name",field:"searchName"},{name:"type",field:"searchTypeSelected"},{name:"status",field:"searchStatusSelected"},{name:"environment",field:"searchEnvironmentSelected"},{name:"tags",field:"searchTagsSelected"}],c=0;c<b.length;c++)if("page"===b[c].name)vm.currentPage=$stateParams[b[c].name]?Number($stateParams[b[c].name]):1,a=!1;else if("name"===b[c].name)$stateParams[b[c].name]?vm.ui[b[c].field]=$stateParams[b[c].name]:vm.ui[b[c].field]="";else if("tags"===b[c].name)if($stateParams[b[c].name])if(angular.isArray($stateParams[b[c].name]))vm.ui[b[c].field]=lodash.map($stateParams[b[c].name],function(a){return{tagKey:a.split(":")[0],tagValue:a.split(":")[1]}});else{var d=$stateParams[b[c].name];vm.ui[b[c].field]=[{tagKey:d.substring(0,d.indexOf(":")),tagValue:d.substring(d.indexOf(":")+1)}]}else vm.ui[b[c].field]=[];else $stateParams[b[c].name]?vm.ui[b[c].field]=$stateParams[b[c].name].split(","):vm.ui[b[c].field]=[];vm.ui.filterCollapsed=!1,ConfStateUiView.persistUILocalStorage(vm.stateName,vm.ui),$log.debug(vm.ui),selectTypeInStorage(vm.searchTypes),selectStatusesInStorage(vm.searchStatus),selectEnvironmentsInStorage(environments.data),selectTagsInStorage(),search(!1,a),$scope.$on("change-lang",function(a,b){selectTypeInStorage(vm.searchTypes),selectStatusesInStorage(statuses.data),selectEnvironmentsInStorage(environments.data),$log.debug("The change-lang event has been dealed and the form has been reinit ")})}function searchTypesList(){var a=vm.searchTypes,b=[];return angular.forEach(a,function(a){-1==vm.selectedType.indexOf(a)&&b.push(a)}),b}function addType(a,b,c,d){$log.debug("added type"),$log.debug(a),vm.selectedType.push(a),vm.searchTypePopoverOpen=!1}function removeType(a){var b=vm.selectedType.indexOf(a);b>-1&&vm.selectedType.splice(b,1)}function mergeTypeToUi(){$log.debug("mergeTypeToUi: merge vm.searchType to vm.ui.searchTypeSelected"),vm.ui.searchTypeSelected=vm.selectedType.map(function(a){if(a)return a.name})}function selectTypeInStorage(a){vm.searchTypes=[{name:"instance",label:translationProvider.get("ITCARE_TYPE_INSTANCE")},{name:"service",label:translationProvider.get("ITCARE_TYPE_SERVICE")},{name:"loadbalancer",label:translationProvider.get("ITCARE_TYPE_LOADBALANCER")},{name:"hardware",label:translationProvider.get("HARDWARE")}];for(var b=vm.ui.searchTypeSelected,c=0;c<b.length;c++){var d=b[c];if(-1!=b.indexOf(d)){var e=lodash.filter(vm.searchTypes,function(a){return a.name===d});e&&1==e.length&&vm.selectedType.push(e[0])}}}function getSearchTypesSelected(){return vm.ui.searchTypeSelected}function searchStatusList(){$log.debug("search status");var a=vm.searchStatus,b=[];return angular.forEach(a,function(a){-1==vm.selectedStatus.indexOf(a)&&b.push(a)}),b}function addStatus(a,b,c,d){$log.debug("added status"),$log.debug(a),vm.selectedStatus.push(a),vm.searchStatusPopoverOpen=!1}function removeStatus(a){var b=vm.selectedStatus.indexOf(a);b>-1&&vm.selectedStatus.splice(b,1)}function mergeStatusToUi(){$log.debug("mergeStatusToUi: merge vm.searchStatus to vm.ui.searchStatusSelected"),vm.ui.searchStatusSelected=vm.selectedStatus.map(function(a){return a.name})}function selectStatusesInStorage(a){vm.searchStatus=[{name:"ACTIVE",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_ACTIVE")},{name:"PREPARATION",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_PREPARATION")},{name:"INACTIVE",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_INACTIVE")}];for(var b=vm.ui.searchStatusSelected,c=0;c<b.length;c++){var d=b[c];if(-1!=b.indexOf(d)){var a=lodash.filter(vm.searchStatus,function(a){return a.name===d});a&&1==a.length&&vm.selectedStatus.push(a[0])}}}function getSearchStatusSelected(){return vm.ui.searchStatusSelected.join(",")}function searchEnvList(){$log.debug("search environment");var a=vm.searchEnvironment,b=[];return angular.forEach(a,function(a){-1==vm.selectedEnvironment.indexOf(a)&&b.push(a)}),b}function addEnv(a,b,c,d){$log.debug("added environment"),$log.debug(a),vm.selectedEnvironment.push(a),vm.searchEnvPopoverOpen=!1}function removeEnv(a){var b=vm.selectedEnvironment.indexOf(a);b>-1&&vm.selectedEnvironment.splice(b,1)}function mergeEnvironmentToUi(){$log.debug("mergeStatusToUi: merge vm.searchEnvironmentSelected to vm.ui.searchEnvironmentSelected"),vm.ui.searchEnvironmentSelected=vm.selectedEnvironment.map(function(a){return a.name})}function selectEnvironmentsInStorage(a){var b=vm.ui.searchEnvironmentSelected;vm.searchEnvironment=[];for(var c=0;c<a.length;c++){var d=a[c],e=!1;b.length>0&&(e=-1!=b.indexOf(d)),e&&vm.selectedEnvironment.push({name:d,label:translationProvider.get("ITCARE_ENVIRONMENT_"+angular.uppercase(d))}),vm.searchEnvironment.push({name:d,label:translationProvider.get("ITCARE_ENVIRONMENT_"+angular.uppercase(d))})}}function getSearchEnvironmentSelected(){return vm.ui.searchEnvironmentSelected.join(",")}function search(a,b){if($log.debug("search launched"),vm.searchDisabled=!1,!vm.searchIsLoading&&vm.isFormValid()){resetErrorsInForm();vm.limitDefault;b?(vm.resultsAreDirty=!0,vm.searchDisabled=!1,vm.currentPage=1,vm.results=[],mergeTypeToUi(),mergeEnvironmentToUi(),mergeStatusToUi(),mergeTagsToUi(),ConfStateUiView.persistUILocalStorage(vm.stateName,vm.ui)):vm.limitSearch=limit;var c=CiService.getResourcesWithPaginate(getSearchTypesSelected(),getSearchEnvironmentSelected(),getSearchStatusSelected(),vm.ui.searchName,getSearchTagsSelected(),vm.currentPage-1,vm.limitSearch,a);vm.searchIsLoading=!0,vm.searchMoreIsLoading=vm.currentPage>1,vm.searchIsLoading&&!vm.searchMoreIsLoading&&(""==vm.ui.searchName&&vm.ui.searchTypeSelected==[]&&vm.ui.searchStatusSelected==[]&&vm.ui.searchEnvironmentSelected==[]&&vm.searchTagsSelected==[]||(vm.lastSearches=UserPreferencesService.appendPreference("recent-search",vm.ui,!1))),c.then(callBackSearch,callBackSearchError),Analytics.trackEvent("Search","Resources Explorer Search")}}function callBackSearch(a){angular.isDefined(a)&&200===a.status&&(vm.results=a.data.content,vm.currentPage=a.data.number+1,vm.resultTotalItems=a.data.totalElements),vm.searchIsLoading=!1,vm.searchMoreIsLoading=!1,vm.resultsAreDirty=!1;var b={name:""+(vm.ui.searchName?vm.ui.searchName:""),type:""+(vm.ui.searchTypeSelected?vm.ui.searchTypeSelected.join(","):[]),status:""+(vm.ui.searchStatusSelected?vm.ui.searchStatusSelected.join(","):[]),environment:""+(vm.ui.searchEnvironmentSelected?vm.ui.searchEnvironmentSelected.join(","):[]),tags:""+(vm.ui.searchTagsSelected?lodash.map(vm.ui.searchTagsSelected,function(a){return a.tagKey+":"+a.tagValue}).join(","):[]),page:vm.currentPage,limit:vm.limitSearch};$state.go(".",b)}function callBackSearchError(a){$log.debug(angular.uppercase(a)),400===a.status&&(toaster.pop("error",errorProvider.get("error.client.title"),errorProvider.get("error.client.400")),displayErrorsInForm(a.data)),vm.searchDisabled=!0,vm.searchIsLoading=!1}function isFormValid(){return!0}function toggleFilterCollapsed(){vm.ui.filterCollapsed=!vm.ui.filterCollapsed}function searchedRecently(a){return lodash.filter(vm.lastServicesViews,function(b){return b.id===a.id}).length>0?"success":""}function openTagSearch(a){closePopups(),TagsSelectorService.promptTagsInModal($rootScope.translation,vm.searchTags,a,!1).then(function(a){vm.searchTags=a})}function removeTag(a){var b=vm.searchTags.indexOf(a);b>-1&&vm.searchTags.splice(b,1)}function getSearchTagsSelected(){var a=[];return angular.forEach(vm.searchTags,function(b){""!=b.tagKey&&""!=b.tagValue&&a.push(b.tagKey+":"+b.tagValue)}),a.join(",")}function selectTagsInStorage(){var a=vm.ui.searchTagsSelected;vm.searchTags=[];for(var b=0;b<a.length;b++)vm.searchTags.push(a[b])}function mergeTagsToUi(){$log.debug("mergeTagsToUi: merge vm.searchEnvironmentSelected to vm.ui.searchEnvironmentSelected"),angular.copy(lodash.map(vm.searchTags,function(a){return{tagKey:a.tagKey,tagValue:a.tagValue}}),vm.ui.searchTagsSelected)}function tagPrettyPrint(a,b){return'<p align="left" ><strong>Key: </strong>'+a+"<br><strong>Value: </strong>"+b.toString().split("|").join("<br>")+"</p>"}function initSearch(){$log.debug("init search"),vm.search(!1,!0)}function resetErrorsInForm(){angular.isDefined(vm.formSearchService)&&(vm.formSearchService.searchName.$invalid=!1)}function displayErrorsInForm(errors){angular.forEach(errors,function(value,key){var codeMessage=errorProvider.get(value.code),errorMessage=codeMessage;value.on.length&&(errorMessage=codeMessage.replace("%s",value.on),eval("vm.formSearch."+value.on+".$invalid = true"),eval("vm.formSearch."+value.on+".$error = errorMessage"),$log.debug("There are new error: "+errorMessage))})}function closePopups(){vm.searchTypePopoverOpen=!1,vm.searchStatusPopoverOpen=!1,vm.searchEnvPopoverOpen=!1}$rootScope.currentSection="compute";var vm=this;UIService.setTitle("Search"),vm.formSearch,vm.selectedPlatform=[],vm.searchPlatform=[],vm.searchTags=[],vm.searchIsLoading=!1,vm.searchMoreIsLoading=!1,vm.results=[],vm.resultsAreDirty=!0,vm.ui=void 0,vm.stateName="search",vm.lastSearches=[],vm.lastServicesViews=[],vm.searchDisabled=!1,vm.productsChart={},vm.environmentsChart={},vm.selectedType=[],vm.searchTypes=[{name:"instance",label:translationProvider.get("ITCARE_TYPE_INSTANCE")},{name:"service",label:translationProvider.get("ITCARE_TYPE_SERVICE")},{name:"loadbalancer",label:translationProvider.get("ITCARE_TYPE_LOADBALANCER")},{name:"hardware",label:translationProvider.get("HARDWARE")}],vm.selectedStatus=[],vm.searchStatus=[{name:"ACTIVE",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_ACTIVE")},{name:"PREPARATION",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_PREPARATION")},{name:"INACTIVE",label:translationProvider.get("ITCARE_SEARCHRESOURCES_STATUS_INACTIVE")}],vm.selectedEnvironment=[],vm.searchEnvironment=[],vm.search=search,vm.isFormValid=isFormValid,vm.toggleFilterCollapsed=toggleFilterCollapsed,vm.searchedRecently=searchedRecently,vm.searchTypesList=searchTypesList,vm.addType=addType,vm.removeType=removeType,vm.mergeTypeToUi=mergeTypeToUi,vm.searchStatusList=searchStatusList,vm.addStatus=addStatus,vm.removeStatus=removeStatus,vm.mergeStatusToUi=mergeStatusToUi,vm.searchEnvList=searchEnvList,vm.addEnv=addEnv,vm.removeEnv=removeEnv,vm.mergeEnvironmentToUi=mergeEnvironmentToUi,vm.openTagSearch=openTagSearch,vm.removeTag=removeTag,vm.mergeTagsToUi=mergeTagsToUi,vm.closePopups=closePopups,vm.tagPrettyPrint=tagPrettyPrint,vm.currentPage=void 0,vm.limitDefault=void 0;var limit=void 0,initSearch=initSearch,resetErrorsInForm=resetErrorsInForm,displayErrorsInForm=displayErrorsInForm,callBackSearchError=callBackSearchError,callBackSearch=callBackSearch,selectTypeInStorage=selectTypeInStorage,getSearchTypesSelected=getSearchTypesSelected,selectStatusesInStorage=selectStatusesInStorage,getSearchStatusSelected=getSearchStatusSelected,selectEnvironmentsInStorage=selectEnvironmentsInStorage,getSearchEnvironmentSelected=getSearchEnvironmentSelected,selectTagsInStorage=selectTagsInStorage,getSearchTagsSelected=getSearchTagsSelected;activate()}angular.module("itcare.search").controller("SearchCtrl",["$rootScope","$log","$scope","$stateParams","$state","$sce","toaster","lodash","translationProvider","errorProvider","ConfStateUiView","Analytics","UserPreferencesService","CiService","TranslationService","UIService","TagsSelectorService","environments",SearchCtrl])}(),function(){"use strict";function IndicatorEditionCtrl($scope,$state,$timeout,$uibModalInstance,$log,errorProvider,lodash,globalServiceId,CiService,TranslationService,indicator,$q,IndicatorService,UtilService){function activate(){var a=angular.copy(indicator);if($log.debug(a),vm.steps=[{label:"APP_WIZARD_STEP_NAME",icon:"fa-at"},{label:"APP_WIZARD_STEP_AVAILABILITY_RATE",icon:"fa-tachometer"},{label:"APP_WIZARD_STEP_TIMESLOT",icon:"fa-calendar-check-o"},{label:"APP_WIZARD_STEP_CHECKS",icon:"fa-check-square-o"},{label:"APP_WIZARD_STEP_METRICS",icon:"fa-bar-chart"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-bars"}],configurationByMonitoringMode=IndicatorService.getAvailabilityTimeRanges(),angular.forEach(configurationByMonitoringMode,function(a,b){a.selectedWeekdays=[];var c=0;angular.forEach(a.weekdays,function(b){c++,b.sliderOptions={id:c,hideLimitLabels:!0,step:.25,precision:2,floor:0,ceil:24,disabled:!a.editable,noSwitching:!0,minRange:.25,translate:function(a,b,c){return UtilService.formatNumberedHour(a)}}})}),vm.currentStep=0,vm.editMode=null!=a,vm.editMode){vm.action="APP_CONFIGURE_ACTION",vm.indicatorId=a.id,vm.indicatorName=a.name,vm.availabilityRate={target:100*a.definition.availabilityTarget,warn:100*a.definition.availabilityWarn};var b=IndicatorService.determineAvailabilityTimeRange(a.definition.dayMask,a.definition.periodMask);if(vm.selectedAvailabilityTimeRangeType=b.type,vm.selectedAvailabilityTimeRange=angular.copy(configurationByMonitoringMode[vm.selectedAvailabilityTimeRangeType]),"custom"==vm.selectedAvailabilityTimeRangeType){vm.selectedAvailabilityTimeRange.weekdays=b.weekdays;for(var c=0;c<7;c++)vm.selectedAvailabilityTimeRange.weekdays[c].sliderOptions=configurationByMonitoringMode.custom.weekdays[c].sliderOptions}vm.selectedMetrics=a.definition.metrics,vm.selectedMonitoringChecks=a.definition.checks,mergeMonitoringChecks([]),mergeMetrics([])}else vm.action="APP_MONITORING_CREATION",vm.indicatorId=null,vm.indicatorName="",vm.availabilityRate={target:DEFAULT_AVAILABILITY_RATE_TARGET,warn:DEFAULT_AVAILABILITY_RATE_WARN},vm.selectedAvailabilityTimeRangeType="standard",vm.selectedAvailabilityTimeRange=configurationByMonitoringMode[vm.selectedAvailabilityTimeRangeType],vm.selectedMonitoringChecks=[],vm.selectedMetrics=[];vm.sliderAvailabilityOptions={hideLimitLabels:!0,step:.1,precision:1,floor:95,ceil:99.9,noSwitching:!0,showSelectionBarEnd:!0,getSelectionBarColor:function(a){return"transparent"},translate:function(a,b,c){switch(c){case"model":return'<p class="text-center text-danger" style="font-size: 150%;"><strong>'+a.toFixed(1)+"%</strong></p>";case"high":return'<p class="text-center text-success" style="font-size: 150%"><strong>'+a.toFixed(1)+"%</strong></p>"}},minRange:.1},vm.monitoringChecks=[],vm.metrics=[],vm.loaded=!0}function refreshSlider(){$timeout(function(){$scope.$broadcast("rzSliderForceRender")})}function checkIndicatorName(){vm.indicatorNotExist=!1,IndicatorService.getIndicatorByName(globalServiceId,vm.indicatorName).then(function(a){0==a.data.length?vm.indicatorNotExist=!0:vm.editMode?vm.indicatorNotExist=a.data[0].id==vm.indicatorId:vm.indicatorNotExist=!1,$log.debug(vm.wizardForm),vm.wizardForm.name&&vm.wizardForm.name.$setValidity("alreadyExists",vm.indicatorNotExist)}),vm.wizardForm.name.$setValidity("nameNotValid",null!==vm.regexAppName.exec(vm.indicatorName)&&null==vm.regexAppTab.exec(vm.indicatorName))}function computeCheckedErrorsFromServer(dataErrors){function extractMinAndMax(a){return a.match(/\d+/g)}angular.forEach(dataErrors,function(itemError,index){switch($log.debug("The field  "+itemError.on+"is in error."),itemError.code){case"error.validation.validweekdaystime":null!=itemError.on.match(/\d+/g)&&(vm.modelWizard.step.one.selectedAvailabilityTimeRange.weekday[itemError.on.match(/\d+/g)].isOnError=!0,vm.modelWizard.step.one.selectedAvailabilityTimeRange.weekday[itemError.on.match(/\d+/g)].msgError=errorProvider.get("error.validation.validweekdaystime"));break;case"error.validation.pattern":$log.debug("Error validation pattern : "+eval(itemError.on));break;case"error.validation.size":if("indicatorName"===itemError.on){var arrInfoSize=extractMinAndMax(itemError.defaultMsg),minSizeAppName=arrInfoSize[0],maxSizeAppName=arrInfoSize[1];$scope.wizardForm.appName.$error=!0,vm.appErrorMessage=errorProvider.get(itemError.code).format(minSizeAppName,maxSizeAppName)}else $log.error("Error in unknown field {0}".format(itemError.on));break;case"error.validation.notempty":$scope.checks={error:!0,errorMsg:errorProvider.get(itemError.code)};break;default:$log.error("Unknown error "+itemError.code+" from server, check the list.")}})}function nextAuthorized(){switch(vm.currentStep){case 0:return vm.wizardForm.name.$valid;case 1:return vm.availabilityRate.target>vm.availabilityRate.warn&&vm.availabilityRate.target<100&&vm.availabilityRate.warn>=95;case 2:return lodash.filter(vm.selectedAvailabilityTimeRange.weekdays,function(a){return a.checked}).length>0;case 3:return vm.selectedMonitoringChecks.length>0;case 4:return!0}}function previousAuthorized(){return!0}function gotoStep(a){switch(vm.refreshSlider(),vm.currentStep){case 0:case 1:break;case 2:$log.debug(configurationByMonitoringMode),angular.forEach(configurationByMonitoringMode.custom.weekdays,function(a){a.sliderOptions.disabled=!1});break;case 3:getServiceMonitoringChecks();break;case 4:getServiceMetrics();break;case 5:angular.forEach(vm.selectedAvailabilityTimeRange.weekdays,function(a){a.sliderOptions.disabled=!0})}}function getServiceMonitoringChecks(){vm.monitoringChecksLoading=!0,CiService.getMonitoringChecksByServiceId(globalServiceId).then(function(a){vm.monitoringChecksLoading=!1,mergeMonitoringChecks(a.data)},function(a){vm.monitoringChecksLoading=!1,$log.error("Error retrieving nagios checks for service {0}".format(globalServiceId))})}function searchMonitoringChecks(a){return CiService.searchMonitoringChecks(a).then(function(a){return a.data})}function selectSearchMonitoringCheck(a,b,c,d){$log.debug("selecting resource "+a),mergeMonitoringChecks(a.checks)}function mergeMonitoringChecks(a){vm.monitoringChecks=[],angular.forEach(vm.selectedMonitoringChecks,function(a){a.checkNameTranslated=TranslationService.get("monitoring."+a.name),a.checked=!0,vm.monitoringChecks.push(a)}),angular.forEach(a,function(a){var b=lodash.filter(vm.selectedMonitoringChecks,{id:a.id});a.checkNameTranslated=TranslationService.get("monitoring."+a.name),a.checked=b.length>0,a.checked||vm.monitoringChecks.push(a)})}function toggleSelectionMonitoringCheck(a){a.checked=!a.checked,a.checked?vm.selectedMonitoringChecks.push(a):lodash.remove(vm.selectedMonitoringChecks,{id:a.id})}function getServiceMetrics(){vm.metricsLoading=!0,CiService.getMonitoringMetricsByServiceId(globalServiceId).then(function(a){vm.metricsLoading=!1,mergeMetrics(a.data)},function(a){vm.metricsLoading=!1,$log.error("Error retrieving nagios metrics for service {0}".format(globalServiceId))})}function searchMetrics(a){return CiService.searchMetrics(a).then(function(a){return a.data})}function selectSearchMetric(a,b,c,d){$log.debug("selecting resource "+a),mergeMetrics(a.metrics)}function mergeMetrics(a){vm.metrics=[],angular.forEach(vm.selectedMetrics,function(a){a.checkNameTranslated=TranslationService.get("monitoring."+a.name),a.checked=!0,vm.metrics.push(a)}),angular.forEach(a,function(a){var b=lodash.filter(vm.selectedMetrics,{id:a.id});a.checkNameTranslated=TranslationService.get("monitoring."+a.name),a.checked=b.length>0,a.checked||vm.metrics.push(a)})}function toggleSelectionMetric(a){a.checked=!a.checked,a.checked?vm.selectedMetrics.push(a):lodash.remove(vm.selectedMetrics,{id:a.id})}function changeAvailabilityTimeRange(a){vm.selectedAvailabilityTimeRangeType=a,vm.selectedAvailabilityTimeRange=configurationByMonitoringMode[vm.selectedAvailabilityTimeRangeType],vm.refreshSlider()}function next(){$log.debug("[Action: NEXT ] - current step id : "+vm.currentStep),vm.currentStep++,gotoStep(vm.currentStep),$log.debug("[Action: NEXT ] - new step id : "+vm.currentStep)}function previous(){$log.debug("[Action: PREVIOUS ] - current step id : "+vm.currentStep),vm.currentStep--,gotoStep(vm.currentStep),$log.debug("[Action: PREVIOUS ] - new step id : "+vm.currentStep)}function submit(){function a(a){return UtilService.formatNumberedHour(a)}$log.debug("[Action: SUBMIT FORM ] - send form to server");var b=[],c="",d=[],e="",f=[],g=[];angular.forEach(vm.selectedAvailabilityTimeRange.weekdays,function(c,e){$log.debug("Item: ["+c.index+"] isChecked? : "+c.checked+", start:"+c.startHour+", end:"+c.endHour);var f=c.checked?a(c.startHour):"08:00";f+="-",f+=c.checked?a(c.endHour):"18:00",d.push(f),b.push(c.checked?"1":"0")}),c=b.join(";"),e=d.join(";"),angular.forEach(vm.selectedMonitoringChecks,function(a,b){f.push({id:a.id})}),angular.forEach(vm.selectedMetrics,function(a,b){g.push({id:a.id,type:a.type,hostName:a.hostName})});var h={id:vm.indicatorId,serviceId:globalServiceId,name:vm.indicatorName,definition:{availabilityWarn:vm.availabilityRate.warn/100,availabilityTarget:vm.availabilityRate.target/100,dayMask:c,periodMask:e,checks:f,metrics:g}},i=null;i=vm.editMode?IndicatorService.updateIndicator(globalServiceId,h):IndicatorService.createIndicator(globalServiceId,h),i.then(function(a){$uibModalInstance.close(a.data)},function(a){$log.error("Error managing indicator - compute the errors"),computeCheckedErrorsFromServer(a.data)})}function cancel(){$uibModalInstance.dismiss("cancel")}var vm=this;vm.loaded=!1,vm.modelWizard=void 0,vm.monitoringChecks=void 0,vm.monitoringMetrics=void 0,vm.isCurrentFormValid=!1,vm.displayedCollectionNagiosChecks=[],vm.displayedCollectionNagiosMetrics=[],vm.indicatorNotExist=!1,vm.personalizedMonitoringDataInvalid=!1,vm.searchMonitoringChecksResults=[],vm.steps=[],vm.wizardForm={},vm.monitoringChecksLoading=!1,vm.metricsLoading=!1,vm.changeAvailabilityTimeRange=changeAvailabilityTimeRange,vm.cancel=cancel,vm.next=next,vm.previous=previous,vm.submit=submit,vm.refreshSlider=refreshSlider,vm.gotoStep=gotoStep,vm.previousAuthorized=previousAuthorized,vm.nextAuthorize=nextAuthorized,vm.checkIndicatorName=checkIndicatorName,vm.regexAppName=new RegExp("^[-_\\s\\w-]{1,}$","i"),vm.regexAppTab=new RegExp("[\\t]","i"),vm.getServiceMonitoringChecks=getServiceMonitoringChecks,vm.toggleSelectionMonitoringCheck=toggleSelectionMonitoringCheck,vm.searchMonitoringChecks=searchMonitoringChecks,vm.selectSearchMonitoringCheck=selectSearchMonitoringCheck,vm.getServiceMetrics=getServiceMetrics,vm.toggleSelectionMetric=toggleSelectionMetric,vm.searchMetrics=searchMetrics,vm.selectSearchMetric=selectSearchMetric;var computeCheckedErrorsFromServer=computeCheckedErrorsFromServer,handleWorkFlow=gotoStep,retrieveNagiosMetrics=getServiceMetrics,globalServiceId=globalServiceId,configurationByMonitoringMode=void 0,DEFAULT_AVAILABILITY_RATE_TARGET=99.5,DEFAULT_AVAILABILITY_RATE_WARN=97;activate()}angular.module("itcare.services").controller("IndicatorEditionCtrl",["$scope","$state","$timeout","$uibModalInstance","$log","errorProvider","lodash","globalServiceId","CiService","TranslationService","indicator","$q","IndicatorService","UtilService",IndicatorEditionCtrl])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.snapshotForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.description="",j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("CreateSnapshotCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){G.steps=[{label:"MAINTENANCE_WIZARD_STEP_CHOICE",icon:"fa-at"},{label:"MAINTENANCE_WIZARD_STEP_RESOURCE",icon:"fa-check-square-o"},{label:"MAINTENANCE_WIZARD_STEP_SCHEDULE",icon:"fa-calendar-o"}],G.currentStep=0,void 0!=j&&(G.instanceSelection=j.name),void 0!=k&&(G.clusterSelection=k.name),void 0!=i&&(G.loadBalancerSelection=i.url),void 0!=l&&(G.serviceSelection=l.name)}function r(){G.linkedLB=[],G.customSelection=[],G.customSelectionTable=[],G.serviceInstance=[],G.serviceCluster=[],G.serviceLB=[],G.autocompleteSelection=void 0,G.selectionIsSet=!1,G.selectedAll=!1}function s(){switch(G.synthesisInstance=[],G.synthesisCluster=[],G.synthesisLB=[],G.choiceMode){case 0:void 0!=j&&G.synthesisInstance.push({id:j.id,name:j.name,resourceType:H}),void 0!=k&&G.synthesisCluster.push({id:k.id,name:k.name,resourceType:I}),void 0!=i&&G.synthesisLB.push({id:i.url,name:i.url,resourceType:J}),angular.forEach(G.linkedLB,function(a){1==a.selected&&G.synthesisLB.push({id:a.url,name:a.url,resourceType:J})});break;case 1:angular.forEach(G.serviceInstance,function(a){1==a.selected&&G.synthesisInstance.push({id:a.id,name:a.name,resourceType:H})}),angular.forEach(G.synthesisCluster,function(a){1==a.selected&&G.synthesisCluster.push({id:a.id,name:a.name,resourceType:I})}),angular.forEach(G.serviceLB,function(a){1==a.selected&&G.synthesisLB.push({id:a.url,name:a.url,resourceType:J})});break;case 2:angular.forEach(G.customSelectionTable,function(a){1==a.selected&&(a.resourceType==J?G.synthesisLB.push({id:a.name,name:a.name,resourceType:J}):a.resourceType==I?G.synthesisCluster.push({id:a.id,name:a.name,resourceType:I}):G.synthesisInstance.push({id:a.id,name:a.name,resourceType:H}))}),angular.forEach(G.linkedLB,function(a){1==a.selected&&G.synthesisLB.push({id:a.url,name:a.url,resourceType:J})})}}function t(){switch(G.isNextAuthorized=!1,G.currentStep){case 0:G.isNextAuthorized=!0;break;case 1:1==G.choiceMode&&(angular.forEach(G.serviceInstance,function(a){1==a.selected&&(G.isNextAuthorized=!0)}),angular.forEach(G.serviceCluster,function(a){1==a.selected&&(G.isNextAuthorized=!0)}),angular.forEach(G.serviceLB,function(a){1==a.selected&&(G.isNextAuthorized=!0)})),2==G.choiceMode&&angular.forEach(G.customSelectionTable,function(a){1==a.selected&&(G.isNextAuthorized=!0)}),G.linkedLB.length>0&&(G.isNextAuthorized=!0);break;case 2:G.isNextAuthorized=!0}}function u(a){angular.forEach(a,function(a){!a.actionsInProgress.length>0&&a.monitoringEnabled&&(a.selected=G.selectedAll)})}function v(){return!0}function w(){if(e.debug("[Action: NEXT ] - current step id : "+G.currentStep),G.isNextAuthorized){switch(G.choiceMode){case 0:0==G.currentStep?(r(),G.instanceSelection?A(j.id,y):(G.synthesisLB=[],G.synthesisLB.push({name:G.loadBalancerSelection}),y())):1==G.currentStep&&(s(),G.currentStep++),t();break;case 1:0==G.currentStep?(r(),m.getResourcesByServiceId(l.id,!0,!0).then(function(a){G.serviceInstance=a.data.instances,angular.forEach(G.serviceInstance,function(a){var b=G.serviceInstance.indexOf(a);a.monitoringEnabled&&!a.actionsInProgress.length>0&&(a.selected=!0),G.serviceInstance[b]=a}),G.serviceCluster=a.data.clusters,angular.forEach(G.serviceCluster,function(a){var b=G.serviceCluster.indexOf(a);a.monitoringEnabled&&!a.actionsInProgress.length>0&&(a.selected=!0),G.serviceCluster[b]=a}),G.serviceLB=a.data.loadbalancers,angular.forEach(G.serviceLB,function(a){var b=G.serviceLB.indexOf(a);a.monitoringEnabled&&!a.actionsInProgress.length>0&&(a.selected=!0),G.serviceLB[b]=a}),G.selectedAll=!0,t()}),G.currentStep++):1==G.currentStep&&(s(),G.currentStep++),t();break;case 2:0==G.currentStep?(r(),G.currentStep++):1==G.currentStep&&(G.customSelection.length>0&&0==G.linkedLB.length?A(G.customSelection,y):(s(),G.currentStep++)),t()}e.debug("[Action: NEXT ] - new step id : "+G.currentStep)}}function x(){switch(e.debug("[Action: PREVIOUS ] - current step id : "+G.currentStep),G.choiceMode){case 0:2==G.currentStep?z():1==G.currentStep&&G.currentStep--;break;case 1:case 2:2==G.currentStep?G.currentStep--:1==G.currentStep&&G.currentStep--}0==G.currentStep&&(G.isNextAuthorized=!0),e.debug("[Action: PREVIOUS ] - new step id : "+G.currentStep)}function y(){G.linkedLB.length>0?G.currentStep=1:(G.currentStep=2,s())}function z(){G.linkedLB.length>0?G.currentStep--:G.currentStep=0}function A(a,b){G.linkedLB=[],m.getLoadBalancersByLinkedResources(a).then(function(a){angular.isDefined(a)&&200==a.status&&(G.linkedLB=a.data,b(),G.selectedAll=!1)},function(a){e.error("Failed to loading LB : "+a)})}function B(a){return m.searchResources(a).then(function(a){return a.data})}function C(a,b,c,d){if(a.monitoringEnabled&&!a.actionsInProgress.length>0){e.debug("selecting ci "+a),a.selected=!0,G.autocompleteSelection=a.name,G.autocompleteSelectionError=void 0;var f=G.customSelection.indexOf(a.id);-1!==f?G.customSelectionTable[f]=a:(G.customSelection.push(a.id),G.customSelectionTable.push(a)),G.updateSelectedAll(G.customSelectionTable),G.nextAuthorize()}else G.autocompleteSelection=void 0,G.autocompleteSelectionError=n.get("MAINTENANCE_WIZARD_FORM_FIELD_SELECTION_CUSTOM_ERROR").format([a.name])}function D(a){var b=0;G.selectedAll=!1,angular.forEach(a,function(a){(1==a.selected||!a.monitoringEnabled||a.actionsInProgress.length>0)&&b++}),b==a.length&&(G.selectedAll=!0)}function E(){G.form.$valid&&d.close(G),e.debug("[Action: SUBMIT FORM ] - send form to server")}function F(){d.dismiss("cancel")}var G=this,H=n.get("INSTANCE"),I=n.get("CLUSTER"),J=n.get("LOADBALANCER");G.steps=[],G.choiceMode=h,G.instanceSelection=void 0,G.clusterSelection=void 0,G.loadBalancerSelection=void 0,G.serviceSelection=void 0,G.linkedLB=[],G.customSelection=[],G.customSelectionTable=[],G.autocompleteSelection=void 0,G.autocompleteSelectionError=void 0,G.serviceInstance=[],G.serviceCluster=[],G.serviceLB=[],G.synthesisInstance=[],G.synthesisCluster=[],G.synthesisLB=[],G.isNextAuthorized=!0,G.selectedAll=!1,G.selectionIsSet=!1,G.description="",G.rfc="",G.ranges={startDate:null,endDate:null},G.minDate=moment(),G.rangePickerAutoClose="always",G.optionsCalendar={showDropdowns:!0,timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,alwaysShowCalendars:!0,dateLimit:{months:6},buttonClasses:["btn","btn-sm","btn-block"],applyClass:"btn-success",cancelClass:"btn-default",locale:{customRangeLabel:n.get("PERIOD_CUSTOM"),format:"L LT",applyLabel:n.get("OK"),cancelLabel:n.get("CANCEL")},opens:"right",eventHandlers:{"apply.daterangepicker":function(a){moment(G.ranges.startDate).format("MM.DD.YYYY HH:mm:ss"),moment(G.ranges.endDate).format("MM.DD.YYYY HH:mm:ss")},"hide.daterangepicker":function(a){},"cancel.daterangepicker":function(a){}}},G.cancel=F,G.next=w,G.previous=x,G.submitMaintenance=E,G.searchResources=B,G.setCustomSelection=C,G.checkAll=u,G.updateSelectedAll=D,G.previousAuthorized=v,G.nextAuthorize=t,q(),a.authoritiesFilter=function(a){return g.filter(a.availableActions,function(a){return"create-maintenance"==a.operation&&1==a.available})}}angular.module("itcare.services").controller("CreateMaintenanceCtrl",["$scope","$state","$timeout","$uibModalInstance","$log","errorProvider","lodash","choiceMode","loadBalancerSelection","instanceSelection","clusterSelection","serviceSelection","CiService","TranslationService","$q","UtilService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){ca.steps=[{label:"PLATFORM",icon:"fa-at"},{label:"RESOURCES",icon:"fa-tachometer"},{label:"LOCALIZATION",icon:"fa-globe"},{label:"NETWORK",icon:"fa-sitemap"},{label:"AUTHENTICATION",icon:"fa-users"},{label:"STORAGE",icon:"fa-hdd-o"},{label:"MANAGEMENT",icon:"fa-calendar-check-o"},{label:"CUSTOMIZATION",icon:"fa-table"},{label:"SPECIFICREQUEST",icon:"fa-sticky-note-o"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-bars"}],ca.customizationStep={label:"CUSTOMIZATION",icon:"fa-table"},ca.currentStep="PLATFORM",ca.platformsLoading=!0,n.all({platforms:o.getPlatforms()}).then(function(a){ca.platformsLoading=!1,ca.platforms=a.platforms.data,angular.forEach(a.platforms.data,function(a,b){a.properties=i.filter(a.properties,function(a){return!0===a.displayed})})},function(){ca.platformsLoading=!1}),ca.loaded=!0,ca.instanceName="",ca.selectedPlatform=null,ca.selectedResources=null,ca.selectedRegion=null,ca.selectedArea=null,ca.selectedAvailabilityZone=null,ca.selectedRole=null,ca.selectedNetwork=null,ca.selectedAuthenticationDomain=null,ca.monitoringEnabled=!1,ca.monitoring247Enabled=!1,ca.backupEnabled=!1,ca.backupRemoteSiteEnabled=!1,ca.debugModeEnabled=!1,ca.dryRunEnabled=!1,ca.specificRequest="",ca.errors="",ca.canDebugAutomation=!1,ca.creationLoading=!1}function t(){if(ca.availableName=!1,!_.isEmpty(ca.instanceName)){o.checkInstanceName(ca.instanceName).then(function(a){if(ca.availableName=a.data,ca.wizardForm.name)if(ca.wizardForm.name.$setValidity("notPresent",ca.availableName),ca.wizardForm.name.$setValidity("firstPatternValid",ca.firstPatternName.test(ca.instanceName)),null!=ca.selectedPlatform.namingRule){var b=ca.selectedPlatform.namingRule;ca.selectedPlatform.namingRule.indexOf("#ENV#")&&(b=b.replace("#ENV#",j.environment.charAt(0))),ca.selectedPlatform.namingRule.indexOf("#LOC#")&&(b=b.replace("#LOC#",ca.selectedAvailabilityZone.datacenterId)),ca.customPatternName=new RegExp(b,"i"),ca.wizardForm.name.$setValidity("customPatternValid",ca.customPatternName.test(ca.instanceName))}else ca.wizardForm.name.$setValidity("secondPatternValid",ca.secondPatternName.test(ca.instanceName)),ca.wizardForm.name.$setValidity("thirdPatternValid",ca.thirdPatternName.test(ca.instanceName))})}}function u(a){ca.selectedPlatform=a,ca.selectResources(null)}function v(a){ca.selectedResourcesIdx=a,w(void 0!==ca.resources[a]?ca.resources[a]:null)}function w(a){null==a?(ca.selectedResources=null,ca.selectRegion()):(ca.selectedPlatform&&ca.selectedPlatform.vcpus!=a.vcpus&&ca.selectedPlatform.ram!=a.ram&&ca.selectRegion(),ca.selectedResources=a)}function x(){null==ca.selectedRegion?ca.selectAvailabilityZone(null):(ca.selectAvailabilityZone(null),B())}function y(a){ca.selectedAvailabilityZone=a,ca.selectedArea=null==a||null==a.area?null:a.area}function z(a){ca.selectedRole=a||i.first(i.filter(ca.roles,function(a){return"mixed"==a.id})),ca.selectNetwork(null),A()}function A(){if(ca.networks=void 0,null!=ca.selectedRole){o.getNetworksByRegionAndAreaAndAvailabilityZone(ca.selectedRegion.id,ca.selectedAvailabilityZone.area.id,ca.selectedAvailabilityZone.id,ca.selectedRole.id).then(function(a){ca.networks=i.orderBy(a.data,["defaultNetwork","name"],["desc","asc"]),i.forEach(ca.networks,function(a){a.defaultNetwork&&ca.selectNetwork(a)})})}}function B(){o.getAreasByRegionWithPlatform(ca.selectedRegion.id,ca.selectedPlatform.id).then(function(a){ca.areas=i.orderBy(a.data,["defaultArea","id"],["desc","asc"]),ca.availabilityZones=[],i.forEach(ca.areas,function(a){i.forEach(a.availabilityZones,function(b){b.area=angular.copy(a,b.area),ca.availabilityZones=ca.availabilityZones.concat(b)})}),g.info(ca.availabilityZones),i.forEach(ca.availabilityZones,function(a){a.defaultZone&&a.area.defaultArea&&ca.selectAvailabilityZone(a)})})}function C(){o.getAuthenticationDomainsByNetwork(ca.selectedRegion.id,ca.selectedAvailabilityZone.area.id,ca.selectedAvailabilityZone.id,ca.selectedNetwork.id).then(function(a){ca.authenticationDomains=a.data,ca.authenticationDomains.length>0&&(ca.selectedAuthenticationDomain=ca.authenticationDomains[0],ca.selectAuthenticationDomain(ca.selectedAuthenticationDomain))})}function D(){if(null==ca.selectedPlatform.namingRule){o.getSuggestedHostNames(j.id,ca.selectedRegion.id,ca.selectedPlatform.id).then(function(a){angular.forEach(a.data,function(a){a.translatedReason=m.get(a.reason,a.reasonArgs)}),ca.suggestedHostNames=a.data})}}function E(b){o.getPlatform(b.id).then(function(b){b.data.formYamlDefinition?r.getFormInstanceFromYaml(b.data.formYamlDefinition,a.lang).then(function(a){ca.form=a},function(a){ca.form=void 0,g.error(a)}):ca.form=void 0;var c=ca.selectedPlatform.storage;ca.selectedPlatform=b.data,ca.selectedPlatform.storage=c,X()},function(){})}function F(a){void 0!==a&&angular.forEach(ca.form.fields,function(a){angular.forEach(ca.selectedPlatform.properties,function(b){a.id==b.key&&(b.value=a.value,"password"==a.type&&(b.hide=!0),"password"!=a.type&&(b.hide=!1))})}),ca.displayCustomization=!1,G(),g.info(ca.selectedPlatform.properties)}function G(){angular.forEach(ca.selectedPlatform.properties,function(a){if(a.editable&&a.displayed)return void(ca.displayCustomization=!0)})}function H(a){ca.selectedNetwork=a,null==ca.selectedNetwork&&ca.selectAuthenticationDomain(null)}function I(a,b,c,d){ca.instanceName=a.hostName,t()}function J(a){ca.selectedAuthenticationDomain=a}function K(){var a=da+(ca.selectedPlatform.storage.volumes.length+1);ca.selectedPlatform.storage.volumes.push({id:a,description:a,sizeGb:ca.selectedPlatform.storage.minVolumeSize,min:ca.selectedPlatform.storage.minVolumeSize,mandatory:!1,editable:!0})}function L(a){ca.selectedPlatform.storage.volumes[a].mandatory||ca.selectedPlatform.storage.volumes.splice(a,1)}function M(){(ca.backupEnabled||ca.monitoring247Enabled)&&(ca.monitoringEnabled=!0)}function N(){}function O(){}function P(){ca.monitoringEnabled=!1,ca.backupEnabled=!1,ca.monitoring247Enabled=!1}function Q(a){ca.wizardForm.volumeEdition=a;var b=0,c=!1,d=!1;ca.wizardForm.$setValidity("totalSize",!0),ca.wizardForm.$setValidity("minSize",!0),ca.wizardForm.$setValidity("maxSize",!0),ca.wizardForm.$setValidity("isNumber",!0),angular.forEach(ca.selectedPlatform.storage.volumes,function(a,e){!isNaN(a.sizeGb)&&angular.isNumber(+a.sizeGb)&&(b=+a.sizeGb+b),a.sizeGb<ca.selectedPlatform.storage.volumes[e].min&&(c=!0),a.sizeGb>ca.selectedPlatform.storage.volumes[e].max&&(d=!0)}),ca.selectedPlatform.storage.totalVolumesSize>b||ca.wizardForm.$setValidity("totalSize",!1),c&&ca.wizardForm.$setValidity("minSize",!1),0===a.id.lastIndexOf(da,0)&&a.sizeGb<ca.selectedPlatform.storage.minVolumeSize&&ca.wizardForm.$setValidity("minSize",!1),d&&ca.wizardForm.$setValidity("maxSize",!1),!isNaN(a.sizeGb)&&angular.isNumber(+a.sizeGb)||ca.wizardForm.$setValidity("isNumber",!1),0===ca.selectedPlatform.storage.volumes.length&&ca.wizardForm.$setValidity("volumesEmpty",!1)}function R(){d(function(){b.$broadcast("rzSliderForceRender")})}function S(){switch(ca.currentStep){case"PLATFORM":return null!==ca.selectedPlatform;case"RESOURCES":return null!==ca.selectedResources;case"LOCALIZATION":return null!==ca.selectedRegion&&null!==ca.selectedAvailabilityZone;case"NETWORK":return null!==ca.selectedRole&&null!==ca.selectedNetwork;case"AUTHENTICATION":return null!==ca.selectedAuthenticationDomain;case"STORAGE":return ca.wizardForm.$valid;case"MANAGEMENT":case"SPECIFICREQUEST":case"APP_WIZARD_STEP_SYNTHESIS":return!0;case"CUSTOMIZATION":return void 0===ca.form?ca.wizardForm.name.$valid:ca.wizardForm.name.$valid&&ca.form&&ca.form.isValid()}}function T(){return!0}function U(a){ca.refreshSlider(),ca.currentStep}function V(){switch(ca.currentStep){case"PLATFORM":ca.resources=i.orderBy(i.first(i.filter(ca.platforms,function(a){return a.id==ca.selectedPlatform.id})).resources,["vcpus","ram"],["asc","asc"]),v(0),ca.resourcesSliderOptions={floor:0,ceil:ca.resources.length-1,showTicks:1,hideLimitLabels:!0,onEnd:function(a){g.debug(ca.selectedResourcesIdx),v(ca.selectedResourcesIdx)},translate:function(a,b,c){return""}},ca.regions=i.orderBy(i.first(i.filter(ca.platforms,function(a){return a.id==ca.selectedPlatform.id})).regions,["id"],["asc"]),ca.currentStep="RESOURCES";break;case"RESOURCES":o.getRegionsAvailableOnPlatform(ca.selectedPlatform.id).then(function(a){ca.regions=i.orderBy(a.data,["id"],["asc"]),ca.regions.length>0&&(ca.selectedRegion=ca.regions[0],x())}),ca.currentStep="LOCALIZATION";break;case"LOCALIZATION":z(i.first(i.filter(ca.roles,function(a){return null!=ca.selectedPlatform.scope&&a.id==ca.selectedPlatform.scope.toLocaleLowerCase()}))),ca.currentStep="NETWORK";break;case"NETWORK":ca.currentStep="AUTHENTICATION",C();break;case"AUTHENTICATION":ca.currentStep="STORAGE";break;case"STORAGE":ca.currentStep="MANAGEMENT",P(),null!=ca.selectedPlatform.namingRule&&(ca.namingRegex=ca.selectedPlatform.namingRule,ca.selectedPlatform.namingRule.indexOf("#ENV#")&&(ca.namingRegex=ca.namingRegex.replace("#ENV#",j.environment.charAt(0))),ca.selectedPlatform.namingRule.indexOf("#LOC#")&&(ca.namingRegex=ca.namingRegex.replace("#LOC#",ca.selectedAvailabilityZone.datacenterId))),D(),E(ca.selectedPlatform);break;case"MANAGEMENT":ca.currentStep="CUSTOMIZATION",t();break;case"CUSTOMIZATION":ca.currentStep="SPECIFICREQUEST",F(ca.form);break;case"SPECIFICREQUEST":ca.canDebugAutomation=ba(l.getCurrentUser().authorities,"AUTO_DEBUG"),ca.currentStep="APP_WIZARD_STEP_SYNTHESIS"}U(ca.currentStep)}function W(){switch(ca.currentStep){case"RESOURCES":ca.currentStep="PLATFORM";break;case"LOCALIZATION":ca.currentStep="RESOURCES";break;case"NETWORK":ca.currentStep="LOCALIZATION";break;case"AUTHENTICATION":ca.currentStep="NETWORK";break;case"STORAGE":ca.currentStep="AUTHENTICATION";break;case"MANAGEMENT":ca.currentStep="STORAGE";break;case"CUSTOMIZATION":ca.currentStep="MANAGEMENT";break;case"SPECIFICREQUEST":ca.currentStep="CUSTOMIZATION";break;case"APP_WIZARD_STEP_SYNTHESIS":ca.currentStep="SPECIFICREQUEST"}U(ca.currentStep)}function X(){angular.forEach(["namingRuleDesc"],function(a){ca.selectedPlatform[a]=Y(ca.selectedPlatform,a)})}function Y(b,c){if(void 0===b||void 0===c||null===c||""===c.trim())return"";var d=c+"En",e=c+"Fr";"fr"===a.lang&&(d=c+"Fr",e=c+"En");var f=b[d],g=b[e];return void 0===f||null===f||""===f.trim()?void 0===g||null===g||""===g.trim()?"":g:f}function Z(){ca.creationLoading=!0,o.createInstance(ca.instanceName,j.id,ca.selectedPlatform.id,ca.selectedRegion.id,ca.selectedArea.id,ca.selectedAvailabilityZone.id,ca.selectedNetwork.id,ca.selectedResources.id,ca.selectedPlatform.storage.volumes,ca.selectedPlatform.properties,ca.backupRemoteSiteEnabled,ca.backupEnabled,ca.monitoring247Enabled,ca.monitoringEnabled,ca.selectedAuthenticationDomain.id,ca.specificRequest,ca.debugModeEnabled,ca.dryRunEnabled).then(function(a){ca.creationLoading=!1,202!==a.status?g.debug("there is no automation for this instance, status "+a.status):(e.pop("success",m.get("ACTION_CONFIRM_CREATE_VM")),ca.dryRunEnabled||f.close())},function(a){ca.creationLoading=!1,g.error("Failed to create vm: "+a.data[0].code)})}function $(){f.dismiss("cancel")}function aa(){q.displayModal("definition-regions-availability-zones",{size:"md"})}function ba(a,b){return a.indexOf(b)>-1}var ca=this,da="disk-";ca.loaded=!1,ca.modelWizard=void 0,ca.isCurrentFormValid=!1,ca.steps=[],ca.customizationStep=[],ca.wizardForm={},ca.wizardForm.volumeEdition=void 0,ca.firstPatternName=new RegExp("^["+j.environment.charAt(0)+"]","i"),ca.secondPatternName=new RegExp("^["+j.environment.charAt(0)+"][A-Z0-9]{1,12}","i"),ca.thirdPatternName=new RegExp("[0-9]{2,3}?$","i"),ca.platforms=[],ca.platformsLoading=!1,ca.resources=[],ca.selectedResourcesIdx=0,ca.resourcesSliderOptions={},ca.regions=[],ca.availabilityZones=void 0,ca.networks=void 0,ca.authenticationDomains=void 0,ca.suggestedHostNames=[],ca.roles=[{id:"frontend",icon:"fa-globe",name:"Frontend",description:m.get("CREATEVM_NETWORK_ROLE_FRONTEND")},{id:"backend",icon:"fa-database",name:"Backend",description:m.get("CREATEVM_NETWORK_ROLE_BACKEND")},{id:"mixed",icon:"fa-list",name:m.get("ALL"),description:m.get("CREATEVM_NETWORK_ROLE_ALL")}],ca.cancel=$,ca.next=V,ca.previous=W,ca.submit=Z,ca.refreshSlider=R,ca.gotoStep=U,ca.previousAuthorized=T,ca.nextAuthorized=S,ca.checkInstanceName=t,ca.selectPlatform=u,ca.selectPlatformCustomization=E,ca.selectResources=w,ca.selectResourcesByIndex=v,ca.selectRegion=x,ca.selectAvailabilityZone=y,ca.displayHelpRegionAZ=aa,ca.selectRole=z,ca.selectNetwork=H,ca.selectAuthenticationDomain=J,ca.addVolume=K,ca.validateVolumeSize=Q,ca.removeVolume=L,ca.updateManagementAndMonitoring=M,ca.selectHostName=I,ca.updateDebugMode=N,ca.updateDryRun=O,s()}angular.module("itcare.services").controller("InstanceCreationCtrl",["$rootScope","$scope","$state","$timeout","toaster","$uibModalInstance","$log","errorProvider","lodash","service","CiService","UserService","TranslationService","$q","InstanceService","UtilService","HelpService","MFForm",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){u.steps=[{label:"MAINTENANCE_WIZARD_STEP_RESOURCE",icon:"fa-check-square-o"}],u.currentStep=0,p(i)}function o(a){angular.forEach(a,function(a){a.selected=u.selectedAll})}function p(a){u.resources=[],j.getResourcesMaintenance(a).then(function(a){angular.isDefined(a)&&200==a.status&&(u.resources=a.data.resources)},function(b){e.error("Failed loading resources of maintenance id = : "+a+", reason: "+b)})}function q(a){var b=0;u.selectedAll=!1,angular.forEach(a,function(a){1==a.selected&&b++}),b==a.length&&(u.selectedAll=!0)}function r(a){var b=0;return angular.forEach(a,function(a){a.selected&&b++}),b}function s(){var a=0;angular.forEach(u.resources,function(b){1==b.selected&&(a++,b.resourceType==v&&u.instancesToDelete.push(b.id),b.resourceType==w&&u.loadBalancersToDelete.push(b.name))}),0!=a&&(e.debug("[Action: SUBMIT FORM ] - send form to server"),d.close(u))}function t(){d.dismiss("cancel")}var u=this,v=k.get("INSTANCE"),w=k.get("LOADBALANCER");u.resources=[],u.instancesToDelete=[],u.loadBalancersToDelete=[],u.maintenanceId=i,u.computeResourceByMaintenanceId=p,u.selectedAll=!1,u.cancel=t,u.submit=s,u.checkAll=o,u.updateSelectedAll=q,u.launchAuthorized=r,n()}angular.module("itcare.services").controller("DeleteMaintenanceCtrl",["$scope","$state","$timeout","$uibModalInstance","$log","errorProvider","toaster","lodash","maintenanceId","CiService","TranslationService","$q","UtilService",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.desactivateForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DesactivateInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){b.close(i)}function h(){b.dismiss("cancel")}var i=this;i.loaded=!1,i.cancel=h,i.ok=g}angular.module("itcare.services").controller("ActivateInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.deleteForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DeleteInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.form.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.comment="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("ResetInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.form.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.comment="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DisableMonitoringInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.form.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.comment="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("EnableMonitoringInstanceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.form.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.comment="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("RecoverSnapshotCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.form.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.comment="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DeleteSnapshotCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){b.close(i)}function h(){b.dismiss("cancel")}var i=this;i.loaded=!1,i.cancel=h,i.ok=g}angular.module("itcare.services").controller("ActivateLoadBalancerCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.desactivateForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DesactivateLoadBalancerCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.deleteForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DeleteLoadBalancerCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){Z.steps=[{label:"MEMBERS",icon:"fa-cubes"},{label:"NETWORK",icon:"fa-sitemap"},{label:"PROFILE",icon:"fa-user"},{label:"NAME",icon:"fa-link"},{label:"CUSTOMIZATION",icon:"fa-table"},{label:"MANAGEMENT",icon:"fa-calendar-check-o"},{label:"APP_WIZARD_STEP_SYNTHESIS",icon:"fa-bars"}],Z.customizationStep={label:"NAME",icon:"fa-table"},Z.portMembers=[{value:"*",label:"All Ports"},{value:21,label:"FTP"},{value:80,label:"HTTP"},{value:443,label:"HTTPS"},{value:23,label:"TELNET"},{value:1723,label:"PPTP"},{value:25,label:"SMTP"},{value:161,label:"SNMP"},{value:162,label:"SNMP-TRAP"},{value:22,label:"SSH"},{value:69,label:"TFTP"},{value:1433,label:"MS SQL"}],Z.currentStep="MEMBERS",Z.searchIsLoading=!0,m.all({members:k.getServiceDetailNetworkByGlobalServiceId(j.id)}).then(function(a){Z.searchIsLoading=!1,Z.members=a.members.data.instances,angular.forEach(a.members.data.instances,function(a){null==a.memberNetwork?a.isEligible=!1:a.isEligible=!0})},function(){Z.searchIsLoading=!1}),Z.selectedMembers=[],Z.eligibleMembers=[],Z.selectedPlatform=null,Z.selectedProfile=null,Z.selectedPortMember=null,Z.portMemberValue=null,Z.sslConfigured=!1,Z.selectedRegion=null,Z.customSelection=[],Z.customSelectionTable=[],Z.autocompleteSelection=void 0,Z.domainUrl=null,Z.loaded=!0,Z.subDomain="",Z.selectedResources=null,Z.selectedAvailabilityZone=null,Z.selectedAvailabilityZoneValue=null,Z.selectedHealthCheck=null,Z.selectedSSLProfile=null,Z.selectedCertificate=null,Z.selectedRole=null,Z.selectedNetwork=null,Z.monitoringEnabled=!1,Z.monitoring247Enabled=!1,Z.setupDns=!0,Z.debugModeEnabled=!1,Z.dryRunEnabled=!1,Z.canDebugAutomation=!1,Z.errors=""}function r(a){a.checked=!a.checked,a.checked?(Z.selectedMembers.push(a),s(Z.members,a)):i.remove(Z.selectedMembers,{id:a.id}),Z.eligibleMembers=Z.selectedMembers,0==Z.eligibleMembers.length&&angular.forEach(Z.members,function(a){null==a.memberNetwork?a.isEligible=!1:a.isEligible=!0})}function s(a,b){angular.forEach(a,function(a){return null==b.memberNetwork?void(a.isEligible=!1):null==a.memberNetwork?void(a.isEligible=!1):void(a.memberNetwork.area==b.memberNetwork.area&&a.memberNetwork.id==b.memberNetwork.id?a.isEligible=!0:a.isEligible=!1)})}function t(){Z.availableUrl=!1;var a=Z.subDomain+"."+Z.autocompleteSelection.toLocaleLowerCase();n.checkUrlValidity(a).then(function(b){Z.availableUrl=b.data,Z.wizardForm.nameUrl&&(Z.wizardForm.nameUrl.$setValidity("notPresent",Z.availableUrl),Z.wizardForm.nameUrl.$setValidity("subDomainPatternName",Z.subDomainPatternName.test(a)))})}function u(){null==Z.selectedRegion?Z.selectAvailabilityZone(null):(Z.selectAvailabilityZone(null),C())}function v(){null==Z.selectedProfile?Z.selectHealthCheck(null):(Z.selectHealthCheck(null),I())}function w(){J()}function x(){null!=Z.selectedPortMember&&(Z.portMemberValue=Z.selectedPortMember.value),null!=Z.selectedPortMember&&Z.wizardForm.portMember.$setValidity("portMembersPattern",Z.portMembersPattern.test(Z.selectedPortMember.value)),f.debug("selected port member ... "+Z.portMemberValue)}function y(a){Z.selectedAvailabilityZone=a,Z.selectedAvailabilityZoneValue=Z.selectedAvailabilityZone.id}function z(){return Z.selectedHealthCheck}function A(a){Z.selectedCertificate=a,J()}function B(){if(Z.networks=void 0,Z.eligibleMembers.length>0){n.getNetworksByLoadBalancingZoneAndRegion(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area).then(function(a){Z.networks=i.orderBy(a.data,["defaultNetwork","name"],["desc","asc"]),i.forEach(Z.networks,function(a){a.defaultNetwork&&Z.selectNetwork(a)}),K(i.first(i.filter(Z.roles,function(a){return Z.networks.length>0&&a.id==Z.networks[0].scope.toLocaleLowerCase()})))})}}function C(){if(Z.networks=void 0,null!=Z.selectedRole&&Z.eligibleMembers.length>0){n.getNetworksByLoadBalancingZoneAndRegion(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area,Z.selectedRole.id).then(function(a){Z.networks=i.orderBy(a.data,["defaultNetwork","name"],["desc","asc"]),i.forEach(Z.networks,function(a){a.defaultNetwork&&Z.selectNetwork(a)})})}}function D(){if(Z.eligibleMembers.length>0){n.getProfilesByRegionAndArea(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area).then(function(a){Z.profiles=a.data,Z.selectedProfile=Z.profiles[0],v()})}}function E(){var a=Z.autocompleteSelection,b=Z.eligibleMembers[0].memberNetwork.region,c=Z.eligibleMembers[0].memberNetwork.area;return n.getCertificates(b,c,a).then(function(a){Z.certificates=a.data,Z.selectedCertificate=Z.certificates[0],null!=Z.selectedCertificate&&w()})}function F(a,b){return n.getDomains(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area,Z.selectedProfile.name,a,b).then(function(a){var b=a.data;return M(),b})}function G(){Z.domainExists=!1;var a=Z.autocompleteSelection;n.checkDomainExistence(a,Z.setupDns).then(function(a){Z.domainExists=a.data,Z.wizardForm.autocomplete&&Z.wizardForm.autocomplete.$setValidity("notFound",Z.domainExists)})}function H(a,b,c,d){f.debug("selecting domain "+a),a.selected=!0,Z.autocompleteSelection=a.name,Z.domainUrl=a.id,f.debug("selecting domain id..."+Z.domainUrl),f.debug("selecting domain name..."+Z.autocompleteSelection);var e=Z.customSelection.indexOf(a.id);-1!==e?Z.customSelectionTable[e]=a:Z.customSelection.push(a.id),G()}function I(){if(Z.eligibleMembers.length>0){n.getHealthCheckByRegionAreaAndProfile(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area).then(function(a){Z.healthchecks=a.data,Z.selectedHealthCheck=Z.healthchecks[0]})}}function J(){if(null!=Z.selectedCertificate){f.debug("vm.selectedCertificate ..."+Z.selectedCertificate);n.getSSLProfiles(Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area,Z.selectedCertificate.certificateName).then(function(a){Z.sslProfiles=a.data,Z.selectedSSLProfile=Z.sslProfiles[0]})}}function K(a){Z.selectedRole=a||i.first(i.filter(Z.roles,function(a){return"mixed"==a.id})),Z.selectNetwork(null),C()}function L(a){Z.selectedNetwork=a}function M(){Z.monitoring247Enabled&&(Z.monitoringEnabled=!0),G()}function N(){Z.monitoringEnabled=!1,Z.setupDns=!0,Z.monitoring247Enabled=!1}function O(){switch(Z.currentStep){case"MEMBERS":return Z.eligibleMembers.length>0;case"NETWORK":return null!==Z.selectedNetwork&&null!==Z.selectedRole;case"PROFILE":return null!==Z.selectedProfile&&null!==Z.selectedHealthCheck&&Z.wizardForm.portMember.$valid;case"NAME":return""!==Z.autocompleteSelection&&void 0!==Z.autocompleteSelection&&null!==Z.domainUrl&&Z.wizardForm.autocomplete.$valid;case"MANAGEMENT":case"APP_WIZARD_STEP_SYNTHESIS":return!0;case"CUSTOMIZATION":return Z.wizardForm.nameUrl.$valid}}function P(){return!0}function Q(a){Z.currentStep}function R(){switch(Z.currentStep){case"MEMBERS":B(),Z.currentStep="NETWORK";break;case"NETWORK":D(),Z.currentStep="PROFILE";break;case"PROFILE":Z.currentStep="NAME",N();break;case"NAME":Z.currentStep="CUSTOMIZATION",Z.selectedProfile.secured?E():(Z.selectedSSLProfile=null,Z.selectedCertificate=null);break;case"CUSTOMIZATION":Z.currentStep="MANAGEMENT";break;case"MANAGEMENT":Z.currentStep="APP_WIZARD_STEP_SYNTHESIS",Z.canDebugAutomation=Y(g.getCurrentUser().authorities,"AUTO_DEBUG")}Q(Z.currentStep)}function S(){switch(Z.currentStep){case"NETWORK":Z.currentStep="MEMBERS";break;case"PROFILE":Z.currentStep="NETWORK";break;case"NAME":Z.currentStep="PROFILE";break;case"CUSTOMIZATION":Z.currentStep="NAME";break;case"MANAGEMENT":Z.currentStep="CUSTOMIZATION";break;case"APP_WIZARD_STEP_SYNTHESIS":Z.currentStep="MANAGEMENT"}Q(Z.currentStep)}function T(){var a=Z.subDomain+"."+Z.autocompleteSelection,b=null!=Z.selectedCertificate?Z.selectedCertificate.certificateName:null,c=null!=Z.selectedSSLProfile?Z.selectedSSLProfile.name:null;n.createLoadBalancer(a.toLocaleLowerCase(),j.id,Z.eligibleMembers[0].memberNetwork.region,Z.eligibleMembers[0].memberNetwork.area,Z.selectedMembers,Z.selectedNetwork.id,Z.selectedProfile.name,b,c,Z.selectedHealthCheck.name,Z.portMemberValue,Z.setupDns,Z.monitoring247Enabled,Z.monitoringEnabled,Z.debugModeEnabled,Z.dryRunEnabled).then(function(a){202!==a.status?f.debug("there is no automation for this load balancer, status "+a.status):(d.pop("success",l.get("ACTION_CONFIRM_CREATE_VS")),Z.dryRunEnabled||e.close())},function(a){f.error("Failed to create vs: "+a.data[0].code)})}function U(){e.dismiss("cancel")}function V(){p.displayModal("definition-regions-availability-zones",{size:"md"})}function W(){p.displayModal("definition-profiles-healthcheck",{size:"md"})}function X(){p.displayModal("definition-members-port",{size:"md"})}function Y(a,b){return a.indexOf(b)>-1}var Z=this;Z.loaded=!1,Z.modelWizard=void 0,Z.isCurrentFormValid=!1,Z.selectableDns=!1,Z.steps=[],Z.customizationStep=[],Z.wizardForm={},Z.subDomainPatternName=new RegExp("^[a-zA-Z][a-zA-Z0-9.-]+$","i"),Z.portMembersPattern=new RegExp("^[0-9*]+$"),Z.members=[],Z.resources=[],Z.membersIds=[],Z.selectedResourcesIdx=0,Z.searchIsLoading=!1,Z.regions=[],Z.profiles=[],Z.healthchecks=[],Z.certificates=[],Z.sslProfiles=[],Z.availabilityZones=void 0,Z.networks=void 0,Z.roles=[{id:"internet",icon:"fa-globe",name:"Internet",description:l.get("CREATEVM_NETWORK_ROLE_FRONTEND")},{id:"interco",icon:"fa-shield",name:"Interco.",description:l.get("CREATEVM_NETWORK_ROLE_FRONTEND")},{id:"private",icon:"fa-lock",name:"Private",description:l.get("CREATEVM_NETWORK_ROLE_BACKEND")},{id:"mixed",icon:"fa-list",name:l.get("ALL"),description:l.get("CREATEVM_NETWORK_ROLE_ALL")}],Z.cancel=U,Z.next=R,Z.previous=S,Z.submit=T,Z.gotoStep=Q,Z.previousAuthorized=P,Z.nextAuthorized=O,Z.toggleSelectionMember=r,Z.selectRole=K,Z.checkSubDomainValidity=t,Z.checkDomainValidity=G,Z.selectRegion=u,Z.selectProfile=v,Z.selectPortMember=x,Z.selectAvailabilityZone=y,Z.selectHealthCheck=z,Z.selectCertificat=A,Z.selectSSLProfile=w,Z.displayHelpRegionAZ=V,Z.displayHelpHealthcheck=W,Z.displayHelpPortMembers=X,Z.selectLoadBalancingZone=B,Z.getProfiles=D,Z.getCertificates=E,Z.selectNetwork=L,Z.updateManagementAndMonitoring=M,Z.setCustomSelection=H,Z.searchDomains=F,Z.eligibilityFilter=s,q()}angular.module("itcare.services").controller("LoadBalancerCreationCtrl",["$scope","$state","$timeout","toaster","$uibModalInstance","$log","UserService","errorProvider","lodash","service","CiService","TranslationService","$q","LoadBalancerService","UtilService","HelpService",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.deleteForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("DeleteNamespaceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.loaded=!0}function h(){j.namespaceForm.$valid&&b.close(j)}function i(){b.dismiss("cancel")}var j=this;j.description="",j.rfc="",j.loaded=!1,j.cancel=i,j.submit=h,g()}angular.module("itcare.services").controller("CreateNamespaceCtrl",["$scope","$uibModalInstance","$log","errorProvider","TranslationService","$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){r.loaded=!0,r.platformsLoading=!0,h.all({platforms:f.getPlatforms()}).then(function(a){r.platformsLoading=!1,r.platforms=a.platforms.data,angular.forEach(a.platforms.data,function(a,b){"rhel7"==a.id&&(r.resources=a.resources,r.resources=e.orderBy(r.resources,["vcpus","ram"],["asc","asc"]),m(0),r.resourcesSliderOptions={floor:0,ceil:r.resources.length-1,showTicks:1,hideLimitLabels:!0,onEnd:function(a){c.debug(r.selectedResourcesIdx),m(r.selectedResourcesIdx)},translate:function(a,b,c){return""}})})},function(){r.platformsLoading=!1})}function j(){r.nodesForm.$valid&&(r.nodeSizing=r.resources[r.selectedResourcesIdx].id,b.close(r))}function k(){b.dismiss("cancel")}function l(a){r.selectedPlatform=a,r.selectResources(null)}function m(a){r.selectedResourcesIdx=a,n(void 0!==r.resources[a]?r.resources[a]:null)}function n(a){null==a?(r.selectedResources=null,r.selectRegion()):(r.selectedPlatform&&r.selectedPlatform.vcpus!=a.vcpus&&r.selectedPlatform.ram!=a.ram&&r.selectRegion(),r.selectedResources=a)}function o(){null==r.selectedRegion?r.selectAvailabilityZone(null):(r.selectAvailabilityZone(null),q())}function p(a){r.selectedAvailabilityZone=a,r.selectedArea=null==a||null==a.area?null:a.area}function q(){f.getAreasByRegionWithPlatform(r.selectedRegion.id,r.selectedPlatform.id).then(function(a){r.areas=e.orderBy(a.data,["defaultArea","id"],["desc","asc"]),r.availabilityZones=[],e.forEach(r.areas,function(a){e.forEach(a.availabilityZones,function(b){b.area=angular.copy(a,b.area),r.availabilityZones=r.availabilityZones.concat(b)})}),c.info(r.availabilityZones),e.forEach(r.availabilityZones,function(a){a.defaultZone&&a.area.defaultArea&&r.selectAvailabilityZone(a)})})}var r=this;r.description="",r.rfc="",r.platforms=[],r.platformsLoading=!1,r.resources=[],r.selectedResourcesIdx=0,r.resourcesSliderOptions={},r.selectedResources=null,r.loaded=!1,r.cancel=k,r.submit=j,r.selectPlatform=l,r.selectAvailabilityZone=p,r.selectResources=n,r.selectResourcesByIndex=m,r.selectRegion=o,r.getAreasByRegion=q,i()}angular.module("itcare.services").controller("CreateNodesCtrl",["$scope","$uibModalInstance","$log","errorProvider","lodash","InstanceService","TranslationService","$q",a])}(),function(){"use strict";angular.module("itcare.services").directive("itcareCalHeatmap",["lodash","$timeout",function(a,b){return{scope:{},template:"<div id='{{ctrl.generatedId}}'/>",bindToController:{data:"=",options:"="},controllerAs:"ctrl",controller:["$scope",function(c){function d(b){return a.sortBy(b,"key"),new Date(1e3*Object.keys(b)[0])}function e(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function f(){c.$watch("ctrl.data",function(a,b){b!=a&&(h.updateQuota(a),h.options.onTooltip=function(a,b){if(j.toolTipAction)return j.toolTipAction.toolTipFunction(a,b,j.toolTipAction.series)},h.options.data=a,h.jumpTo(d(a),!0))})}var g={legend:[],itemName:[],domain:"month",subDomain:"day",domainLabelFormat:"%m-%Y",subDomainTextFormat:"%d",subDomainDateFormat:function(a){return moment(a).format("LL")},cellSize:20,cellPadding:5,domainGutter:20,dataType:"json",tooltip:!1,range:1,toolTipAction:void 0,id:e(),start:d(this.data)},h=new CalHeatMap;this.options&&angular.merge(g,this.options),this.generatedId=e(),g.generatedId=this.generatedId,g.itemSelector="#"+g.generatedId;var i=this.data,j=this.options;g.data=i,g.onTooltip=function(a,b){if(g.toolTipAction)return g.toolTipAction.toolTipFunction(a,b,g.toolTipAction.series)},b(function(){h.init(g,f)},1e3)}]}}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){a.currentSection="compute",v(g.data),n.disableFooter(),aa.stateName="services_detail",aa.search="",aa.ui={indicatorsCollapsed:!1,instanceFilterCollapsed:!0,clustersCollapsed:!1,instancesCollapsed:!1,loadBalancersCollapsed:!1,hardwaresCollapsed:!1,instanceFilter:{db:!0,windows:!0,linux:!0}},aa.navigationServiceSearch={state:"search",label:"services",params:{type:"service"}},aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail],aa.navigationServiceDetail={state:"services_detail.dashboard",label:aa.service.name,params:{serviceId:d.params.serviceId}},ba={serviceDetailIndicator:"services_detail.indicator",serviceDetailCluster:"services_detail.cluster",serviceDetailInstance:"services_detail.instance",serviceDetailLoadBalancer:"services_detail.loadbalancer",serviceDetailHardware:"services_detail.hardware"},aa.clusterSubView="information",aa.instanceSubView="information",aa.loadBalancerSubView="information",aa.hardwareSubView="information",i.appendPreference("last-views",{id:aa.service.id,name:aa.service.name,type:"service"});var e=f(function(){if(!da){da=!0;h.getServiceDetailByGlobalServiceId(aa.service.id,{ignoreLoadingBar:!0}).then(function(a){da=!1,v(a.data)},function(){da=!1})}},b);w(),c.$on("$destroy",function(){f.cancel(e)})}function t(a){var b=[];angular.forEach(a,function(a){b.push(a.id)});var c=b.join(",");d.go("tickets",{ticketNumbers:c})}function u(){var a={};j.forEach(aa.service.availableActions,function(b){var c="";b.available||j.forEach(b.unavailabilityCauses,function(a){c+=m.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),a[b.operation]={available:b.available,errors:c}}),aa.service.availableActions=a}function v(a){aa.service=a,u(),angular.forEach(aa.service.instances,function(a){a.computedStatus={status:"RESOURCE_STATUS_"+a.status,icon:ca[a.status].icon||"",color:ca[a.status].color||""}}),angular.forEach(aa.service.loadbalancers,function(a){null!=a.status&&(a.computedStatus={status:"RESOURCE_STATUS_"+a.status,icon:ca[a.status].icon||"",color:ca[a.status].color||""})}),angular.forEach(aa.service.hardwares,function(a){null!=a.status&&(a.computedStatus={status:"RESOURCE_STATUS_"+a.status,icon:ca[a.status].icon||"",color:ca[a.status].color||""})}),j.forEach(aa.service.tags,function(a){a.tagValue=a.tagValue.split("&#58;").join(":")}),angular.forEach(aa.service.actionsInProgress,function(a){a.lastUpdatedAt=moment(a.lastUpdatedAt);var b=j.first(j.filter(aa.service.instances,function(b){return b.name.toUpperCase()===a.resourceName}));if(void 0===b&&(b=j.first(j.filter(aa.service.loadbalancers,function(b){return b.id===a.resourceName}))),void 0!==b)switch(a.process){case"CREATE_VM":case"CREATE_VM_ITCARE":case"CREATE_LB_VIRTUALSERVER":case"CREATE_LB_VIRTUALSERVER_ITCARE":case"DELETE_VM":case"DISABLE_VM":case"ENABLE_VM":b.computedStatus={status:"RESOURCE_STATUS_"+a.process+"_"+a.status,icon:"IN_PROGRESS"==a.status?"fa-spin fa-gear":"fa-exclamation-triangle",color:"IN_PROGRESS"==a.status?"text-primary":"text-danger"}}}),O()}function w(){aa.summary.loading=!0,r.getObjectStoresSummary(aa.service.id).then(function(a){aa.summary=j.merge(aa.summary,a.data),aa.summary.loading=!1},function(a){e.error("Failed to refresh summary for object stores: "+a)})}function x(a){d.go(a.state,a.params),aa.currentIndicatorId=void 0,aa.currentClusterId=void 0,aa.currentInstanceId=void 0,aa.currentHardwareId=void 0,aa.currentLoadBalancerId=void 0}function y(){aa.ui.indicatorsCollapsed=!aa.ui.indicatorsCollapsed}function z(){aa.ui.instanceFilterCollapsed=!aa.ui.instanceFilterCollapsed}function A(){aa.ui.instancesCollapsed=!aa.ui.instancesCollapsed,aa.ui.instancesCollapsed?aa.ui.instanceFilterCollapsed=aa.ui.instancesCollapsed:aa.ui.instanceFilterCollapsed=!aa.ui.instancesCollapsed}function B(){aa.ui.clustersCollapsed=!aa.ui.clustersCollapsed}function C(){aa.ui.loadBalancersCollapsed=!aa.ui.loadBalancersCollapsed}function D(){aa.ui.hardwaresCollapsed=!aa.ui.hardwaresCollapsed}function E(){aa.ui.loadBalancerFilterCollapsed=!aa.ui.loadBalancerFilterCollapsed}function F(b,c){p.promptTagsInModal(a.translation,aa.service.tags,"",c).then(function(a){c&&G(b,a)})}function G(a,b){X(!0),h.patchTagsOfService(a,b).then(function(a){l.pop("success",m.get("TAGS_UPDATED_TITLE"),m.get("TAGS_UPDATED_BODY")),X(!1),aa.service.tags=angular.copy(b)},function(a){304===a.status&&l.pop("success",m.get("TAGS_UNMODIFIED_TITLE"),m.get("TAGS_UNMODIFIED_BODY")),X(!1)})}function H(a){a!=aa.currentIndicatorId&&(N(a,"indicator"),X(!0),d.go(ba.serviceDetailIndicator,{indicatorId:a}))}function I(a,b,c){if(a!=aa.currentInstanceId||b&&b!=aa.instanceSubView){N(a,"instance"),void 0!==b&&(aa.instanceSubView=b);var e={instanceId:a};void 0!==c&&(e=c,e.instanceId=a),X(!0),d.go(ba.serviceDetailInstance+"."+aa.instanceSubView,e)}}function J(a,b,e){if(c.requests=[],a!=aa.currentClusterId||b&&b!=aa.clusterSubView){N(a,"cluster"),void 0!==b&&(aa.clusterSubView=b);var f={clusterId:a};void 0!==e&&(f=e,f.clusterId=a),X(!0),d.go(ba.serviceDetailCluster+"."+aa.clusterSubView,f)}}function K(a,b,c){if(a!=aa.currentLoadBalancerId||b&&b!=aa.loadBalancerSubView){N(a,"loadbalancer"),void 0!=b&&(aa.loadBalancerSubView=b);var e={url:a};void 0!==c&&(e=c,e.url=a),X(!0),d.go(ba.serviceDetailLoadBalancer+"."+aa.loadBalancerSubView,e)}}function L(a,b,c){if(a!=aa.currentHardwareId||b&&b!=aa.hardwareSubView){N(a,"hardware"),void 0!=b&&(aa.hardwareSubView=b);var e={hardwareId:a};void 0!==c&&(e=c,e.hardwareId=a),X(!0),d.go(ba.serviceDetailHardware+"."+aa.hardwareSubView,e)}}function M(a,b){var c=j.filter(aa.indicators,function(b){return b.id==a});c.length>0&&(c[0].liveAvailability=b)}function N(a,b){switch(e.debug("set selected item ("+b+") : "+a),aa.currentIndicatorId=void 0,aa.currentClusterId=void 0,aa.currentInstanceId=void 0,aa.currentLoadBalancerId=void 0,aa.currentHardwareId=void 0,b){case"indicator":aa.currentIndicatorId=a;break;case"cluster":aa.currentClusterId=a;break;case"instance":aa.currentInstanceId=a;break;case"loadbalancer":e.debug("select lb : "+a),aa.currentLoadBalancerId=a;break;case"hardware":e.debug("select hardware : "+a),aa.currentHardwareId=a}}function O(){aa.indicators=aa.service.indicators,aa.instances=aa.service.instances,aa.clusters=aa.service.clusters,aa.loadbalancers=aa.service.loadbalancers,aa.hardwares=aa.service.hardwares}function P(a,b,c){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail,{state:null,label:b,params:null}],e.debug("navigation to "+a+", "+c),aa.currentClusterId=a,aa.clusterSubView=c,N(a,"cluster")}function Q(a,b,c){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail,{state:null,label:b,params:null}],e.debug("navigation to "+a+", "+c),aa.currentInstanceId=a,aa.instanceSubView=c,N(a,"instance")}function R(a,b,c){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail,{state:c,label:b,params:{indicatorId:a}}],aa.currentIndicatorId=a,N(a,"indicator")}function S(a,b,c){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail,{state:null,label:b,params:{loadBalancerId:a}}],aa.currentLoadBalancerId=a,aa.loadBalancerSubView=c,N(a,"loadbalancer")}function T(a,b,c){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail,{state:null,label:b,params:{hardwareId:a}}],aa.currentHardwareId=a,aa.hardwareSubView=c,N(a,"hardware")}function U(a,b){aa.navigation=[aa.navigationServiceSearch,aa.navigationServiceDetail]}function V(){return aa.service}function W(){return aa.service.loadbalancers}function X(a){aa.viewLoading=a}function Y(a){var b=null!=a;k.open({animation:c.animationsEnabled,templateUrl:"/services/detail/indicator-edition.html",controller:"IndicatorEditionCtrl",controllerAs:"newApp",size:"lg",backdrop:"static",keyboard:!0,resolve:{globalServiceId:function(){return aa.service.id},indicator:function(){return a}}}).result.then(function(a){if(b){l.pop("success",m.get("APP_UPDATE_SUCCEED_TITLE"),m.get("APP_UPDATE_SUCCEED_BODY")),e.debug("updated indicator : "+a.id);for(var c=0;c<aa.service.indicators.length;c++)if(e.debug("try to replace indicator : "+aa.service.indicators[c].id),aa.service.indicators[c].id==a.id){e.debug("replacing indicator"),aa.service.indicators[c]=a;break}d.go(d.current.name,d.params,{reload:!0})}else l.pop("success",m.get("APP_CREATION_SUCCEED_TITLE"),m.get("APP_CREATION_SUCCEED_BODY")),e.debug("creating indicator : (was count:"+aa.service.indicators.length),aa.service.indicators.push(a),d.go("services_detail.indicator",{indicatorId:a.id})},function(){e.debug("Modal dismissed at: "+new Date)})}function Z(){k.open({animation:!0,templateUrl:"/services/detail/automation/create-instance.html",controller:"InstanceCreationCtrl",controllerAs:"newInst",size:"lg",backdrop:"static",keyboard:!0,resolve:{service:function(){return aa.service}}}).result.then(function(a){d.go("services_detail.dashboard",{serviceId:aa.service.id})},function(){e.debug("Modal dismissed at: "+new Date)})}function $(){k.open({animation:!0,templateUrl:"/services/detail/automation/create-cluster.html",controller:"ClusterCreationCtrl",controllerAs:"newCluster",size:"lg",backdrop:"static",keyboard:!0,resolve:{service:function(){return aa.service}}}).result.then(function(a){d.go("services_detail.dashboard",{serviceId:aa.service.id})},function(){e.debug("Modal dismissed at: "+new Date)})}function _(){k.open({animation:!0,templateUrl:"/services/detail/automation/create-loadbalancer.html",controller:"LoadBalancerCreationCtrl",controllerAs:"newVs",size:"lg",backdrop:"static",keyboard:!0,resolve:{service:function(){return aa.service}}}).result.then(function(a){d.go("services_detail.dashboard",{serviceId:aa.service.id})},function(){e.debug("Modal dismissed at: "+new Date)})}var aa=this;aa.currentIndicatorId=void 0,aa.currentInstanceId=void 0,aa.currentClusterId=void 0,aa.currentLoadBalancerId=void 0,aa.currentHardwareId=void 0,aa.isThereIndicatorsToShow=void 0,aa.isThereInstancesToShow=void 0,aa.isThereClustersToShow=void 0,aa.isThereLoadBalancersToShow=void 0,aa.isThereHardwaresToShow=void 0,aa.navigation=void 0,aa.service=void 0,aa.navigationServiceDetail=void 0,aa.navigationServiceSearch=void 0,aa.stateName=void 0,aa.ui=void 0,aa.instanceSubView=void 0,aa.clusterSubView=void 0,aa.loadBalancerSubView=void 0,aa.hardwareSubView=void 0,aa.search="",aa.openCreateObjectStoresDialog=void 0,aa.summary={"last-creation":void 0,"total-stores":0,"total-objects":0,"total-gb":0,"total-regions":0,loading:!0},aa.goToIndicator=H,aa.goToInstance=I,aa.goToCluster=J,aa.goToLoadBalancer=K,aa.goToHardware=L,aa.navigationGo=x,aa.toggleIndicatorsCollapse=y,aa.toggleClustersCollapse=B,aa.toggleInstancesCollapse=A,aa.toggleInstanceFilterCollapse=z,aa.toggleLoadBalancerCollapse=C,aa.toggleHardwareCollapse=D,aa.toggleLoadBalancerFilterCollapse=E,aa.openTagsEditor=F,aa.patchTags=G,aa.getObjectStorageSummary=w,aa.ticketIds=t,aa.viewLoading=!0;var ba=void 0,ca={ACTIVE:{icon:"fa-play",color:"text-success"},INACTIVE:{icon:"fa-pause",color:""},PREPARATION:{icon:"fa-refresh fa-spin",color:""}},da=!1,N=N,O=O,R=R,U=U,P=P,Q=Q,S=S,T=T,V=V,u=u;c.navigationSetIndicator=R,c.navigationSetDashboard=U,c.navigationSetCluster=P,c.navigationSetInstance=Q,c.navigationSetLoadBalancer=S,c.navigationSetHardware=T,c.getDataModel=V,c.getInstanceLoadBalancersDataModel=W,c.setViewLoading=X,c.refreshIndicatorAvailability=M,c.openIndicatorDialog=Y,c.openClusterCreationDialog=$,c.openInstanceCreationDialog=Z,c.openLbCreationDialog=_,s()}angular.module("itcare.services").controller("ServiceDetailCtrl",["$rootScope","REFRESH_INTERVAL","$scope","$state","$log","$interval","serviceDetail","CiService","UserPreferencesService","lodash","$uibModal","toaster","TranslationService","UIService","InstanceService","TagsSelectorService","UserService","ObjectStoresService",a]).directive("grapheForces",function(){return{restrict:"A",link:function(a,b){var c=450,d=400,e=d3.scale.category20();a.$watch("grapheDatas",function(a){var b=d3.layout.force().charge(-120).linkDistance(30).size([c,d]).nodes(a.nodes).links(a.links).start(),f=d3.select("body").append("svg").attr("width",c).attr("height",d),g=f.selectAll(".link").data(a.links).enter().append("line").attr("class","link").style("stroke-width",function(a){return Math.sqrt(a.value)}),h=f.selectAll(".node").data(a.nodes).enter().append("circle").attr("class","node").attr("r",5).style("fill",function(a){return e(a.group)}).call(b.drag);h.append("title").text(function(a){return a.name}),b.on("tick",function(){g.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),h.attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})})})}}})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){N.indicator=l,s.setTitle(N.indicator.name);var e=N.indicator.definition.availabilityWarn,h=N.indicator.definition.availabilityTarget;if(N.defaultConfForIndicators={legend:[100*e,100*h],itemName:["% "+c.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY,"% "+c.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY],tooltip:!0,toolTipAction:void 0},v(),w(),b.refreshIndicatorAvailability(d.params.indicatorId,N.indicator.liveAvailability),N.isMonitored=null!=N.indicator.liveAvailability,N.isAvailable=N.isMonitored&&N.indicator.liveAvailability.available,N.lastCheckedAt=N.isMonitored?moment(N.indicator.liveAvailability.lastCheckedAt).toDate():null,null!=m&&(N.availabilityCurrentMonth=m,N.availabilityCurrentMonthPerDay=N.availabilityCurrentMonth.availability,N.availabilityCurrentMonthMapData=q.getAvailabilityCalHeatmap(N.availabilityCurrentMonth.availability),N.availabilityCurrentMonthDate=new Date(N.availabilityBrowserSelectedYear,N.availabilityBrowserSelectedMonth-1,2,0,0,0,0)),N.ui={showCalendar:!1,sort:{column:"date",descending:!0}},N.sort=N.ui.sort,N.availabilityCurrentMonthMapOptions={legend:N.defaultConfForIndicators.legend,displayLegend:!1,legendCellSize:20,legendVerticalPosition:"bottom",legendHorizontalPosition:"center",legendOrientation:"horizontal",itemName:N.defaultConfForIndicators.itemName,tooltip:N.defaultConfForIndicators.tooltip,range:1,cellSize:40,cellPadding:1,toolTipAction:{toolTipFunction:N.getTitleTooltipCalHeatMap,series:N.availabilityCurrentMonthPerDay},label:{height:20}},angular.forEach(N.availabilityCurrentMonthPerDay,function(a,b){a.date=moment.utc(a.date).toDate().getTime(),a.unexpectedBreaks=a.unexpectedBreaks,a.unexpectedDonwtime=a.unexpectedDonwtime}),b.navigationSetIndicator(d.params.indicatorId,N.indicator.name,d.current.name),N.isMonitored){var i=f(F,6e4);b.$on("$destroy",function(){angular.isDefined(i)&&f.cancel(i)})}null!=N.indicator.availability&&N.indicator.availability.availabilityRate<1&&N.getAnalysisDataCurrentMonth(),N.configuration=a,angular.forEach(Object.keys(N.configuration),function(a){var c=j.filter(j.concat(b.getDataModel().hardwares,b.getDataModel().loadbalancers,b.getDataModel().instances),{id:a});if(c&&0!=c.length)N.resources.push(c[0]);else{!isNaN(a)&&angular.isNumber(+a)?k.getInstanceDetailById({instanceId:a},!0).then(function(b){200===b.status?N.resources.push(b.data):k.getHardwareDetailById({id:a},!0).then(function(b){200===b.status?N.resources.push(b.data):g.error("The resource [{}] is configured on metrics but it has not been found".format(a))})}):k.getLoadBalancerDetailByUrl(a,!0).then(function(b){200===b.status?N.resources.push(b.data):g.error("The resource [{}] is configured on metrics but it has not been found".format(a))})}});var n=moment();N.start=moment(n).add(-1,"days").unix(),N.end=moment(n).unix(),b.setViewLoading(!1)}function u(a){return h("humanReadableDuration")(a)}function v(){var a=moment();if(null!=N.indicator.definition.createdAt){var b=moment.utc(N.indicator.definition.createdAt),c=b.year(),d=a.year();b.date(1).hours(0).minutes(0).seconds(0).milliseconds(0);for(var e=[];b.unix()<=a.unix();)e.push(b.year()+"-"+b.month()),b.add(1,"months");for(var f=c;f<=d;f++){for(var g=[],h=0;h<=11;h++){var i=e.indexOf(f+"-"+h)>-1;g.push({date:moment().year(f).month(h).date(1).hours(0).minutes(0).seconds(0).milliseconds(0).toDate(),month:h+1,activity:i})}N.availabilityBrowserYears.push({year:f,months:g})}}N.availabilityBrowserSelectedYear=a.year(),N.availabilityBrowserSelectedMonth=a.month()+1,N.availabilityMonthsCurrentYear=O.find(N.availabilityBrowserYears,O.matchesProperty("year",N.availabilityBrowserSelectedYear)),N.availabilityBrowserMapOptions={displayLegend:!1,cellPadding:1,cellSize:7,domainGutter:0,domainMargin:5,legend:N.defaultConfForIndicators.legend,range:12,tooltip:!1,domainLabelFormat:"%b",subDomainTextFormat:"",subDomainTitleFormat:{empty:"",filled:""},toolTipAction:void 0,onClick:function(a,b){var c=O.find(N.availabilityMonthsCurrentYear.months,O.matches({activity:!0,month:a.getMonth()+1}));null!=c&&N.selectAvailabilityMonth(c)}};var j=O.find(N.availabilityMonthsCurrentYear.months,O.matches({activity:!0,month:a.get("month")+1}));null!=j&&N.selectAvailabilityMonth(j),A(N.availabilityBrowserSelectedMonth),C(N.availabilityBrowserSelectedYear)}function w(){var a=q.determineAvailabilityTimeRange(N.indicator.definition.dayMask,N.indicator.definition.periodMask),b=0;angular.forEach(a.weekdays,function(a){b++,a.sliderOptions={id:b,hideLimitLabels:!0,step:.25,precision:2,floor:0,ceil:24,disabled:!0,noSwitching:!0,minRange:.25,translate:function(a,b,c){return r.formatNumberedHour(a)}}}),N.indicatorTimerange=a}function x(a){N.currentTab=a,e(function(){b.$broadcast("rzSliderForceRender")}),e(function(){var a=i.document.createEvent("UIEvents");a.initUIEvent("resize",!0,!1,i,0),i.dispatchEvent(a)})}function y(a){N.availabilityMonthsCurrentYear=a,N.availabilityBrowserSelectedYear=a.year,C(a.year),z(O.find(N.availabilityMonthsCurrentYear.months,O.matchesProperty("activity",!0)))}function z(a){N.availabilityBrowserSelectedMonth=a.month,B(N.availabilityBrowserSelectedYear,N.availabilityBrowserSelectedMonth),A(a.month)}function A(a){N.customStyle=".cal-year .m_"+a+" .domain-background { fill: #6f6f6f; } .cal-year .m_"+a+" .graph-label { fill: #efefef; }"}function B(a,c){q.getIndicatorAvailability(b.getDataModel().id,N.indicator.id,a,c).then(function(a){null!=a.data&&(N.availabilityCurrentMonth=a.data,N.availabilityCurrentMonthPerDay=a.data.availability,N.availabilityCurrentMonthMapData=q.getAvailabilityCalHeatmap(a.data.availability),N.availabilityCurrentMonthDate=new Date(N.availabilityBrowserSelectedYear,N.availabilityBrowserSelectedMonth-1,2,0,0,0,0),N.getAnalysisDataCurrentMonth(),angular.forEach(N.availabilityCurrentMonthPerDay,function(a,b){a.date=moment.utc(a.date).toDate().getTime(),a.unexpectedBreaks=a.unexpectedBreaks,a.unexpectedDonwtime=a.unexpectedDonwtime}),N.availabilityCurrentMonthMapOptions.toolTipAction.series=N.availabilityCurrentMonthPerDay)})}function C(a){var c=q.getIndicatorAvailability(b.getDataModel().id,N.indicator.id,a,0);N.availabilityBrowserLoaded=!1,c.then(function(a){N.availabilityBrowserMapData=a.data?q.getAvailabilityCalHeatmap(a.data.availability):null,N.availabilityBrowserLoaded=!0})}function D(a,b,d){for(var e=moment(a).format("LL"),f=c.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY_TOOLTIP_TEXT_WITH_BREAKS,g=c.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY_TOOLTIP_TEXT_WITHOUT_BREAKS,h=c.translation.ITCARE_SERVICE_INDICATOR_AVAILABILITY_TOOLTIP_NO_DATA,i=0;i<d.length;i++){var j=d[i],k=j.unexpectedBreaks,l=j.unexpectedDonwtime;if(j.date===moment.utc(a).toDate().getTime()&&(k>0||l>0))return f.format([b,e,k,l]);if(j.date===moment.utc(a).toDate().getTime()&&0==l&&0==l)return g.format([b,e])}return h}function E(a){var b=N.ui.sort;b.column==a?b.descending=!b.descending:(b.column=a,b.descending=!1),N.ui.sort=b}function F(){q.getLiveAvailability(d.params.serviceId,d.params.indicatorId).then(function(a){N.isAvailable=a.data.available,N.lastCheckedAt=moment(a.data.lastCheckedAt).toDate(),b.refreshIndicatorAvailability(d.params.indicatorId,a.data)},function(a){g.error("Failed to get live availability: "+a)})}function G(a){N.ui.showCalendar=a}function H(){new Date;N.analysisRequestPending=!0;var a=q.getIndicatorInterruptions(d.params.serviceId,d.params.indicatorId,N.availabilityBrowserSelectedYear,N.availabilityBrowserSelectedMonth);N.incidentListRequestPending=!0,a.then(function(a){N.incidentListRequestPending=!1,N.currentMonthInterruptions=a.data},function(){N.incidentListRequestPending=!1}),q.getIndicatorAvailabilityAnalysis(d.params.serviceId,d.params.indicatorId,N.availabilityBrowserSelectedYear,N.availabilityBrowserSelectedMonth).then(function(a){N.analysisRequestPending=!1,N.currentMonthMonitoringAnalysis=a.data;var b=[],d=[],e=[];for(var f in N.currentMonthMonitoringAnalysis.interruptionsPerHour)if(N.currentMonthMonitoringAnalysis.interruptionsPerHour.hasOwnProperty(f)){var g=N.currentMonthMonitoringAnalysis.interruptionsPerHour[f];b.push(g.count),d.push(g.durationSeconds),e.push(f+"h")}N.perHourInterruptions={count:b,duration:d,labels:e,selectedData:[]},N.hourShow("count");var b=[],d=[],e=[];for(var h in N.currentMonthMonitoringAnalysis.interruptionsPerWeekday)if(N.currentMonthMonitoringAnalysis.interruptionsPerWeekday.hasOwnProperty(h)){var g=N.currentMonthMonitoringAnalysis.interruptionsPerWeekday[h];b.push(g.count),d.push(g.durationSeconds),e.push(c.translation["WEEKDAY_"+h])}N.perWeekdayInterruptions={count:b,duration:d,labels:e,selectedData:[[]]},N.weekdayShow("count")},function(){N.analysisRequestPending=!1})}function I(a){N.weekdaySelectedData=a,N.perWeekdayInterruptions.selectedData=[N.perWeekdayInterruptions[a]]}function J(a){N.hourSelectedData=a,N.perHourInterruptions.selectedData=[N.perHourInterruptions[a]]}function K(){b.openIndicatorDialog(N.indicator)}function L(){var a=["$scope","$uibModalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}];n.open({animation:!0,templateUrl:"indicator-delete-confirm.html",backdrop:"static",keyboard:!0,controller:a}).result.then(function(){q.deleteIndicator(d.params.serviceId,d.params.indicatorId).then(function(a){o.pop("success",p.get("APP_DELETE_SUCCEED_TITLE"),p.get("APP_DELETE_SUCCEED_BODY")),g.debug("removing indicator ok :"+d.params.indicatorId),g.debug("service"),g.debug(b.getDataModel());for(var c=0;c<b.getDataModel().indicators.length;c++)if(g.debug("try to remove indicator :"+b.getDataModel().indicators[c].id),b.getDataModel().indicators[c].id==d.params.indicatorId){g.debug("removing indicator in menu"),b.getDataModel().indicators.splice(c,1);break}d.go("services_detail.dashboard",{serviceId:d.params.serviceId})},function(a){g.error("unable to remove indicator "+a)})},function(){g.debug("Modal dismissed at: "+new Date)})}function M(){angular.forEach(N.configuration,function(a){N.resources[a]&&k.getR})}var N=this;N.indicator=null,N.availabilityObjective=null,N.customStyle="",N.isAvailable=!1,N.lastCheckedAt=null,N.stateName="services_detail.indicator",N.ui=null,N.currentTab="availability",N.availabilityCurrentMonth=null,N.availabilityCurrentMonthPerDay=null,N.availabilityCurrentMonthMapData={},N.availabilityCurrentMonthMapOptions=null,N.availabilityCurrentMonthDate=null,N.availabilityBrowserLoaded=!1,N.availabilityBrowserYears=[],N.availabilityBrowserSelectedYear=null,N.availabilityBrowserSelectedMonth=null,N.availabilityBrowserMapData={},N.availabilityBrowserMapOptions=null,N.resources=[],N.changeSorting=E,N.readableDuration=u,N.getAnalysisDataCurrentMonth=H,N.getTitleTooltipCalHeatMap=D,N.hourShow=J,N.setShowCalendar=G,N.weekdayShow=I,N.selectTab=x,N.selectAvailabilityYear=y,N.selectAvailabilityMonth=z,N.initResourcesFromOtherServices=M,N.openEditIndicator=K,N.openDeleteIndicatorConfirm=L;var O=j,l=l.data,m=m.data;t()}angular.module("itcare.services").controller("ServiceDetailIndicatorCtrl",["configurationData","$scope","$rootScope","$state","$timeout","$interval","$log","$filter","$window","lodash","CiService","indicatorData","availabilityThisMonth","$uibModal","toaster","TranslationService","IndicatorService","UtilService","UIService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){r.service=c.getDataModel(),j.setTitle(r.service.name),r.navigationSetDashboard(),p(),f.debug(r.indicatorsOverallAvailability);var b={gaugeColor:j.colors.danger,levelColors:[j.colors.primary],relativeGaugeSize:!0,fontFamily:'Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif',valueFontFamily:'Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif',symbol:"%"};r.gaugeDisabledOptions={levelColors:[j.colors["gray-lighter"]],relativeGaugeSize:!0,fontFamily:'Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif',valueFontFamily:'Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif',minTxt:"-",maxTxt:"-",hideValue:!0},f.debug(r.instancesOverallAvailability),r.gauges={indicators:{label:r.indicatorsOverallAvailability.up.length+"/"+r.indicatorsOverallAvailability.monitoredCount,value:100*r.indicatorsOverallAvailability.upRatio,options:b},instances:{label:r.instancesOverallAvailability.up.length+"/"+r.instancesOverallAvailability.monitoredCount,value:100*r.instancesOverallAvailability.upRatio,options:b},loadBalancers:{label:r.loadBalancersOverallAvailability.up.length+"/"+r.loadBalancersOverallAvailability.monitoredCount,value:100*r.loadBalancersOverallAvailability.upRatio,options:b}},r.health={indicators:{pctUp:100*r.indicatorsOverallAvailability.upRatio,value:0==r.indicatorsOverallAvailability.monitoredCount?"-":(100*r.indicatorsOverallAvailability.upRatio).toFixed(1)+"%",legend:0==r.indicatorsOverallAvailability.monitoredCount?h.get("SERVICE_DASHBOARD_HEALTH_APP_LEGEND_NONE"):h.get("SERVICE_DASHBOARD_HEALTH_APP_LEGEND").format([r.indicatorsOverallAvailability.up.length+"/"+r.indicatorsOverallAvailability.monitoredCount]),icon:0==r.indicatorsOverallAvailability.monitoredCount?"fa-circle-thin":1==r.indicatorsOverallAvailability.upRatio?"fa-check":"fa-exclamation-triangle",theme:0==r.indicatorsOverallAvailability.monitoredCount?"gray":1==r.indicatorsOverallAvailability.upRatio?"success":"warning",monitoredCount:r.indicatorsOverallAvailability.monitoredCount},instances:{pctUp:100*r.instancesOverallAvailability.upRatio,value:0==r.instancesOverallAvailability.monitoredCount?"-":(100*r.instancesOverallAvailability.upRatio).toFixed(1)+"%",legend:0==r.instancesOverallAvailability.monitoredCount?h.get("SERVICE_DASHBOARD_HEALTH_INSTANCES_LEGEND_NONE"):h.get("SERVICE_DASHBOARD_HEALTH_INSTANCES_LEGEND").format([r.instancesOverallAvailability.up.length+"/"+r.instancesOverallAvailability.monitoredCount]),icon:0==r.instancesOverallAvailability.monitoredCount?"fa-circle-thin":1==r.instancesOverallAvailability.upRatio?"fa-check":"fa-exclamation-triangle",theme:0==r.instancesOverallAvailability.monitoredCount?"gray":1==r.instancesOverallAvailability.upRatio?"success":"warning",monitoredCount:r.instancesOverallAvailability.monitoredCount},loadBalancers:{pctUp:100*r.loadBalancersOverallAvailability.upRatio,value:0==r.loadBalancersOverallAvailability.monitoredCount?"-":(100*r.loadBalancersOverallAvailability.upRatio).toFixed(1)+"%",legend:0==r.loadBalancersOverallAvailability.monitoredCount?h.get("SERVICE_DASHBOARD_HEALTH_LB_LEGEND_NONE"):h.get("SERVICE_DASHBOARD_HEALTH_LB_LEGEND").format([r.loadBalancersOverallAvailability.up.length+"/"+r.loadBalancersOverallAvailability.monitoredCount]),icon:0==r.loadBalancersOverallAvailability.monitoredCount?"fa-circle-thin":1==r.loadBalancersOverallAvailability.upRatio?"fa-check":"fa-exclamation-triangle",theme:0==r.loadBalancersOverallAvailability.monitoredCount?"gray":1==r.loadBalancersOverallAvailability.upRatio?"success":"warning",monitoredCount:r.loadBalancersOverallAvailability.monitoredCount}},c.setViewLoading(!1),r.configuration=a,r.resources=d.concat(r.service.instances,r.service.loadbalancers);var e=moment();r.start=moment(e).add(-1,"days").unix(),r.end=moment(e).unix(),q()}function o(){ActionsService.openHistoryModal(r.service.actions)}function p(){var a={};a.down=d.filter(r.service.indicators,function(a){return null!=a.liveAvailability&&!0!==a.liveAvailability.available}),a.up=d.filter(r.service.indicators,function(a){return null!=a.liveAvailability&&!0===a.liveAvailability.available}),r.indicatorsOverallAvailability=a,a.down.length+a.up.length>0?r.indicatorsOverallAvailability.upRatio=(a.up.length/(a.up.length+a.down.length)).toFixed(2):r.indicatorsOverallAvailability.upRatio=0,r.indicatorsOverallAvailability.monitoredCount=a.up.length+a.down.length;var b={};b.down=d.filter(r.service.instances,function(a){return null!=a.liveAvailability&&!0!==a.liveAvailability.available}),b.up=d.filter(r.service.instances,function(a){return null!=a.liveAvailability&&!0===a.liveAvailability.available}),b.up.length+b.down.length>0?b.upRatio=(b.up.length/(b.up.length+b.down.length)).toFixed(2):b.upRatio=0,b.monitoredCount=b.down.length+b.up.length,b.unmonitoredCount=r.service.instances.length-b.monitoredCount,r.instancesOverallAvailability=b;var c={};c.down=d.filter(r.service.loadbalancers,function(a){return null!=a.liveAvailability&&!0!==a.liveAvailability.available}),c.up=d.filter(r.service.loadbalancers,function(a){return null!=a.liveAvailability&&!0===a.liveAvailability.available}),c.up.length+c.down.length>0?c.upRatio=(c.up.length/(c.up.length+c.down.length)).toFixed(2):c.upRatio=0,c.monitoredCount=c.down.length+c.up.length,c.unmonitoredCount=r.service.loadbalancers.length-c.monitoredCount,r.loadBalancersOverallAvailability=c}function q(){r.serviceTicketsLoading=!0,k.getServiceTickets(r.service.id).then(function(a){r.serviceTickets=a.data,r.serviceTicketsLoading=!1},function(a){r.serviceTicketsLoading=!1})}c.animationsEnabled=!0;var r=this;r.configuration=[],r.datas={},r.resources=[],r.indicatorsOverallAvailability={},r.instancesOverallAvailability={},r.service=null,r.gaugeAppsOptions={},r.instancesCounters=[],r.ticketsService=[],r.instancesCountersLoading=!1,r.openHistoryModal=o,r.serviceTickets=[],r.serviceTicketsLoading=!1,r.actionsSortType="submittedAt",r.actionsSortReverse="true",b.currentSection="compute",r.navigationSetDashboard=c.navigationSetDashboard,r.getActions=k.getServiceActionsByGlobalServiceId;var p=p;n(),c.$on("$destroy",function(){angular.isDefined(r.interval)&&$interval.cancel(r.interval)})}angular.module("itcare.services").controller("ServiceDetailDashboardCtrl",["configurationData","$rootScope","$scope","lodash","$state","$log","$uibModal","TranslationService","toaster","UIService","CiService","TicketService","ChartService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){r(i.data),j.setTitle(R.instance.name),v(f),S(f.params.instanceId,R.instanceName,R.currentView),l.appendPreference("last-views",{id:R.instance.id,name:R.instance.name,type:"instance",serviceId:f.params.serviceId}),e.setViewLoading(!1);var b=a(function(){if(!T){T=!0;k.getInstanceDetailById({instanceId:R.instance.id},!0).then(function(a){r(a.data),T=!1},function(){T=!1})}},p);e.$on("$destroy",function(){a.cancel(b)})}function r(a){if(R.instance=a,R.isMonitored=!1,R.instanceName=R.instance.name,R.criticalChecks=0,R.warningChecks=0,R.maintenanceChecks=0,R.hasCpuRamInfo=R.instance.information&&R.instance.information.cpus&&R.instance.information.ram,R.instance.monitoringEnabled){var b=h.filter(R.instance.monitoring.checks,function(a){return 2==a.state});R.criticalChecks=b.length;var c=h.filter(R.instance.monitoring.checks,function(a){return 1==a.state});R.warningChecks=c.length;var d=h.filter(R.instance.monitoring.checks,function(a){return 5==a.state});R.maintenanceChecks=d.length}L(),R.automation={actionInProgress:x().actionsInProgress.length>0},R.instance.computedStatus={status:"RESOURCE_STATUS_"+R.instance.status,icon:U[R.instance.status].icon||"",color:U[R.instance.status].color},h.forEach(R.instance.tags,function(a){a.tagValue=a.tagValue.split("&#58;").join(":")}),angular.forEach(R.instance.actionsInProgress,function(a){switch(a.lastUpdatedAt=moment(a.lastUpdatedAt),a.process){case"CREATE_VM":case"CREATE_VM_ITCARE":case"DELETE_VM":case"DISABLE_VM":case"ENABLE_VM":R.instance.computedStatus={status:"RESOURCE_STATUS_"+a.process+"_"+a.status,icon:"IN_PROGRESS"==a.status?"fa-spin fa-gear":"fa-exclamation-triangle",color:"IN_PROGRESS"==a.status?"text-primary":"text-danger"}}})}function s(a){g.debug("set view : "+a),"monitoring"==a?(t("monitoring"),S(f.params.instanceId,R.instanceName,a)):"performance"==a?(t("performance"),S(f.params.instanceId,R.instanceName,a)):(t("information"),S(f.params.instanceId,R.instanceName,"information")),g.debug("after set view : "+a)}function t(a){"performance"==a?(R.currentViewIndex=2,R.currentView="performance"):"monitoring"==a?(R.currentViewIndex=1,R.currentView="monitoring"):(R.currentViewIndex=0,R.currentView="information")}function u(a){var b=[];angular.forEach(a,function(a){b.push(a.id)});var c=b.join(",");f.go("tickets",{ticketNumbers:c})}function v(a){a.includes("**.performance")?(g.debug("currentView : performance"),t("performance")):a.includes("**.monitoring")?(g.debug("currentView : monitoring"),t("monitoring")):(g.debug("currentView : information"),t("information"))}function w(a,b){var c={serviceId:e.getDataModel().id,instanceId:R.instance.id};switch(void 0!==b&&h.assignIn(c,b),a){case"information":s(a),f.go("services_detail.instance.information",c);break;case"monitoring":R.instance.monitoringEnabled&&(s(a),f.go("services_detail.instance.monitoring",c));break;case"performance":s(a),f.go("services_detail.instance.performance",c)}}function x(){return R.instance}function y(){k.getInstanceDetailById(f.params).then(function(a){angular.isDefined(a)&&200===a.status&&(i.data=a.data,q(),d.callbackAutomationListener())},function(a){g.error("Failed to loading instance : "+a)})}function z(){return R.instance.monitoring}function A(){return R.instance.information}function B(){return R.instance.snapshots}function C(){c.open({animation:!0,templateUrl:"/services/detail/automation/delete-snapshot.html",controller:"DeleteSnapshotCtrl",controllerAs:"deleteSnapshotView",size:"md",backdrop:"static",keyboard:!1}).result.then(function(){R.actionInProgress=!0,k.deleteSnapshot(f.params,R.snapshotId).then(function(a){g.debug("Deleting snapshot http status: "+a.status),202===a.status&&(b.pop("success",m.get("ACTION_CONFIRM_DELETE_SNAPSHOT_VM")),e.setInstanceDataModel())},function(a){g.error("Failed to delete snapshot: "+a)})})}function D(a){c.open({animation:!0,templateUrl:"/services/detail/automation/recover-snapshot.html",controller:"RecoverSnapshotCtrl",controllerAs:"recoverSnapshotView",size:"md",backdrop:"static",keyboard:!1}).result.then(function(c){k.recoverSnapshot(f.params,a).then(function(a){g.debug("Snapshot recovrey http status: "+a.status),202===a.status&&(b.pop("success",m.get("ACTION_CONFIRM_RECOVER_SNAPSHOT_VM")),e.setInstanceDataModel())},function(a){g.error("Failed to recover snapshot: "+a)})})}function E(){c.open({animation:!0,templateUrl:"/services/detail/automation/create-snapshot.html",controller:"CreateSnapshotCtrl",controllerAs:"newSnapshot",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.createSnapshot(f.params,a.description,a.rfc).then(function(a){g.debug("Creating snapshot http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_CREATE_SNAPSHOT_VM")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to create snapshot: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function F(){c.open({animation:!0,templateUrl:"/services/detail/automation/desactivate-instance.html",controller:"DesactivateInstanceCtrl",controllerAs:"newDesactivate",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.disableVM(f.params,a.rfc).then(function(a){g.debug("Desactivate instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_DESACTIVATE_VM")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to submit desactivate vm: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function G(){c.open({animation:!0,templateUrl:"/services/detail/automation/activate-instance.html",controller:"ActivateInstanceCtrl",controllerAs:"newActivate",size:"sm",backdrop:"static",keyboard:!0}).result.then(function(a){k.enableVM(f.params).then(function(a){g.debug("Activate instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_ACTIVATE_VM")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to submit activate vm: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function H(){c.open({animation:!0,templateUrl:"/services/detail/automation/delete-instance.html",controller:"DeleteInstanceCtrl",controllerAs:"newDelete",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.deleteVM(f.params,a.rfc).then(function(a){g.debug("Activate instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_DELETE_VM")),e.setInstanceDataModel(),f.go("services_detail.dashboard",{serviceId:e.getDataModel().id})):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to submit activate vm: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function I(){c.open({animation:!0,templateUrl:"/services/detail/automation/reset-instance.html",controller:"ResetInstanceCtrl",controllerAs:"resetView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.resetVM(f.params,a.rfc).then(function(a){g.debug("Reset instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_RESET_VM")),e.setInstanceDataModel(),f.go("services_detail.dashboard",{serviceId:e.getDataModel().id})):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to submit reset vm: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function J(a,b){n.promptTagsInModal(d.translation,R.instance.tags,"",b).then(function(c){b&&K(a,c)})}function K(a,c){e.setViewLoading(!0),k.patchTagsOfInstance(a,c).then(function(a){b.pop("success",m.get("TAGS_UPDATED_TITLE"),m.get("TAGS_UPDATED_BODY")),e.setViewLoading(!1),R.instance.tags=angular.copy(c)},function(a){304===a.status&&b.pop("success",m.get("TAGS_UNMODIFIED_TITLE"),m.get("TAGS_UNMODIFIED_BODY")),e.setViewLoading(!1)})}function L(){var a={};h.forEach(R.instance.availableActions,function(b){var c="";b.available||h.forEach(b.unavailabilityCauses,function(a){c+=m.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),R.instance.actionsInProgress.length>0&&(b.available=!1,c+=m.get("ACTION_ALERT_UNAVAILABLE_ACTION")+"<br/>"),a[b.operation]={available:b.available,errors:c}}),R.instance.availableActions=a}function M(){c.open({animation:!0,templateUrl:"/services/detail/automation/create-maintenance.html",controller:"CreateMaintenanceCtrl",controllerAs:"newMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{serviceSelection:function(){return e.getDataModel()},instanceSelection:function(){return R.instance},loadBalancerSelection:function(){},clusterSelection:function(){},choiceMode:0}}).result.then(function(a){var c={description:a.description,changeReference:a.rfc,startAt:moment(a.ranges.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),endAt:moment(a.ranges.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),resources:a.synthesisInstance.concat(a.synthesisLB)};k.createMaintenance(f.params,c).then(function(a){g.debug("Creating maintenance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_CREATE_DOWNTIME")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to create maintenance: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function N(a){var b=new Date,c=new Date(a);return!(b.getTime()>c.getTime())}function O(){c.open({animation:!0,templateUrl:"/services/detail/automation/enable-monitoring-instance.html",controller:"EnableMonitoringInstanceCtrl",controllerAs:"enableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.enableInstanceMonitoringStatus(f.params,a.rfc).then(function(a){g.debug("Enable monitoring instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_ENABLE_MONITORING")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to enable monitoring: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function P(){c.open({animation:!0,templateUrl:"/services/detail/automation/disable-monitoring-instance.html",controller:"DisableMonitoringInstanceCtrl",controllerAs:"disableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.disableInstanceMonitoringStatus(f.params,a.rfc).then(function(a){g.debug("Disable monitoring instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_DISABLE_MONITORING")),e.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to disable monitoring: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function Q(){var a=!1,b=R.instance.actionsInProgress;for(var c in b)switch(b[c].process){case"DISABLE_MONITORING":a=!0;case"ENABLE_MONITORING":a=!0}return a}var R=this;R.instance=void 0,R.isMonitored=void 0,R.instanceName=void 0,R.currentViewIndex=void 0,R.currentView=void 0,R.criticalChecks=0,R.availableActions=void 0,R.goto=w,R.ticketIds=u;var S=e.navigationSetInstance,L=L,T=!1;e.getInstanceDataModel=x,e.setInstanceDataModel=y,e.getInstanceInformationDataModel=A,e.getInstanceMonitoringDataModel=z,e.getInstanceSnapshotDataModel=B,e.setView=s,e.goto=w,e.enableDate=N,R.setInstanceDataModel=y,R.createSnapshot=E,R.deleteSnapshot=C,R.createMaintenance=M,R.desactivateInstance=F,R.activateInstance=G,R.deleteInstance=H,R.resetInstance=I,R.openTagsEditor=J,R.patchTags=K,R.callActionsFunction=k.getActionsByInstanceId,R.enableMonitoringInstance=O,R.disableMonitoringInstance=P,R.isMonitoringProcess=Q,R.recoverSnapshot=D,d.callbackAutomationListener=function(){};var U={ACTIVE:{icon:"fa-play",color:"text-success"},INACTIVE:{icon:"fa-pause",color:""},PREPARATION:{icon:"fa-refresh fa-spin",color:""}};q(),e.$on("$destroy",function(){angular.isDefined(R.interval)&&a.cancel(R.interval)})}angular.module("itcare.services").controller("ServiceDetailInstanceCtrl",["$interval","toaster","$uibModal","$rootScope","$scope","$state","$log","lodash","instanceData","UIService","CiService","UserPreferencesService","TranslationService","TagsSelectorService","$ngBootbox","REFRESH_INTERVAL",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){b.currentSection="compute",r.stateName="services_detail.indicator.information",r.information=c.getInstanceInformationDataModel(),r.resourceInformation=c.getInstanceDataModel(),r.name=r.resourceInformation.name,r.isIntanceSourceOf=!1,r.isIntanceTargetOf=!0,r.ui={fsCollapsed:!1},r.snapshots=c.getInstanceSnapshotDataModel(),r.snapshots.length>0&&(r.snapshotId=c.getInstanceSnapshotDataModel()[0].id),r.isExpired=!0,r.canMonitoring=c.getInstanceDataModel().monitoringEnabled,r.isIntanceSourceOf=r.information.replications&&r.information.replications.source&&r.information.replications.source.length>0,r.isIntanceTargetOf=r.information.replications&&r.information.replications.target&&r.information.replications.target.length>0,r.maintenances=r.resourceInformation.maintenances,r.configuration=a,r.resources.push(r.resourceInformation);var d=moment();r.start=moment(d).add(-1,"days").unix(),r.end=moment(d).unix(),q(),c.setView("information")}function p(a){n.open({animation:!0,templateUrl:"/services/detail/automation/delete-maintenance.html",controller:"DeleteMaintenanceCtrl",controllerAs:"delMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{maintenanceId:function(){return a}}}).result.then(function(a){j.deleteMaintenance(a.maintenanceId,a.instancesToDelete,a.loadBalancersToDelete).then(function(a){g.debug("Delete maintenance http status : "+a.status),202===a.status?(k.pop("success",m.get("ACTION_MENU_DELETE_MAINTENANCE_PROCESS")),c.setInstanceDataModel()):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to delete maintenance: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function q(){r.instanceTicketsLoading=!0,j.getInstanceTickets(r.resourceInformation.id).then(function(a){r.instanceTickets=a.data,r.instanceTicketsLoading=!1},function(a){r.instanceTicketsLoading=!1})}var r=this;r.ui=void 0,r.name=void 0,r.resourceInformation=void 0,r.stateName=void 0,r.information=void 0,r.snapshots=void 0,r.requests=void 0,r.maintenances=void 0,r.isIntanceSourceOf=void 0,r.isIntanceTargetOf=void 0,r.canMonitoring=void 0,r.snapshotId=void 0,r.resources=[],r.instanceTicketsLoading=!0,r.instanceTickets=[],r.removeMaintenance=p,b.callbackAutomationListener=o,o()}angular.module("itcare.services").controller("ServiceDetailInstanceInformationCtrl",["configurationData","$rootScope","$scope","$state","$timeout","$interval","$log","ConfStateUiView","ChartService","CiService","toaster","$ngBootbox","TranslationService","$uibModal",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(){return a.getInstanceDataModel().monitoringEnabled?(i.monitoring=a.getInstanceMonitoringDataModel(),i.isInstanceMonitoringChecks=i.monitoring.checks.length>0,i.isInstanceMonitoringChecks?void a.setView("monitoring"):void a.goto("information")):(c.debug("trying to reach a unavailable monitoring view, redirecting..."),void a.goto("information"))}function g(a){return d.get("monitoring."+a.alarm).toLowerCase()}function h(b){e.openModal("instance",a.getInstanceDataModel().id,b)}var i=this;i.isInstanceMonitoringChecks=void 0,i.monitoring=void 0,i.sortTranslation=g,i.showMonitoringStatusHistory=h,f()}angular.module("itcare.services").controller("ServiceDetailInstanceMonitoringCtrl",["$scope","$state","$log","TranslationService","MonitoringStatusHistoryService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){m.configuration=a,m.resources.push({id:e.getInstanceDataModel().id,resourceType:e.getInstanceDataModel().resourceType}),m.start=h.start||moment().startOf("day").unix(),m.end=h.end||moment().add(1,"days").startOf("day").unix(),m.name=h.name||"",e.setView("performance"),g.go(".",{name:m.name,start:m.start,end:m.end}),l()}function l(){m._scope.$watch(function(){return m.configuration},function(a,b){if(!angular.equals(a,b)){var c=!1;angular.forEach(m.configuration[[e.getInstanceDataModel().id]],function(a){"full"==a.mode&&(c=!0,g.go(".",{name:a.name,start:a.start,end:a.end}))}),c||g.go(".",{start:m.configuration[[e.getInstanceDataModel().id]][0].start,end:m.configuration[[e.getInstanceDataModel().id]][0].end})}},!0)}var m=this;m._scope=e,m.resources=[],k()}angular.module("itcare.services").controller("ServiceDetailInstancePerformanceCtrl",["configurationData","ChartService","$http","lodash","$scope","$log","$state","$stateParams","CiService","$filter",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){p(j.data),t(e),h.setTitle(H.loadBalancer.url),I(H.loadBalancer.url,H.loadBalancer.url,e.current.name),d.setViewLoading(!1);var b=a(function(){g.getLoadBalancerDetailByUrl(H.loadBalancer.url,!0).then(function(a){p(a.data)})},n);d.$on("$destroy",function(){a.cancel(b)})}function p(a){if(H.loadBalancer=a,H.criticalChecks=0,H.isMonitoring=H.loadBalancer.monitoring&&H.loadBalancer.monitoring.checks&&H.loadBalancer.monitoring.checks.length>0,H.isPerformance=H.loadBalancer.performance&&H.loadBalancer.performance.metrics&&H.loadBalancer.performance.metrics.length>0,C(),H.loadBalancer.monitoring){var b=i.filter(H.loadBalancer.monitoring.checks,function(a){return 2==a.state});H.criticalChecks=b.length;var c=i.filter(H.loadBalancer.monitoring.checks,function(a){return 1==a.state});H.warningChecks=c.length;var d=i.filter(H.loadBalancer.monitoring.checks,function(a){return 5==a.state});H.maintenanceChecks=d.length}i.forEach(H.loadBalancer.tags,function(a){a.tagValue=a.tagValue.split("&#58;").join(":")}),H.automation={actionInProgress:H.loadBalancer.actionsInProgress.length>0},H.loadBalancer.computedStatus={status:"RESOURCE_STATUS_"+H.loadBalancer.status,icon:J[H.loadBalancer.status].icon||"",color:J[H.loadBalancer.status].color},angular.forEach(H.loadBalancer.actionsInProgress,function(a){switch(a.lastUpdatedAt=moment(a.lastUpdatedAt),a.process){case"CREATE_LB_VIRTUALSERVER_ITCARE":case"CREATE_LB_VIRTUALSERVER":case"DELETE_LB":case"DISABLE_LB":case"ENABLE_LB":H.loadBalancer.computedStatus={status:"RESOURCE_STATUS_"+a.process+"_"+a.status,icon:"IN_PROGRESS"==a.status?"fa-spin fa-gear":"fa-exclamation-triangle",color:"IN_PROGRESS"==a.status?"text-primary":"text-danger"}}})}function q(a){"performance"==a?(H.currentViewIndex=2,H.currentView="performance"):"monitoring"==a?(H.currentViewIndex=1,H.currentView="monitoring"):(H.currentViewIndex=0,H.currentView="information")}function r(a){f.debug("set view : "+a),"monitoring"==a?(q("monitoring"),I(e.params.url,e.params.url,a)):"performance"==a?(q("performance"),I(e.params.url,e.params.url,a)):(q("information"),I(e.params.url,e.params.url,"information")),f.debug("after set view : "+a)}function s(a,b){var c={serviceId:d.getDataModel().id,url:H.loadBalancer.url};switch(void 0!==b&&i.assignIn(c,b),a){case"information":r(a),e.go("services_detail.loadbalancer.information",c);break;case"monitoring":H.loadBalancer.monitoring&&(r(a),e.go("services_detail.loadbalancer.monitoring",c));break;case"performance":r(a),e.go("services_detail.loadbalancer.performance",c)}}function t(a){a.includes("**.performance")?(f.debug("currentView : performance"),q("performance")):a.includes("**.monitoring")?(f.debug("currentView : monitoring"),q("monitoring")):(f.debug("currentView : information"),q("information"))}function u(){return H.loadBalancer}function v(){g.getLoadBalancerDetailByUrl(e.params.url).then(function(a){angular.isDefined(a)&&200===a.status&&(j.data=a.data,o(),c.callbackAutomationListener())},function(a){f.error("Failed to loading loadbalancer : "+a)})}function w(){b.open({animation:!0,templateUrl:"/services/detail/automation/delete-loadbalancer.html",controller:"DeleteLoadBalancerCtrl",controllerAs:"newDelete",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){g.deleteVS(e.params,a.rfc).then(function(a){f.debug("Activate lb http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_DELETE_VM")),d.setLoadBalancerDataModel(),e.go("services_detail.dashboard",{serviceId:d.getDataModel().id})):f.debug("there is no automation for this lb, status "+a.status)},function(a){f.error("Failed to submit activate lb: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function x(){b.open({animation:!0,templateUrl:"/services/detail/automation/activate-loadbalancer.html",controller:"ActivateLoadBalancerCtrl",controllerAs:"newActivate",size:"sm",backdrop:"static",keyboard:!0}).result.then(function(a){g.enableVS(e.params).then(function(a){f.debug("Activate lb http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_ACTIVATE_VS")),d.setLoadBalancerDataModel()):f.debug("there is no automation for this lb, status "+a.status)},function(a){f.error("Failed to submit activate vm: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function y(){b.open({animation:!0,templateUrl:"/services/detail/automation/desactivate-loadbalancer.html",controller:"DesactivateLoadBalancerCtrl",controllerAs:"newDesactivate",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){g.disableVS(e.params,a.rfc).then(function(a){f.debug("Desactivate load balancer http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_DESACTIVATE_VS")),d.setLoadBalancerDataModel()):f.debug("there is no automation for this instance, status "+a.status)},function(a){f.error("Failed to submit desactivate vm: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function z(){b.open({animation:!0,templateUrl:"/services/detail/automation/create-maintenance.html",controller:"CreateMaintenanceCtrl",controllerAs:"newMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{serviceSelection:function(){return d.getDataModel()},instanceSelection:function(){},loadBalancerSelection:function(){return j.data},clusterSelection:function(){},choiceMode:0}}).result.then(function(a){var b={description:a.description,changeReference:a.rfc,startAt:moment(a.ranges.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),endAt:moment(a.ranges.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),resources:a.synthesisInstance.concat(a.synthesisLB)};g.createMaintenance(e.params,b).then(function(a){f.debug("Creating maintenance http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_CREATE_DOWNTIME")),v()):f.debug("there is no automation for this loadbalancer, status "+a.status)},function(a){f.error("Failed to create maintenance: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function A(a,b){l.promptTagsInModal(c.translation,H.loadBalancer.tags,"",b).then(function(c){b&&B(a,c)})}function B(a,b){d.setViewLoading(!0),g.patchTagsOfLoadBalancer(a,b).then(function(a){m.pop("success",k.get("TAGS_UPDATED_TITLE"),k.get("TAGS_UPDATED_BODY")),d.setViewLoading(!1),H.loadBalancer.tags=angular.copy(b)},function(a){304===a.status&&m.pop("success",k.get("TAGS_UNMODIFIED_TITLE"),k.get("TAGS_UNMODIFIED_BODY")),d.setViewLoading(!1)})}function C(){var a={};i.forEach(H.loadBalancer.availableActions,function(b){var c="";b.available||i.forEach(b.unavailabilityCauses,function(a){c+=k.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),H.loadBalancer.actionsInProgress.length>0&&(b.available=!1,c+=k.get("ACTION_ALERT_UNAVAILABLE_ACTION")+"<br/>"),a[b.operation]={available:b.available,errors:c}}),H.loadBalancer.availableActions=a}function D(){console.log("enable_monitoring : 1"),b.open({animation:!0,templateUrl:"/services/detail/automation/enable-monitoring-instance.html",controller:"EnableMonitoringInstanceCtrl",controllerAs:"enableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){g.enableLBMonitoringStatus(e.params,a.rfc).then(function(a){f.debug("Enable monitoring load balancer http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_ENABLE_MONITORING")),d.setLoadBalancerDataModel()):f.debug("there is no automation for this load balancer, status "+a.status)},function(a){f.error("Failed to enable monitoring: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function E(){console.log("disable_monitoring : 1"),b.open({animation:!0,templateUrl:"/services/detail/automation/disable-monitoring-instance.html",controller:"DisableMonitoringInstanceCtrl",controllerAs:"disableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){g.disableLBMonitoringStatus(e.params,a.rfc).then(function(a){f.debug("Disable monitoring load balancer http status : "+a.status),202===a.status?(m.pop("success",k.get("ACTION_CONFIRM_DISABLE_MONITORING")),d.setLoadBalancerDataModel()):f.debug("there is no automation for this load balancer, status "+a.status)},function(a){f.error("Failed to disable monitoring: "+a)})},function(){f.info("Modal dismissed at: "+new Date)})}function F(){var a=!1,b=H.loadBalancer.actionsInProgress;for(var c in b)switch(b[c].process){case"DISABLE_MONITORING":a=!0;case"ENABLE_MONITORING":a=!0}return a}function G(a){var b=[];angular.forEach(a,function(a){b.push(a.id)});var c=b.join(",");e.go("tickets",{ticketNumbers:c})}var H=this;H.loadBalancer=void 0,H.isMonitoring=!1,H.isPerformance=!1,H.goto=s,H.criticalChecks=0,H.desactivateLoadBalancer=y,H.activateLoadBalancer=x,H.deleteLoadBalancer=w,H.createMaintenance=z,H.openTagsEditor=A,H.patchTags=B,H.callActionsFunction=g.getActionsByLoadBalancerUrl,H.disableMonitoringLB=E,H.enableMonitoringLB=D,H.isMonitoringProcess=F,H.ticketIds=G,d.getLoadBalancerDataModel=u,d.setLoadBalancerDataModel=v,d.setView=r,d.goto=s;var C=C,I=d.navigationSetLoadBalancer,J={ACTIVE:{icon:"fa-play",color:"text-success"},INACTIVE:{icon:"fa-pause",color:""},PREPARATION:{icon:"fa-refresh fa-spin",color:""}};o()}angular.module("itcare.services").controller("ServiceDetailLoadBalancerCtrl",["$interval","$uibModal","$rootScope","$scope","$state","$log","CiService","UIService","lodash","loadBalancerData","TranslationService","TagsSelectorService","toaster","REFRESH_INTERVAL",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){w.colors=k.colors,w.maintenances=c.getLoadBalancerDataModel().maintenances,w.configuration=a,w.resources.push(c.getLoadBalancerDataModel());var b=moment();w.start=moment(b).add(-1,"days").unix(),w.end=moment(b).unix(),w.getVulnerabilitiesSummary(),v(),c.setView("information")}function q(a){d.debug("Launching modal for schedule deletion."),g.open({animation:!0,templateUrl:"/services/detail/automation/delete-maintenance.html",controller:"DeleteMaintenanceCtrl",controllerAs:"delMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{maintenanceId:function(){return a}}}).result.then(function(a){j.deleteMaintenance(a.maintenanceId,a.instancesToDelete,a.loadBalancersToDelete).then(function(a){d.debug("Delete maintenance http status : "+a.status),202===a.status?(l.pop("success",m.get("ACTION_MENU_DELETE_MAINTENANCE_PROCESS")),c.setLoadBalancerDataModel()):d.debug("there is no automation for this instance, status "+a.status)},function(a){d.error("Failed to delete maintenance: "+a)})},function(){d.info("Modal dismissed at: "+new Date)})}function r(){n.getVulnerabilitiesSummaryByUrl(c.getLoadBalancerDataModel().url).then(function(a){w.vulnerabilitiesSummary.datas=a.data.vulnerabilitiesSummary,w.vulnerabilitiesSummary.loading=!1},function(a){d.error("Failed to refresh summary for vulnerabilities: "+a)})}function s(){o.openReport(c.getLoadBalancerDataModel().url)}function t(a,b){d.debug("go to instance"),e.go("services_detail.instance.information",{instanceId:a,serviceId:b})}function u(a,b){null!=b&&b.length>0&&h.open(b[0].protocol+"://"+a,"_blank")}function v(){w.lbTicketsLoading=!0,j.getLoadBalancerTickets(c.getLoadBalancerDataModel().id).then(function(a){w.lbTickets=a.data,w.lbTicketsLoading=!1},function(a){w.lbTicketsLoading=!1})}var w=this;w.maintenances=void 0,w.colors={},w.goToInstance=t,w.navigateToUrl=u,w.goToVulnerabilitiesDetail=s,w.removeMaintenance=q,w.resources=[],w.vulnerabilitiesSummary={datas:[],loading:!0},w.lbTickets=[],w.lbTicketsLoading=!1,b.callbackAutomationListener=p,w.getVulnerabilitiesSummary=r,p()}angular.module("itcare.services").controller("ServiceDetailLoadBalancerInformationCtrl",["configurationLBData","$rootScope","$scope","$log","$state","$interval","$uibModal","$window","loadBalancerData","CiService","UIService","toaster","TranslationService","VulnerabilityService","VulnerabilitiesReportService",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(){return a.getLoadBalancerDataModel().monitoring&&a.getLoadBalancerDataModel().monitoring.checks?(i.monitoring=a.getLoadBalancerDataModel().monitoring,i.isInstanceMonitoringChecks=i.monitoring.checks.length>0,i.isInstanceMonitoringChecks?void a.setView("monitoring"):void a.goto("information")):(c.debug("trying to reach a unavailable monitoring view, redirecting..."),void a.goto("information"))}function g(a){return d.get("monitoring."+a.alarm).toLowerCase()}function h(b){e.openModal("loadbalancer",a.getLoadBalancerDataModel().id,b)}var i=this;i.isInstanceMonitoringChecks=void 0,i.monitoring=void 0,i.sortTranslation=g,i.showMonitoringStatusHistory=h,f()}angular.module("itcare.services").controller("ServiceDetailLoadBalancerMonitoringCtrl",["$scope","$state","$log","TranslationService","MonitoringStatusHistoryService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){j.configuration=a,j.resources.push({id:c.getLoadBalancerDataModel().id,resourceType:c.getLoadBalancerDataModel().resourceType}),j.start=f.start||moment().startOf("day").unix(),j.end=f.end||moment().add(1,"days").startOf("day").unix(),j.name=f.name||"",c.setView("performance"),e.go(".",{name:j.name,start:j.start,end:j.end}),i()}function i(){j._scope.$watch(function(){return j.configuration},function(a,b){angular.equals(a,b)||angular.forEach(j.configuration[c.getLoadBalancerDataModel().id],function(a){"full"==a.mode&&e.go(".",{name:a.name,start:a.start,end:a.end})})},!0)}var j=this;j._scope=c,j.resources=[],h()}angular.module("itcare.services").controller("ServiceDetailLoadBalancerPerformanceCtrl",["configurationLBData","ChartService","$scope","$log","$state","$stateParams","CiService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){p(j.data),t(e),h.setTitle(z.hardware.name),A(z.hardware.id,z.hardware.name,e.current.name),d.setViewLoading(!1);var b=a(function(){g.getHardwareDetailById(z.hardware.id,!0).then(function(a){p(a.data)})},n);d.$on("$destroy",function(){a.cancel(b)})}function p(a){if(z.hardware=a,z.criticalChecks=0,z.isMonitoring=z.hardware.monitoring&&z.hardware.monitoring.checks&&z.hardware.monitoring.checks.length>0,z.isPerformance=z.hardware.performance&&z.hardware.performance.metrics&&z.hardware.performance.metrics.length>0,z.hardware.monitoring){var b=i.filter(z.hardware.monitoring.checks,function(a){return 2==a.state});z.criticalChecks=b.length;var c=i.filter(z.hardware.monitoring.checks,function(a){return 1==a.state});z.warningChecks=c.length;var d=i.filter(z.hardware.monitoring.checks,function(a){return 5==a.state});z.maintenanceChecks=d.length}z.hardware.computedStatus={status:"RESOURCE_STATUS_"+z.hardware.status,icon:B[z.hardware.status].icon||"",color:B[z.hardware.status].color}}function q(a){"performance"==a?(z.currentViewIndex=2,z.currentView="performance"):"monitoring"==a?(z.currentViewIndex=1,z.currentView="monitoring"):(z.currentViewIndex=0,z.currentView="information")}function r(a){f.debug("set view : "+a),"monitoring"==a?(q("monitoring"),A(e.params.hardwareId,z.hardware.name,a)):"performance"==a?(q("performance"),A(e.params.hardwareId,z.hardware.name,a)):(q("information"),A(e.params.hardwareId,z.hardware.name,"information")),f.debug("after set view : "+a)}function s(a,b){var c={serviceId:d.getDataModel().id,id:z.hardware.id};switch(void 0!==b&&i.assignIn(c,b),a){case"information":r(a),e.go("services_detail.hardware.information",c);break;case"monitoring":z.hardware.monitoring&&(r(a),e.go("services_detail.hardware.monitoring",c));break;case"performance":r(a),e.go("services_detail.hardware.performance",c)}}function t(a){a.includes("**.performance")?(f.debug("currentView : performance"),q("performance")):a.includes("**.monitoring")?(f.debug("currentView : monitoring"),q("monitoring")):(f.debug("currentView : information"),q("information"))}function u(){return z.hardware}function v(){return z.hardware.monitoring}function w(){g.getHardwareDetailById(e.params.id).then(function(a){angular.isDefined(a)&&200===a.status&&(j.data=a.data,o())},function(a){f.error("Failed to loading hardware : "+a)})}function x(a,b){l.promptTagsInModal(c.translation,z.hardware.tags,"",b).then(function(c){b&&y(a,c)})}function y(a,b){d.setViewLoading(!0),g.patchTagsOfHardware(a,b).then(function(a){m.pop("success",k.get("TAGS_UPDATED_TITLE"),k.get("TAGS_UPDATED_BODY")),d.setViewLoading(!1),z.hardware.tags=angular.copy(b)},function(a){304===a.status&&m.pop("success",k.get("TAGS_UNMODIFIED_TITLE"),k.get("TAGS_UNMODIFIED_BODY")),d.setViewLoading(!1)})}var z=this;z.hardware=void 0,z.isMonitoring=!1,z.isPerformance=!1,z.criticalChecks=0,z.openTagsEditor=x,z.patchTags=y,z.goto=s,d.getHardwareDataModel=u,d.setHardwareDataModel=w,d.getHardwareMonitoringDataModel=v,d.setView=r,d.goto=s;var A=d.navigationSetHardware,B={ACTIVE:{icon:"fa-play",color:"text-success"},INACTIVE:{icon:"fa-pause",color:""},PREPARATION:{icon:"fa-refresh fa-spin",color:""}};o()}angular.module("itcare.services").controller("ServiceDetailHardwareCtrl",["$interval","$uibModal","$rootScope","$scope","$state","$log","CiService","UIService","lodash","hardwareData","TranslationService","TagsSelectorService","toaster","REFRESH_INTERVAL",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){q.colors=k.colors,q.configuration=a;var b=moment();q.start=moment(b).add(-1,"days").unix(),q.end=moment(b).unix(),c.setView("information"),q.resources.push(c.getHardwareDataModel()),q.canMonitoring=c.getHardwareDataModel().monitoringEnabled}var q=this;q.colors={},q.resources=[],q.canMonitoring=void 0,p()}angular.module("itcare.services").controller("ServiceDetailHardwareInformationCtrl",["configurationData","$rootScope","$scope","$log","$state","$interval","$uibModal","$window","hardwareData","CiService","UIService","toaster","TranslationService","VulnerabilityService","VulnerabilitiesReportService",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(){return a.getHardwareDataModel().monitoringEnabled?(i.monitoring=a.getHardwareMonitoringDataModel(),i.isHardwareMonitoringChecks=i.monitoring.checks.length>0,i.isHardwareMonitoringChecks?void a.setView("monitoring"):void a.goto("information")):(c.debug("trying to reach a unavailable monitoring view, redirecting..."),void a.goto("information"))}function g(a){return d.get("monitoring."+a.alarm).toLowerCase()}function h(b){e.openModal("hardware",a.getHardwareDataModel().id,b)}var i=this;i.isHardwareMonitoringChecks=void 0,i.monitoring=void 0,i.sortTranslation=g,i.showMonitoringStatusHistory=h,f()}angular.module("itcare.services").controller("ServiceDetailHardwareMonitoringCtrl",["$scope","$state","$log","TranslationService","MonitoringStatusHistoryService",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){m.configuration=a,m.resources.push({id:e.getHardwareDataModel().id,resourceType:e.getHardwareDataModel().resourceType}),m.start=h.start||moment().startOf("day").unix(),m.end=h.end||moment().add(1,"days").startOf("day").unix(),m.name=h.name||"",e.setView("performance"),g.go(".",{name:m.name,start:m.start,end:m.end}),l()}function l(){m._scope.$watch(function(){return m.configuration},function(a,b){if(!angular.equals(a,b)){var c=!1;angular.forEach(m.configuration[[e.getHardwareDataModel().id]],function(a){"full"==a.mode&&(c=!0,g.go(".",{name:a.name,start:a.start,end:a.end}))}),c||g.go(".",{start:m.configuration[[e.getHardwareDataModel().id]][0].start,end:m.configuration[[e.getHardwareDataModel().id]][0].end})}},!0)}var m=this;m._scope=e,m.resources=[],k()}angular.module("itcare.services").controller("ServiceDetailHardwarePerformanceCtrl",["configurationData","ChartService","$http","lodash","$scope","$log","$state","$stateParams","CiService","$filter",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){r(i.data),j.setTitle(L.cluster.name),u(f),M(f.params.clusterId,L.clusterName,L.currentView),l.appendPreference("last-views",{id:L.cluster.id,name:L.cluster.name,type:"cluster",serviceId:f.params.serviceId}),e.setViewLoading(!1);var b=a(function(){if(!N){N=!0;k.getClusterDetailById({clusterId:L.cluster.id},!0).then(function(a){r(a.data),N=!1},function(){N=!1})}},p);e.$on("$destroy",function(){a.cancel(b)})}function r(a){if(L.cluster=a,L.isMonitored=!1,L.clusterName=L.cluster.name,L.criticalChecks=0,L.warningChecks=0,L.maintenanceChecks=0,L.hasCpuRamInfo=L.cluster.information&&L.cluster.information.cpus&&L.cluster.information.ram,L.cluster.monitoringEnabled){var b=h.filter(L.cluster.monitoring.checks,function(a){return 2==a.state});L.criticalChecks=b.length;var c=h.filter(L.cluster.monitoring.checks,function(a){return 1==a.state});L.warningChecks=c.length;var d=h.filter(L.cluster.monitoring.checks,function(a){return 5==a.state});L.maintenanceChecks=d.length}C(),L.automation={actionInProgress:w().actionsInProgress.length>0},L.cluster.computedStatus={status:"RESOURCE_STATUS_"+L.cluster.status,icon:O[L.cluster.status].icon||"",color:O[L.cluster.status].color},h.forEach(L.cluster.tags,function(a){a.tagValue=a.tagValue.split("&#58;").join(":")}),angular.forEach(L.cluster.actionsInProgress,function(a){switch(a.lastUpdatedAt=moment(a.lastUpdatedAt),a.process){case"CREATE_VM":case"CREATE_VM_ITCARE":case"DELETE_VM":case"DISABLE_VM":case"ENABLE_VM":L.cluster.computedStatus={status:"RESOURCE_STATUS_"+a.process+"_"+a.status,icon:"IN_PROGRESS"==a.status?"fa-spin fa-gear":"fa-exclamation-triangle",color:"IN_PROGRESS"==a.status?"text-primary":"text-danger"}}})}function s(a){g.debug("set view : "+a),"monitoring"==a?(t("monitoring"),M(f.params.clusterId,L.clusterName,a)):"performance"==a?(t("performance"),M(f.params.clusterId,L.clusterName,a)):(t("information"),M(f.params.clusterId,L.clusterName,"information")),g.debug("after set view : "+a)}function t(a){"performance"==a?(L.currentViewIndex=2,L.currentView="performance"):"monitoring"==a?(L.currentViewIndex=1,L.currentView="monitoring"):(L.currentViewIndex=0,L.currentView="information")}function u(a){a.includes("**.performance")?(g.debug("currentView : performance"),t("performance")):a.includes("**.monitoring")?(g.debug("currentView : monitoring"),t("monitoring")):(g.debug("currentView : information"),t("information"))}function v(a,b){var c={serviceId:e.getDataModel().id,clusterId:L.cluster.id};switch(void 0!==b&&h.assignIn(c,b),a){case"information":s(a),f.go("services_detail.cluster.information",c);break;case"monitoring":L.cluster.monitoringEnabled&&(s(a),f.go("services_detail.cluster.monitoring",c));break;case"performance":s(a),f.go("services_detail.cluster.performance",c)}}function w(){return L.cluster}function x(){k.getClusterDetailById(f.params).then(function(a){angular.isDefined(a)&&200===a.status&&(i.data=a.data,q(),d.callbackAutomationListener())},function(a){g.error("Failed to loading cluster : "+a)})}function y(){return L.cluster.information}function z(){c.open({animation:!0,templateUrl:"/services/detail/automation/delete-instance.html",controller:"DeleteInstanceCtrl",controllerAs:"newDelete",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.deleteVM(f.params,a.rfc).then(function(a){g.debug("Activate instance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_DELETE_VM")),e.setClusterDataModel(),f.go("services_detail.dashboard",{serviceId:e.getDataModel().id})):g.debug("there is no automation for this instance, status "+a.status)},function(a){g.error("Failed to submit activate vm: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function A(a,b){n.promptTagsInModal(d.translation,L.cluster.tags,"",b).then(function(c){b&&B(a,c)})}function B(a,c){e.setViewLoading(!0),k.patchTagsOfCluster(a,c).then(function(a){b.pop("success",m.get("TAGS_UPDATED_TITLE"),m.get("TAGS_UPDATED_BODY")),e.setViewLoading(!1),L.cluster.tags=angular.copy(c)},function(a){304===a.status&&b.pop("success",m.get("TAGS_UNMODIFIED_TITLE"),m.get("TAGS_UNMODIFIED_BODY")),e.setViewLoading(!1)})}function C(){var a={};h.forEach(L.cluster.availableActions,function(b){var c="";b.available||h.forEach(b.unavailabilityCauses,function(a){c+=m.get("ACTION.ERROR."+a.toUpperCase())+"<br/>"}),L.cluster.actionsInProgress.length>0&&(b.available=!1,c+=m.get("ACTION_ALERT_UNAVAILABLE_ACTION")+"<br/>"),a[b.operation]={available:b.available,errors:c}}),L.cluster.availableActions=a}function D(){c.open({animation:!0,templateUrl:"/services/detail/automation/create-maintenance.html",controller:"CreateMaintenanceCtrl",controllerAs:"newMain",size:"lg",backdrop:"static",keyboard:!0,resolve:{serviceSelection:function(){return e.getDataModel()},instanceSelection:function(){return L.cluster},clusterSelection:function(){return L.cluster},loadBalancerSelection:function(){},choiceMode:0}}).result.then(function(a){var c={description:a.description,changeReference:a.rfc,startAt:moment(a.ranges.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),endAt:moment(a.ranges.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),resources:a.synthesisInstance.concat(a.synthesisLB)};k.createMaintenance(f.params,c).then(function(a){g.debug("Creating maintenance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_CREATE_DOWNTIME")),e.setClusterDataModel()):g.debug("there is no automation for this cluster, status "+a.status)},function(a){g.error("Failed to create maintenance: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function E(a){var b=new Date,c=new Date(a);return!(b.getTime()>c.getTime())}function F(){c.open({animation:!0,templateUrl:"/services/detail/automation/enable-monitoring-instance.html",controller:"EnableMonitoringInstanceCtrl",controllerAs:"enableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.enableClusterMonitoringStatus(f.params,a.rfc).then(function(a){g.debug("Enable monitoring cluster http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_ENABLE_MONITORING")),e.setClusterDataModel()):g.debug("there is no automation for this cluster, status "+a.status)},function(a){g.error("Failed to enable monitoring: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function G(){c.open({animation:!0,templateUrl:"/services/detail/automation/disable-monitoring-instance.html",controller:"DisableMonitoringInstanceCtrl",controllerAs:"disableMonitoringView",size:"md",backdrop:"static",keyboard:!0}).result.then(function(a){k.disableClusterMonitoringStatus(f.params,a.rfc).then(function(a){g.debug("Disable monitoring cluster http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_CONFIRM_DISABLE_MONITORING")),e.setClusterDataModel()):g.debug("there is no automation for this cluster, status "+a.status)},function(a){g.error("Failed to disable monitoring: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function H(){var a=!1,b=L.cluster.actionsInProgress;for(var c in b)switch(b[c].process){case"DISABLE_MONITORING":a=!0;case"ENABLE_MONITORING":a=!0}return a}function x(){k.getClusterDetailById(f.params).then(function(a){angular.isDefined(a)&&200===a.status&&(i.data=a.data,q(),d.callbackAutomationListener())},function(a){g.error("Failed to loading cluster : "+a)})}function I(a){c.open({animation:!0,templateUrl:"/services/detail/automation/delete-namespace.html",controller:"DeleteNamespaceCtrl",controllerAs:"newDelete",size:"lg",backdrop:"static",keyboard:!0}).result.then(function(c){k.deleteNamespace(f.params,a).then(function(a){g.debug("Delete maintenance http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_MENU_DELETE_NAMESPACE_PROCESS")),e.setClusterDataModel()):g.debug("there is no automation for this namespace, status "+a.status)},function(a){g.error("Failed to delete namespace: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function J(){c.open({animation:!0,templateUrl:"/services/detail/automation/create-namespace.html",controller:"CreateNamespaceCtrl",controllerAs:"newNamespace",size:"lg",backdrop:"static",keyboard:!0}).result.then(function(a){k.createNamespace(f.params,a.name).then(function(a){g.debug("Create namespace http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_MENU_CREATE_NAMESPACE_PROCESS")),e.setClusterDataModel()):g.debug("there is no automation for this cluster, status "+a.status)},function(a){g.error("Failed to create namespace: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}function K(){c.open({animation:!0,templateUrl:"/services/detail/automation/create-nodes.html",controller:"CreateNodesCtrl",controllerAs:"newNodes",size:"lg",backdrop:"static",keyboard:!0}).result.then(function(a){k.createNodes(f.params,a).then(function(a){g.debug("Create nodes http status : "+a.status),202===a.status?(b.pop("success",m.get("ACTION_MENU_CREATE_NODES_PROCESS")),e.setClusterDataModel()):g.debug("there is no automation for this cluster, status "+a.status)},function(a){g.error("Failed to create nodes: "+a)})},function(){g.info("Modal dismissed at: "+new Date)})}var L=this;L.cluster={memberNodes:[]},L.isMonitored=void 0,L.clusterName=void 0,L.currentViewIndex=void 0,L.currentView=void 0,L.criticalChecks=0,L.availableActions=void 0,L.goto=v;var M=e.navigationSetInstance,C=C,N=!1;e.getClusterDataModel=w,e.setClusterDataModel=x,e.getClusterInformationDataModel=y,e.setView=s,e.goto=v,e.enableDate=E,L.createNodes=K,L.createNamespace=J,L.deleteNamespace=I,L.setClusterDataModel=x,L.createMaintenance=D,L.deleteInstance=z,L.openTagsEditor=A,L.patchTags=B,L.callActionsFunction=k.getActionsByClusterId,L.enableMonitoringInstance=F,L.disableMonitoringInstance=G,L.isMonitoringProcess=H,d.callbackAutomationListener=function(){};var O={ACTIVE:{icon:"fa-play",color:"text-success"},INACTIVE:{icon:"fa-pause",color:""},PREPARATION:{icon:"fa-refresh fa-spin",color:""}};q(),e.$on("$destroy",function(){angular.isDefined(L.interval)&&a.cancel(L.interval)})}angular.module("itcare.services").controller("ServiceDetailClusterCtrl",["$interval","toaster","$uibModal","$rootScope","$scope","$state","$log","lodash","clusterData","UIService","CiService","UserPreferencesService","TranslationService","TagsSelectorService","$ngBootbox","REFRESH_INTERVAL",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){}function t(a){}function u(){}function v(){}function w(){o.createCluster(y.clusterName,j.id,y.selectedPlatform.id,y.selectedRegion.id,y.selectedArea.id,y.selectedAvailabilityZone.id,y.selectedNetwork.id,y.selectedResources.id,y.selectedPlatform.storage.volumes,y.selectedPlatform.properties,y.backupRemoteSiteEnabled,y.backupEnabled,y.monitoring247Enabled,y.monitoringEnabled,y.selectedAuthenticationDomain.id,y.specificRequest,y.debugModeEnabled,y.dryRunEnabled).then(function(a){202!==a.status?g.debug("there is no automation for this cluster, status "+a.status):(e.pop("success",m.get("ACTION_CONFIRM_CREATE_VM")),y.dryRunEnabled||f.close())},function(a){g.error("Failed to create vm: "+a.data[0].code)})}function x(){f.dismiss("cancel")}var y=this;y.loaded=!1,y.modelWizard=void 0,y.isCurrentFormValid=!1,y.steps=[],y.customizationStep=[],y.wizardForm={},y.wizardForm.volumeEdition=void 0,y.firstPatternName=new RegExp("^["+j.environment.charAt(0)+"]","i"),y.secondPatternName=new RegExp("^["+j.environment.charAt(0)+"][A-Z0-9]{1,12}","i"),y.thirdPatternName=new RegExp("[0-9]{2,3}?$","i"),y.platforms=[],y.platformsLoading=!1,y.resources=[],y.selectedResourcesIdx=0,y.resourcesSliderOptions={},y.regions=[],y.availabilityZones=void 0,y.networks=void 0,y.authenticationDomains=void 0,y.suggestedHostNames=[],y.roles=[{id:"frontend",icon:"fa-globe",name:"Frontend",description:m.get("CREATEVM_NETWORK_ROLE_FRONTEND")},{id:"backend",icon:"fa-database",name:"Backend",description:m.get("CREATEVM_NETWORK_ROLE_BACKEND")},{id:"mixed",icon:"fa-list",name:m.get("ALL"),description:m.get("CREATEVM_NETWORK_ROLE_ALL")}],y.cancel=x,y.next=u,y.previous=v,y.submit=w,y.refreshSlider=refreshSlider,y.gotoStep=t,y.previousAuthorized=previousAuthorized,y.nextAuthorized=nextAuthorized,s()}angular.module("itcare.services").controller("ClusterCreationCtrl",["$rootScope","$scope","$state","$timeout","toaster","$uibModalCluster","$log","errorProvider","lodash","service","CiService","UserService","TranslationService","$q","ClusterService","UtilService","HelpService","MFForm",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){a.currentSection="compute",i.stateName="services_detail.cluster.information",i.information=b.getClusterInformationDataModel(),i.resourceInformation=b.getClusterDataModel(),i.name=i.resourceInformation.name,i.isIntanceSourceOf=!1,i.isIntanceTargetOf=!0,i.ui={fsCollapsed:!1},i.resources.push(i.resourceInformation),b.setView("information")}var i=this;i.ui=void 0,i.name=void 0,i.resourceInformation=void 0,i.stateName=void 0,i.information=void 0,i.requests=void 0,i.maintenances=void 0,i.isIntanceSourceOf=void 0,i.isIntanceTargetOf=void 0,i.canMonitoring=void 0,i.snapshotId=void 0,i.resources=[],a.callbackAutomationListener=h,h()}angular.module("itcare.services").controller("ServiceDetailClusterInformationCtrl",["$rootScope","$scope","$log","CiService","toaster","TranslationService","$uibModal",a])}(),function(){"use strict";angular.module("itcare.platforms",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","toaster"])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){h.platforms=c.data,a.currentSection="platforms",e.setTitle("Support Policy")}var h=this;h.platforms=[],g()}angular.module("itcare.platforms").controller("PlatformsCtrl",["$rootScope","$state","platforms","$log","UIService","TranslationService",a])}(),function(){"use strict";angular.module("itcare.platforms").config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log");a.state("platforms",{url:"/compute/instances-support-policy",templateUrl:"/services/platforms/platforms.html",controller:"PlatformsCtrl",controllerAs:"ptf",resolve:{platforms:["PlatformsService",function(a){return a.getPlatforms()}]},ncyBreadcrumb:{label:"{{translation.MENU_COMPUTE_SUPPORTED_PLATFORMS_TITLE}}",parent:"compute"}})}])}(),function(){"use strict";angular.module("itcare.components").controller("SupportTicketCreationCtrl",["$scope","$filter","$log","$timeout","$uibModal","TranslationService","CreateTicketService","toaster","errorProvider","lodash","$window","$q",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a={button:!0,text:"Contacter le support",classes:"nav-link"},b=angular.extend(a,o.options);c.debug("Options passed :"),c.debug(o.options),c.debug("Options merged :"),c.debug(b),c.debug(o.resource)}function n(){e.open({animation:a.animationsEnabled,templateUrl:"/ticket/creation/create-ticket.modal.html",controller:"TicketCreationCtrl",controllerAs:"nt",size:"lg",backdrop:"static",keyboard:!0,resolve:{resource:function(){return{id:o.resource.id,type:o.resource.resourceType,serviceId:o.resource.serviceId,serviceName:o.resource.name}}}})}var o=this;o.openTicketCreationDialog=n,m()}]).directive("supportTicket",function(){return{restrict:"EA",templateUrl:"components/support-ticket.template.html",bindToController:{translation:"=",resource:"=",options:"=?"},controllerAs:"support",controller:"SupportTicketCreationCtrl"}})}(),function(){"use strict";angular.module("itcare.components").controller("HighlightCtrl",["$scope","$log","UIService",function(a,b,c){function d(){var d={primary:{name:"primary",background:c.colors.primary,inverseIconClass:"fa-inverse"},warning:{name:"warning",background:c.colors.warning,inverseIconClass:"fa-inverse"},danger:{name:"danger",background:c.colors.danger,inverseIconClass:"fa-inverse"},success:{name:"success",background:c.colors.success,inverseIconClass:"fa-inverse"},green:{name:"green",background:c.colors.green,inverseIconClass:"fa-inverse"},gray:{name:"gray",background:c.colors["gray-lighter"],inverseIconClass:""},"gray-lighter":{name:"gray-lighter",background:c.colors["gray-lighter"],inverseIconClass:""},black:{name:"black",background:c.colors.black,inverseIconClass:"fa-inverse"},red:{name:"red",background:c.colors.red,inverseIconClass:"fa-inverse"},darker:{name:"darker",background:c.colors.darker,inverseIconClass:"fa-inverse"}};switch(g.size=void 0!==g.size?g.size:"md",g.fontSize=void 0!==g.fontSize?g.fontSize:g.size,g.size){case"lg":g.padding="10px",g.marginTopInfo="-10px",g.iconWidth="60px",g.iconSizeClass="fa-2x";break;case"sm":g.padding="6px",g.marginTopInfo="-6px",g.iconWidth="40px",g.iconSizeClass="";break;case"xs":g.padding="4px",g.marginTopInfo="-4px",g.iconWidth="30px",g.iconSizeClass="";break;case"md":default:g.padding="8px",g.marginTopInfo="-8px",g.iconWidth="50px",g.iconSizeClass="fa-2x"}switch(g.fontSize){case"lg":g.factFontSize="300%",g.legendFontSize="70%";break;case"sm":g.factFontSize="100%",g.legendFontSize="65%";break;case"xs":g.factFontSize="80%",g.legendFontSize="60%";break;case"md":default:g.factFontSize="200%",g.legendFontSize="70%"}g.legend=void 0!==g.legend?g.legend:"",g.isTooltip=void 0!==g.tooltip,g.enableToggle=void 0!==g.enableToggle&&g.enableToggle,g.opened=void 0!==g.opened&&g.opened,g.ui=d[g.theme],g.isLink=void 0!==a.click,g.showIcon=void 0===g.showIcon||g.showIcon,a.$watch("vm.theme",function(a,c){b.debug("handleThemeChange:",a),g.ui=d[a]})}function e(){g.isLink&&(b.debug("onClick launched"),a.click())}function f(){g.opened=!g.opened}var g=this;g.toggle=f,g.onClick=e,d()}]).directive("highlight",function(){return{restrict:"E",transclude:!0,scope:{click:"&onLink"},templateUrl:"components/highlight.template.html",bindToController:{theme:"=?",fontSize:"=?",icon:"=",fact:"=",legend:"=?",size:"=?",tooltip:"=?",enableToggle:"=?",enableLink:"=?",opened:"=?",showIcon:"=?",id:"=?"},controllerAs:"vm",controller:"HighlightCtrl"}})}(),function(){"use strict";angular.module("itcare.services").directive("watchScopeUi",["ConfStateUiView","$log","lodash",function(a,b,c){return{restrict:"E",scope:{ui:"=",stateName:"=",exclusions:"@"},link:function(d){function e(a,b){var c=g.reduce(a,function(a,c,d){return g.isEqual(c,b[d])?a:a.concat(d)},[]);return 1==c.length?c[0]:[]}function f(a,b){var c=e(a,b);return g.includes(h,c)}var g=c,h=d.exclusions?d.exclusions.split(/[\s,]+/).join():[];d.ui=a.getUILocalStorage(d.stateName,d.ui),d.$watch("ui",function(c,e){if(f(c,e))b.debug("We don't persist this modification ");else{if(angular.equals(c,e))return;a.persistUILocalStorage(d.stateName,c),b.debug("Persisting modifications ")}},!0)}}}])}(),function(){"use strict";angular.module("itcare.services").directive("myCustomDirective",["$timeout",function(a){return{restrict:"EA",transclude:!0,scope:{value:"=value"},template:' <span class="input-group spinner" ng-style="width"><input type="text" class="align-left form-control" ng-model="value" ng-blur="blurred()" ng-change="changed()" ng-readonly="readonly"><div class="input-group-btn-vertical"><button class="btn btn-default" type="button" ng-click="minus()"><i class="fa fa-caret-up"></i></button><button class="btn btn-default" type="button" ng-click="plus()"><i class="fa fa-caret-down"></i></button> </div> </span>',replace:!0,link:function(b,c,d){var e,f,g=angular.isUndefined(d.min)?void 0:parseInt(d.min),h=angular.isUndefined(d.max)?void 0:parseInt(d.max),i=angular.isUndefined(d.step)||0===parseInt(d.step)?1:parseInt(d.step);if(e=function(a){var b=parseInt(a);return isNaN(b)?b=g||0:void 0!==g&&g>b?b=g:void 0!==h&&h<b?b=h:b},angular.isUndefined(b.value))throw"Missing the value attribute on the counter directive.";b.readonly=!!angular.isUndefined(d.editable),b.addclass=angular.isUndefined(d.addclass)?null:d.addclass,b.width=angular.isUndefined(d.width)?{}:{width:d.width},b.value=e(b.value),b.minus=function(){b.value=e(b.value-i)},b.plus=function(){b.value=e(b.value+i)},b.changed=function(){f=a(function(){b.value=e(b.value)},1e3,!0)},b.blurred=function(){b.value=e(b.value)}}}}])}(),function(){"use strict";angular.module("itcare.public",["itcare.business","ngLodash","ngAnimate","ui.bootstrap","ng-showdown"])}(),function(){"use strict";angular.module("itcare.public").config(["$stateProvider",function(a){a.state("public-tour",{url:"/public/tour",templateUrl:"/public/tour/tour.html",reloadOnSearch:!1,controller:"TourCtrl",controllerAs:"tour",data:{restricted:!1}}).state("public-contact-us",{url:"/support/contact-us",templateUrl:"/public/support/contact-us.html",controller:"HelpSupportCtrl",controllerAs:"hs",data:{restricted:!1}}).state("public-support-faq",{url:"/support/faq",templateUrl:"/public/support/support-faq.html",controller:"SupportQACtrl",controllerAs:"qa",data:{restricted:!1}}).state("public-support-howto-request-support",{url:"/support/howto-request-support",templateUrl:"/public/support/howto-support.html",controller:"HowToSupportCtrl",controllerAs:"howto",data:{restricted:!1}})}])}(),function(){"use strict";function a(a,b,c,d){function e(){d.setTitle("ITCare Tour"),d.enableFooter()}a.currentSection="tour";e()}angular.module("itcare.public").controller("TourCtrl",["$rootScope","$log","TranslationService","UIService",a])}(),function(){"use strict";function a(a,b,c,d){function e(){d.setTitle("Contact Us"),d.enableFooter()}a.currentSection="contact-us";e()}angular.module("itcare.public").controller("HelpSupportCtrl",["$rootScope","$log","TranslationService","UIService",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(){e.setTitle("Support - QA"),e.enableFooter(),c.get("/assets/help/support-faq-"+a.lang+".md").then(function(a){g.mdQA=a.data})}a.currentSection="contact-us";var g=this;g.mdQA="",f()}angular.module("itcare.public").controller("SupportQACtrl",["$rootScope","$log","$http","TranslationService","UIService",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(){e.setTitle("Contact Us"),e.enableFooter(),c.get("/assets/help/support-howto-request-"+a.lang+".md").then(function(a){g.mdHowTo=a.data})}a.currentSection="contact-us";var g=this;f()}angular.module("itcare.public").controller("HowToSupportCtrl",["$rootScope","$log","$http","TranslationService","UIService",a])}(),function(){"use strict";angular.module("magic-forms",["ngLodash","ngMessages","ui.bootstrap","ngFileUpload"])}();var MFExprParserObj;!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.exprEval=b()}(this,function(){"use strict";function a(a,b){this.type=a,this.value=void 0!==b&&null!==b?b:0}function b(b){return new a(Z,b)}function c(b){return new a($,b)}function d(b){return new a(_,b)}function e(b,c,d,f,g){for(var h,i,j,k,l=[],m=[],n=0;n<b.length;n++){var o=b[n],p=o.type;if(p===Y)l.push(o);else if(p===aa&&g.hasOwnProperty(o.value))o=new a(Y,g[o.value]),l.push(o);else if(p===$&&l.length>1)i=l.pop(),h=l.pop(),k=d[o.value],o=new a(Y,k(h.value,i.value)),l.push(o);else if(p===_&&l.length>2)j=l.pop(),i=l.pop(),h=l.pop(),"?"===o.value?l.push(h.value?i.value:j.value):(k=f[o.value],o=new a(Y,k(h.value,i.value,j.value)),l.push(o));else if(p===Z&&l.length>0)h=l.pop(),k=c[o.value],o=new a(Y,k(h.value)),l.push(o);else if(p===ca){for(;l.length>0;)m.push(l.shift());m.push(new a(ca,e(o.value,c,d,f,g)))}else if(p===da&&l.length>0)h=l.pop(),l.push(new a(Y,h.value[o.value]));else{for(;l.length>0;)m.push(l.shift());m.push(o)}}for(;l.length>0;)m.push(l.shift());return m}function f(e,g,h){for(var i=[],j=0;j<e.length;j++){var k=e[j],l=k.type;if(l===aa&&k.value===g)for(var m=0;m<h.tokens.length;m++){var n,o=h.tokens[m];n=o.type===Z?b(o.value):o.type===$?c(o.value):o.type===_?d(o.value):new a(o.type,o.value),i.push(n)}else l===ca?i.push(new a(ca,f(k.value,g,h))):i.push(k)}return i}function g(a,b,c){for(var d,e,f,h,i=[],j=0;j<a.length;j++){var k=a[j],l=k.type;if(l===Y)i.push(k.value);else if(l===$)e=i.pop(),d=i.pop(),h=b.binaryOps[k.value],i.push(h(d,e));else if(l===_)f=i.pop(),e=i.pop(),d=i.pop(),"?"===k.value?i.push(g(d?e:f,b,c)):(h=b.ternaryOps[k.value],i.push(h(d,e,f)));else if(l===aa)if(k.value in b.functions)i.push(b.functions[k.value]);else{var m=c[k.value];if(void 0===m)throw new Error("undefined variable: "+k.value);i.push(m)}else if(l===Z)d=i.pop(),h=b.unaryOps[k.value],i.push(h(d));else if(l===ba){for(var n=k.value,o=[];n-- >0;)o.unshift(i.pop());if(h=i.pop(),!h.apply||!h.call)throw new Error(h+" is not a function");i.push(h.apply(void 0,o))}else if(l===ca)i.push(k.value);else{if(l!==da)throw new Error("invalid Expression");d=i.pop(),i.push(d[k.value])}}if(i.length>1)throw new Error("invalid Expression (parity)");return i[0]}function h(a,b){for(var c,d,e,f,g=[],j=0;j<a.length;j++){var k=a[j],l=k.type;if(l===Y)"number"==typeof k.value&&k.value<0?g.push("("+k.value+")"):g.push(i(k.value));else if(l===$)d=g.pop(),c=g.pop(),f=k.value,b?"^"===f?g.push("Math.pow("+c+", "+d+")"):"and"===f?g.push("(!!"+c+" && !!"+d+")"):"or"===f?g.push("(!!"+c+" || !!"+d+")"):"||"===f?g.push("(String("+c+") + String("+d+"))"):"=="===f?g.push("("+c+" === "+d+")"):"!="===f?g.push("("+c+" !== "+d+")"):g.push("("+c+" "+f+" "+d+")"):g.push("("+c+" "+f+" "+d+")");else if(l===_){if(e=g.pop(),d=g.pop(),c=g.pop(),"?"!==(f=k.value))throw new Error("invalid Expression");g.push("("+c+" ? "+d+" : "+e+")")}else if(l===aa)g.push(k.value);else if(l===Z)c=g.pop(),f=k.value,"-"===f||"+"===f?g.push("("+f+c+")"):b?"not"===f?g.push("(!"+c+")"):"!"===f?g.push("fac("+c+")"):g.push(f+"("+c+")"):"!"===f?g.push("("+c+"!)"):g.push("("+f+" "+c+")");else if(l===ba){for(var m=k.value,n=[];m-- >0;)n.unshift(g.pop());f=g.pop(),g.push(f+"("+n.join(", ")+")")}else if(l===da)c=g.pop(),g.push(c+"."+k.value);else{if(l!==ca)throw new Error("invalid Expression");g.push("("+h(k.value,b)+")")}}if(g.length>1)throw new Error("invalid Expression (parity)");return String(g[0])}function i(a){return"string"==typeof a?JSON.stringify(a).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):a}function j(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}function k(a,b,c){c=c||{};for(var d=!!c.withMembers,e=null,f=0;f<a.length;f++){var g=a[f];g.type!==aa||j(b,g.value)?g.type===da&&d&&null!==e?e+="."+g.value:g.type===ca?k(g.value,b,c):null!==e&&(j(b,e)||b.push(e),e=null):d?null!==e?(j(b,e)||b.push(e),e=g.value):e=g.value:b.push(g.value)}null===e||j(b,e)||b.push(e)}function l(a,b){this.tokens=a,this.parser=b,this.unaryOps=b.unaryOps,this.binaryOps=b.binaryOps,this.ternaryOps=b.ternaryOps,this.functions=b.functions}function m(a,b,c){this.type=a,this.value=b,this.index=c}function n(a,b){this.pos=0,this.current=null,this.unaryOps=a.unaryOps,this.binaryOps=a.binaryOps,this.ternaryOps=a.ternaryOps,this.consts=a.consts,this.expression=b,this.savedPosition=0,this.savedCurrent=null,this.options=a.options}function o(a){return ma.hasOwnProperty(a)?ma[a]:a}function p(a,b,c){this.parser=a,this.tokens=b,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==c.allowMemberAccess}function q(a,b){return Number(a)+Number(b)}function r(a,b){return a-b}function s(a,b){return a*b}function t(a,b){return a/b}function u(a,b){return a%b}function v(a,b){return""+a+b}function w(a,b){return a===b}function x(a,b){return a!==b}function y(a,b){return a>b}function z(a,b){return a<b}function A(a,b){return a>=b}function B(a,b){return a<=b}function C(a,b){return Boolean(a&&b)}function D(a,b){return Boolean(a||b)}function E(a,b){return j(b,a)}function F(a){return(Math.exp(a)-Math.exp(-a))/2}function G(a){return(Math.exp(a)+Math.exp(-a))/2}function H(a){return a===1/0?1:a===-1/0?-1:(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))}function I(a){return a===-1/0?a:Math.log(a+Math.sqrt(a*a+1))}function J(a){return Math.log(a+Math.sqrt(a*a-1))}function K(a){return Math.log((1+a)/(1-a))/2}function L(a){return Math.log(a)*Math.LOG10E}function M(a){return-a}function N(a){return!a}function O(a){return a<0?Math.ceil(a):Math.floor(a)}function P(a){return Math.random()*(a||1)}function Q(a){return S(a+1)}function R(a){return isFinite(a)&&a===Math.round(a)}function S(a){var b,c;if(R(a)){if(a<=0)return isFinite(a)?1/0:NaN;if(a>171)return 1/0;for(var d=a-2,e=a-1;d>1;)e*=d,d--;return 0===e&&(e=1),e}if(a<.5)return Math.PI/(Math.sin(Math.PI*a)*S(1-a));if(a>=171.35)return 1/0;if(a>85){var f=a*a,g=f*a,h=g*a,i=h*a;return Math.sqrt(2*Math.PI/a)*Math.pow(a/Math.E,a)*(1+1/(12*a)+1/(288*f)-139/(51840*g)-571/(2488320*h)+163879/(209018880*i)+5246819/(75246796800*i*a))}--a,c=ra[0];for(var j=1;j<ra.length;++j)c+=ra[j]/(a+j);return b=a+qa+.5,Math.sqrt(2*Math.PI)*Math.pow(b,a+.5)*Math.exp(-b)*c}function T(a){return String(a).length}function U(){for(var a=0,b=0,c=0;c<arguments.length;c++){var d,e=Math.abs(arguments[c]);b<e?(d=b/e,a=a*d*d+1,b=e):e>0?(d=e/b,a+=d*d):a+=e}return b===1/0?1/0:b*Math.sqrt(a)}function V(a,b,c){return a?b:c}function W(a,b){return void 0===b||0==+b?Math.round(a):(a=+a,b=-+b,isNaN(a)||"number"!=typeof b||b%1!=0?NaN:(a=a.toString().split("e"),a=Math.round(+(a[0]+"e"+(a[1]?+a[1]-b:-b))),a=a.toString().split("e"),+(a[0]+"e"+(a[1]?+a[1]+b:b))))}function X(a){this.options=a||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||F,cosh:Math.cosh||G,tanh:Math.tanh||H,asinh:Math.asinh||I,acosh:Math.acosh||J,atanh:Math.atanh||K,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||L,log10:Math.log10||L,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||O,"-":M,"+":Number,exp:Math.exp,not:N,length:T,"!":Q},this.binaryOps={"+":q,"-":r,"*":s,"/":t,"%":u,"^":Math.pow,"||":v,"==":w,"!=":x,">":y,"<":z,">=":A,"<=":B,and:C,or:D,in:E},this.ternaryOps={"?":V},this.functions={random:P,fac:Q,min:Math.min,max:Math.max,hypot:Math.hypot||U,pyt:Math.hypot||U,pow:Math.pow,atan2:Math.atan2,if:V,gamma:S,roundTo:W},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}var Y="INUMBER",Z="IOP1",$="IOP2",_="IOP3",aa="IVAR",ba="IFUNCALL",ca="IEXPR",da="IMEMBER";a.prototype.toString=function(){switch(this.type){case Y:case Z:case $:case _:case aa:return this.value;case ba:return"CALL "+this.value;case da:return"."+this.value;default:return"Invalid Instruction"}},l.prototype.simplify=function(a){return a=a||{},new l(e(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,a),this.parser)},l.prototype.substitute=function(a,b){return b instanceof l||(b=this.parser.parse(String(b))),new l(f(this.tokens,a,b),this.parser)},l.prototype.evaluate=function(a){return a=a||{},g(this.tokens,this,a)},l.prototype.toString=function(){return h(this.tokens,!1)},l.prototype.symbols=function(a){a=a||{};var b=[];return k(this.tokens,b,a),b},l.prototype.variables=function(a){a=a||{};var b=[];k(this.tokens,b,a);var c=this.functions;return b.filter(function(a){return!(a in c)})},l.prototype.toJSFunction=function(a,b){var c=this,d=new Function(a,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+h(this.simplify(b).tokens,!0)+"; }");return function(){return d.apply(c,arguments)}};var ea="TEOF",fa="TOP",ga="TNUMBER",ha="TSTRING",ia="TPAREN",ja="TCOMMA",ka="TNAME";m.prototype.toString=function(){return this.type+": "+this.value},n.prototype.newToken=function(a,b,c){return new m(a,b,null!=c?c:this.pos)},n.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},n.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},n.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(ea,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},n.prototype.isString=function(){var a=!1,b=this.pos,c=this.expression.charAt(b);if("'"===c||'"'===c)for(var d=this.expression.indexOf(c,b+1);d>=0&&this.pos<this.expression.length;){if(this.pos=d+1,"\\"!==this.expression.charAt(d-1)){var e=this.expression.substring(b+1,d);this.current=this.newToken(ha,this.unescape(e),b),a=!0;break}d=this.expression.indexOf(c,d+1)}return a},n.prototype.isParen=function(){var a=this.expression.charAt(this.pos);return("("===a||")"===a)&&(this.current=this.newToken(ia,a),this.pos++,!0)},n.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken(ja,","),this.pos++,!0)},n.prototype.isConst=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&"."!==c&&(c<"0"||c>"9")))break}if(b>a){var d=this.expression.substring(a,b);if(d in this.consts)return this.current=this.newToken(ga,this.consts[d]),this.pos+=d.length,!0}return!1},n.prototype.isNamedOp=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&(c<"0"||c>"9")))break}if(b>a){var d=this.expression.substring(a,b);if(this.isOperatorEnabled(d)&&(d in this.binaryOps||d in this.unaryOps||d in this.ternaryOps))return this.current=this.newToken(fa,d),this.pos+=d.length,!0}return!1},n.prototype.isName=function(){for(var a=this.pos,b=a,c=!1;b<this.expression.length;b++){var d=this.expression.charAt(b);if(d.toUpperCase()===d.toLowerCase()){if(b===this.pos&&"$"===d)continue;if(b===this.pos||!c||"_"!==d&&(d<"0"||d>"9"))break}else c=!0}if(c){var e=this.expression.substring(a,b);return this.current=this.newToken(ka,e),this.pos+=e.length,!0}return!1},n.prototype.isWhitespace=function(){for(var a=!1,b=this.expression.charAt(this.pos);!(" "!==b&&"\t"!==b&&"\n"!==b&&"\r"!==b||(a=!0,++this.pos>=this.expression.length));)b=this.expression.charAt(this.pos);return a};var la=/^[0-9a-f]{4}$/i;n.prototype.unescape=function(a){var b=a.indexOf("\\");if(b<0)return a;for(var c=a.substring(0,b);b>=0;){var d=a.charAt(++b);switch(d){case"'":c+="'";break;case'"':c+='"';break;case"\\":c+="\\";break;case"/":c+="/";break;case"b":c+="\b";break;case"f":c+="\f";break;case"n":c+="\n";break;case"r":c+="\r";break;case"t":c+="\t";break;case"u":var e=a.substring(b+1,b+5);la.test(e)||this.parseError("Illegal escape sequence: \\u"+e),c+=String.fromCharCode(parseInt(e,16)),b+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+d+'"')}++b;var f=a.indexOf("\\",b);c+=a.substring(b,f<0?a.length:f),b=f}return c},n.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},n.prototype.isRadixInteger=function(){var a=this.pos;if(a>=this.expression.length-2||"0"!==this.expression.charAt(a))return!1;++a;var b,c;if("x"===this.expression.charAt(a))b=16,c=/^[0-9a-f]$/i,++a;else{if("b"!==this.expression.charAt(a))return!1;b=2,c=/^[01]$/i,++a}for(var d=!1,e=a;a<this.expression.length;){var f=this.expression.charAt(a);if(!c.test(f))break;a++,d=!0}return d&&(this.current=this.newToken(ga,parseInt(this.expression.substring(e,a),b)),this.pos=a),d},n.prototype.isNumber=function(){for(var a,b=!1,c=this.pos,d=c,e=c,f=!1,g=!1;c<this.expression.length&&((a=this.expression.charAt(c))>="0"&&a<="9"||!f&&"."===a);)"."===a?f=!0:g=!0,c++,b=g;if(b&&(e=c),"e"===a||"E"===a){c++;for(var h=!0,i=!1;c<this.expression.length;){if(a=this.expression.charAt(c),!h||"+"!==a&&"-"!==a){if(!(a>="0"&&a<="9"))break;i=!0,h=!1}else h=!1;c++}i||(c=e)}return b?(this.current=this.newToken(ga,parseFloat(this.expression.substring(d,c))),this.pos=c):this.pos=e,b},n.prototype.isOperator=function(){var a=this.pos,b=this.expression.charAt(this.pos);if("+"===b||"-"===b||"*"===b||"/"===b||"%"===b||"^"===b||"?"===b||":"===b||"."===b)this.current=this.newToken(fa,b);else if(""===b||""===b)this.current=this.newToken(fa,"*");else if(">"===b)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(fa,">="),this.pos++):this.current=this.newToken(fa,">");else if("<"===b)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(fa,"<="),this.pos++):this.current=this.newToken(fa,"<");else if("|"===b){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(fa,"||"),this.pos++}else if("="===b){if("="!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(fa,"=="),this.pos++}else{if("!"!==b)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(fa,"!="),this.pos++):this.current=this.newToken(fa,b)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=a,!1)};var ma={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional"};n.prototype.isOperatorEnabled=function(a){var b=o(a),c=this.options.operators||{};return"in"===b?!!c.in:!(b in c&&!c[b])},n.prototype.getCoordinates=function(){var a,b=0,c=-1;do{b++,a=this.pos-c,c=this.expression.indexOf("\n",c+1)}while(c>=0&&c<this.pos);return{line:b,column:a}},n.prototype.parseError=function(a){var b=this.getCoordinates();throw new Error("parse error ["+b.line+":"+b.column+"]: "+a)},p.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},p.prototype.tokenMatches=function(a,b){return void 0===b||(Array.isArray(b)?j(b,a.value):"function"==typeof b?b(a):a.value===b)},p.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},p.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},p.prototype.accept=function(a,b){return!(this.nextToken.type!==a||!this.tokenMatches(this.nextToken,b))&&(this.next(),!0)},p.prototype.expect=function(a,b){if(!this.accept(a,b)){var c=this.tokens.getCoordinates();throw new Error("parse error ["+c.line+":"+c.column+"]: Expected "+(b||a))}},p.prototype.parseAtom=function(b){if(this.accept(ka))b.push(new a(aa,this.current.value));else if(this.accept(ga))b.push(new a(Y,this.current.value));else if(this.accept(ha))b.push(new a(Y,this.current.value));else{if(!this.accept(ia,"("))throw new Error("unexpected "+this.nextToken);this.parseExpression(b),this.expect(ia,")")}},p.prototype.parseExpression=function(a){this.parseConditionalExpression(a)},p.prototype.parseConditionalExpression=function(b){for(this.parseOrExpression(b);this.accept(fa,"?");){var c=[],e=[];this.parseConditionalExpression(c),this.expect(fa,":"),this.parseConditionalExpression(e),b.push(new a(ca,c)),b.push(new a(ca,e)),b.push(d("?"))}},p.prototype.parseOrExpression=function(a){for(this.parseAndExpression(a);this.accept(fa,"or");)this.parseAndExpression(a),a.push(c("or"))},p.prototype.parseAndExpression=function(a){for(this.parseComparison(a);this.accept(fa,"and");)this.parseComparison(a),a.push(c("and"))};var na=["==","!=","<","<=",">=",">","in"];p.prototype.parseComparison=function(a){for(this.parseAddSub(a);this.accept(fa,na);){var b=this.current;this.parseAddSub(a),a.push(c(b.value))}};var oa=["+","-","||"];p.prototype.parseAddSub=function(a){for(this.parseTerm(a);this.accept(fa,oa);){var b=this.current;this.parseTerm(a),a.push(c(b.value))}};var pa=["*","/","%"];p.prototype.parseTerm=function(a){for(this.parseFactor(a);this.accept(fa,pa);){var b=this.current;this.parseFactor(a),a.push(c(b.value))}},p.prototype.parseFactor=function(a){function c(a){return a.value in d}var d=this.tokens.unaryOps;if(this.save(),this.accept(fa,c))if("-"!==this.current.value&&"+"!==this.current.value&&this.nextToken.type===ia&&"("===this.nextToken.value)this.restore(),this.parseExponential(a);else{var e=this.current;this.parseFactor(a),a.push(b(e.value))}else this.parseExponential(a)},p.prototype.parseExponential=function(a){for(this.parsePostfixExpression(a);this.accept(fa,"^");)this.parseFactor(a),a.push(c("^"))},p.prototype.parsePostfixExpression=function(a){for(this.parseFunctionCall(a);this.accept(fa,"!");)a.push(b("!"))},p.prototype.parseFunctionCall=function(c){function d(a){return a.value in e}var e=this.tokens.unaryOps;if(this.accept(fa,d)){var f=this.current;this.parseAtom(c),c.push(b(f.value))}else for(this.parseMemberExpression(c);this.accept(ia,"(");)if(this.accept(ia,")"))c.push(new a(ba,0));else{var g=this.parseArgumentList(c);c.push(new a(ba,g))}},p.prototype.parseArgumentList=function(a){for(var b=0;!this.accept(ia,")");)for(this.parseExpression(a),++b;this.accept(ja);)this.parseExpression(a),++b;return b},p.prototype.parseMemberExpression=function(b){for(this.parseAtom(b);this.accept(fa,".");){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(ka),b.push(new a(da,this.current.value))}};var qa=4.7421875,ra=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];X.prototype.parse=function(a){var b=[],c=new p(this,new n(this,a),{allowMemberAccess:this.options.allowMemberAccess});return c.parseExpression(b),c.expect(ea,"EOF"),new l(b,this)},X.prototype.evaluate=function(a,b){return this.parse(a).evaluate(b)};var sa=new X;X.parse=function(a){return sa.parse(a)},X.evaluate=function(a,b){return sa.parse(a).evaluate(b)};var ta={Parser:X,Expression:l};return MFExprParserObj=new X,ta}),function(){"use strict";angular.module("magic-forms").service("MFExprParser",[function(){var a=angular.copy(MFExprParserObj);return MFExprParserObj=void 0,a}])}(),angular.module("magic-forms").component("mfForm",{templateUrl:"magic-forms/mf-form.template.html",controller:function(){this.requestForm={}},controllerAs:"rf",bindings:{form:"="}}),function(){"use strict";function a(a,b,c,d){function e(b){if(b.watchChanges){var c={};angular.forEach(b.fields,function(a){c[a.id]=a.value||""}),angular.forEach(b.fields,function(b){angular.forEach(b.expressions,function(e){try{var f=d.parse(e.expression);b[e.field]=f.evaluate(c)}catch(b){a.error(b)}})})}}var f={},g={description:"",fields:[],rows:[],watchChanges:!1,isValid:function(){for(var a=!0,b=0;b<this.fields.length;b++)if(!this.fields[b].isValid()){a=!1;break}return a}},h={fields:[],visible:function(){for(var a=0;a<this.fields.length;a++)if(this.fields[a].visible)return!0;return!1}},i={id:void 0,type:"text",help:void 0,placeholder:void 0,label:void 0,defaultValue:void 0,mandatory:!1,disabled:!1,visible:!0,value:void 0,options:{},expressions:[],ui:{cols:12,newRow:!0},getValue:function(){return this.value||""},isValid:function(){return!1}};f.getDefaultField=function(){return angular.copy(i)},f.getDefaultForm=function(){var a=angular.copy(g);return delete a.watchChanges,delete a.isValid,delete a.rows,a};var j=function(a){return angular.isString(a)&&""!=a.trim()},k=function(b,c,e,f,g){if(!0!==c[e]&&!1!==c[e])try{var h=d.parse(c[e]),i=h.evaluate(f);b.watchChanges=!0,c.expressions.push({field:e,expression:c[e]}),c[e]=i}catch(b){a.error(b),g.reject(c.id+"."+e+" must be a boolean or a valid expression")}},l=function(b,c,d,e){if(void 0!==b[c]&&!angular.isString(b[c])){if(!angular.isObject(b[c]))return a.error(b.id+"."+c+" must be a string or a multilang expression"),void e.reject(b.id+"."+c+" must be a string or a multilang expression");var f="";for(var g in b[c])if(b[c].hasOwnProperty(g)&&angular.isString(b[c][g])){f=b[c][g];break}void 0!==d&&void 0!==b[c][d]&&angular.isString(b[c][d])&&(f=b[c][d]),b[c]=f}};return f.getFormDefinitionFromYaml=function(a){var c=b.defer();try{var d=jsyaml.load(a);c.resolve(d)}catch(a){c.reject(a)}return c.promise},f.mergeFieldWithDefaults=function(a){return f.merge(a,angular.copy(i)),a},f.getFormInstanceFromYaml=function(a,c){var d=b.defer();return f.getFormDefinitionFromYaml(a).then(function(a){d.resolve();var b=angular.copy(a);return f.getFormInstance(b,c)},function(a){return d.reject(a),d.promise})},f.exportDefinitionToYaml=function(a){var c=angular.copy(a),d=angular.copy(f.getDefaultField());angular.forEach(c.fields,function(a){delete a.value,delete a.expressions,delete a.getValue,delete a.isValid,0===Object.keys(a.options).length&&a.options.constructor===Object&&delete a.options,void 0!==a.ui&&(delete a.ui.cols,a.ui.newRow==d.ui.newRow&&delete a.ui.newRow),0===Object.keys(a.ui).length&&a.ui.constructor===Object&&delete a.ui,a.help==d.help&&delete a.help,a.placeholder==d.placeholder&&delete a.placeholder,a.mandatory==d.mandatory&&delete a.mandatory,a.visible==d.visible&&delete a.visible,a.disabled==d.disabled&&delete a.disabled,a.defaultValue==d.defaultValue&&delete a.defaultValue});var e=b.defer();try{var g=jsyaml.dump(c);e.resolve(g)}catch(a){e.reject(a)}return e.promise},f.getFormInstance=function(a,c){var d=angular.copy(a),m=b.defer();if(angular.isArray(d.fields)){f.merge(d,angular.copy(g));var n={};angular.forEach(d.fields,function(a){a.id?(void 0!==n[a.id]&&m.reject("id of fields cannot be used in two different fields : check ["+a.id+"]"),n[a.id]=0):m.reject("All fields must have a non empty id")}),angular.forEach(d.fields,function(a,b){f.merge(a,angular.copy(i)),j(a.id)||m.reject("field #"+b+" {id} attribute is not set or is not a non-empty string"),l(a,"label",c,m),j(a.label)||m.reject(a.id+".label is not set or is not a non-empty string"),j(a.type)||m.reject(a.id+".type is not set or is not a non-empty string"),k(d,a,"mandatory",n,m),k(d,a,"visible",n,m),k(d,a,"disabled",n,m),l(a,"help",c,m),l(a,"placeholder",c,m),angular.isObject(a.options)||m.reject(a.id+".options must be an object"),void 0!==a.defaultValue&&(a.value=a.defaultValue),a.reevaluate=function(){e(d)}});for(var o=angular.copy(h),p=0;p<d.fields.length;p++){var q=d.fields[p];if(o.fields.push(q),p==d.fields.length-1||d.fields[p+1].ui.newRow){if(o.fields.length>4)m.reject("Only rows of 1, 2, 3 or 4 are allowed. Review configuration of row of field "+q.id);else{var r=12/o.fields.length;angular.forEach(o.fields,function(a){a.ui.cols=r}),d.rows.push(o)}o=angular.copy(h)}}e(d),m.resolve(d)}else m.reject("fields attribute is not set or is not an array");return m.promise},f.merge=function(a,b){c.defaults(a,b)},f.getValues=function(a){var b={};return angular.forEach(a.fields,function(a){a.visible&&(b[a.id]=a.getValue())}),b},f}angular.module("magic-forms").factory("MFForm",["$log","$q","lodash","MFExprParser",a])}(),angular.module("magic-forms").component("mfAttachment",{templateUrl:"magic-forms/mf-attachment.template.html",controller:["MFForm","TranslationService",function(a,b){"use strict";var c=this;c.fileChosen=!1,c.filename=void 0,c.options={mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD")},c.$onInit=function(){c.field.isValid=function(){return!c.field.mandatory||c.fileChosen}},c.selectAttachments=function(a,b){a.length>0?(c.fileChosen=!0,c.field.value=a[0],c.filename=a[0].name):(c.fileChosen=!1,c.field.value=void 0,c.filename=void 0)}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfCheckbox",{templateUrl:"magic-forms/mf-checkbox.template.html",controller:["MFForm",function(a){var b=this;b.$onInit=function(){b.field.value=void 0!==b.field.defaultValue&&b.field.defaultValue+""==!0+"",b.field.isValid=function(){return b.form[b.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<"}}),angular.module("magic-forms").component("mfDate",{templateUrl:"magic-forms/mf-date.template.html",controller:["MFForm","TranslationService",function(a,b){var c=this;c.options={mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD")},c.$onInit=function(){c.field.isValid=function(){return c.form[c.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfRadio",{templateUrl:"magic-forms/mf-radio.template.html",controller:["MFForm","TranslationService",function(a,b){var c=this;c.defaultOptions={values:[],mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD")},c.$onInit=function(){a.merge(c.field.options,c.defaultOptions),angular.forEach(c.field.options.values,function(a){void 0!==a.default&&!0===a.default&&(c.field.value=a.id)}),c.field.isValid=function(){return c.form[c.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfSelect",{templateUrl:"magic-forms/mf-select.template.html",controller:["MFForm","TranslationService",function(a,b){var c=this;c.defaultOptions={values:[],mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD")},c.$onInit=function(){a.merge(c.field.options,c.defaultOptions),c.field.isValid=function(){if(void 0!=c.form[c.field.id]||null!=c.form[c.field.id])return c.form[c.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfText",{templateUrl:"magic-forms/mf-text.template.html",controller:["MFForm","TranslationService",function(a,b){var c=this;c.defaultOptions={maxLength:void 0,minLength:void 0,mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD"),maxLengthDesc:b.get("MAGIC_FORM_FIELD_MAX_LENGTH_ERROR"),minLengthDesc:b.get("MAGIC_FORM_FIELD_MIN_LENGTH_ERROR")},c.$onInit=function(){a.merge(c.field.options,c.defaultOptions),c.options=c.field.options,c.field.isValid=function(){if(void 0!=c.form[c.field.id]||null!=c.form[c.field.id])return c.form[c.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfTextarea",{templateUrl:"magic-forms/mf-textarea.template.html",controller:["MFForm","TranslationService",function(a,b){var c=this;c.defaultOptions={rows:4,mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD")},c.$onInit=function(){a.merge(c.field.options,c.defaultOptions),c.options=c.field.options,c.field.isValid=function(){return c.form[c.field.id].$valid}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}}),angular.module("magic-forms").component("mfSection",{templateUrl:"magic-forms/mf-section.template.html",controller:function(){"use strict";var a=this;a.$onInit=function(){a.field.isValid=function(){return!0}}},controllerAs:"f",bindings:{field:"=",form:"<"}}),angular.module("magic-forms").component("mfPassword",{templateUrl:"magic-forms/mf-password.template.html",controller:["MFForm","TranslationService",function(a,b){function c(){d.field.value&&void 0!=d.field.value&&""!=d.field.value||(d.options.filled=!1,d.options.correct=!1,d.options.matched=!1),d.field.confirmPwd&&void 0!=d.field.confirmPwd&&""!=d.field.confirmPwd||(d.options.filled=!1,d.options.correct=!1,d.options.matched=!1),void 0!==d.field.confirmPwd&&""!==d.field.confirmPwd&&void 0!==d.field.value&&""!==d.field.value&&d.field.confirmPwd==d.field.value&&(d.options.matched=!0,d.options.correct=!0,d.options.filled=!0),void 0!==d.field.confirmPwd&&""!==d.field.confirmPwd&&void 0!==d.field.value&&""!==d.field.value&&d.field.confirmPwd!==d.field.value&&(d.options.matched=!1,d.options.correct=!1,d.options.filled=!0)}var d=this;d.changeSamePassword=c,d.msgNotMatch=!1,d.isCorrect=!1,d.defaultOptions={password:void 0,correct:!1,filled:!1,matched:!1,mandatory:b.get("MAGIC_FORM_MANDATORY_FIELD"),patternMessage:b.get("MAGIC_FORM_PATTERN_MESSAGE_FIELD"),pwdNotMatchMessage:b.get("MAGIC_FORM_PWD_MISS_MATCH_MESSAGE_FIELD")},d.$onInit=function(){a.merge(d.field.options,d.defaultOptions),d.options=d.field.options,d.field.isValid=function(){return d.options.correct&&d.options.filled&&d.options.matched}}}],controllerAs:"f",bindings:{field:"=",form:"<",translation:"<"}});